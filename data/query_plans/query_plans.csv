content,QUERY_ID,QUERY_TEXT,DATABASE_NAME,SCHEMA_NAME,QUERY_TYPE,SESSION_ID,USER_NAME,ROLE_NAME,WAREHOUSE_NAME,WAREHOUSE_SIZE,WAREHOUSE_TYPE,CLUSTER_NUMBER,QUERY_TAG,EXECUTION_STATUS,ERROR_CODE,ERROR_MESSAGE,START_TIME,END_TIME,TOTAL_ELAPSED_TIME,BYTES_SCANNED,ROWS_PRODUCED,COMPILATION_TIME,EXECUTION_TIME,QUEUED_PROVISIONING_TIME,QUEUED_REPAIR_TIME,QUEUED_OVERLOAD_TIME,TRANSACTION_BLOCKED_TIME,OUTBOUND_DATA_TRANSFER_CLOUD,OUTBOUND_DATA_TRANSFER_REGION,OUTBOUND_DATA_TRANSFER_BYTES,INBOUND_DATA_TRANSFER_CLOUD,INBOUND_DATA_TRANSFER_REGION,INBOUND_DATA_TRANSFER_BYTES,CREDITS_USED_CLOUD_SERVICES,LIST_EXTERNAL_FILE_TIME,RELEASE_VERSION,EXTERNAL_FUNCTION_TOTAL_INVOCATIONS,EXTERNAL_FUNCTION_TOTAL_SENT_ROWS,EXTERNAL_FUNCTION_TOTAL_RECEIVED_ROWS,EXTERNAL_FUNCTION_TOTAL_SENT_BYTES,EXTERNAL_FUNCTION_TOTAL_RECEIVED_BYTES,IS_CLIENT_GENERATED_STATEMENT,QUERY_HASH,QUERY_HASH_VERSION,QUERY_PARAMETERIZED_HASH,QUERY_PARAMETERIZED_HASH_VERSION
"{""GlobalStats"":{""partitionsTotal"":54926,""partitionsAssigned"":54926,""bytesAssigned"":923619642880},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SUBSTR(WAREHOUSE.W_WAREHOUSE_NAME, 1, 20)"",""SHIP_MODE.SM_TYPE"",""CALL_CENTER.CC_NAME"",""SUM(IFF((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) <= 30, 1, 0))"",""SUM(IFF(((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) > 30) AND ((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) <= 60), 1, 0))"",""SUM(IFF(((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) > 60) AND ((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) <= 90), 1, 0))"",""SUM(IFF(((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) > 90) AND ((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) <= 120), 1, 0))"",""SUM(IFF((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) > 120, 1, 0))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [SUBSTR(WAREHOUSE.W_WAREHOUSE_NAME, 1, 20) ASC NULLS LAST, SHIP_MODE.SM_TYPE ASC NULLS LAST, CALL_CENTER.CC_NAME ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFF((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) <= 30, 1, 0)), SUM(IFF(((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) > 30) AND ((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) <= 60), 1, 0)), SUM(IFF(((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) > 60) AND ((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) <= 90), 1, 0)), SUM(IFF(((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) > 90) AND ((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) <= 120), 1, 0)), SUM(IFF((CATALOG_SALES.CS_SHIP_DATE_SK - CATALOG_SALES.CS_SOLD_DATE_SK) > 120, 1, 0))]"",""groupKeys: [SUBSTR(WAREHOUSE.W_WAREHOUSE_NAME, 1, 20), SHIP_MODE.SM_TYPE, CALL_CENTER.CC_NAME]""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (SHIP_MODE.SM_SHIP_MODE_SK = CATALOG_SALES.CS_SHIP_MODE_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.SHIP_MODE""],""expressions"":[""SM_SHIP_MODE_SK"",""SM_TYPE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":3072,""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WAREHOUSE.W_WAREHOUSE_SK = CATALOG_SALES.CS_WAREHOUSE_SK)""],""parentOperators"":[3]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WAREHOUSE""],""expressions"":[""W_WAREHOUSE_SK"",""W_WAREHOUSE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7168,""parentOperators"":[5]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CALL_CENTER.CC_CALL_CENTER_SK = CATALOG_SALES.CS_CALL_CENTER_SK)""],""parentOperators"":[5]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CALL_CENTER""],""expressions"":[""CC_CALL_CENTER_SK"",""CC_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":18432,""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SHIP_DATE_SK)""],""parentOperators"":[7]},{""id"":10,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1208) AND (DATE_DIM.D_MONTH_SEQ <= 1219)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SHIP_DATE_SK IS NOT NULL) AND (CATALOG_SALES.CS_CALL_CENTER_SK IS NOT NULL) AND (CATALOG_SALES.CS_WAREHOUSE_SK IS NOT NULL) AND (CATALOG_SALES.CS_SHIP_MODE_SK IS NOT NULL)""],""parentOperators"":[9]},{""id"":13,""operation"":""JoinFilter"",""expressions"":[""joinKey: (SHIP_MODE.SM_SHIP_MODE_SK = CATALOG_SALES.CS_SHIP_MODE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_SHIP_DATE_SK"",""CS_CALL_CENTER_SK"",""CS_SHIP_MODE_SK"",""CS_WAREHOUSE_SK""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[13]}]]}",01b2e7fe-0002-2ebc-0051-ba8700023722,"explain using json select /* { ""query"":""query99"",""streamId"":0,""querySequence"":94 } */
   substr(w_warehouse_name,1,20)
  ,sm_type
  ,cc_name
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as ""30 days""
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and
                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as ""31-60 days""
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and
                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as ""61-90 days""
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and
                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as ""91-120 days""
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as "">120 days""
from
   catalog_sales
  ,warehouse
  ,ship_mode
  ,call_center
  ,date_dim
where
    d_month_seq between 1208 and 1208 + 11
and cs_ship_date_sk   = d_date_sk
and cs_warehouse_sk   = w_warehouse_sk
and cs_ship_mode_sk   = sm_ship_mode_sk
and cs_call_center_sk = cc_call_center_sk
group by
   substr(w_warehouse_name,1,20)
  ,sm_type
  ,cc_name
order by substr(w_warehouse_name,1,20)
        ,sm_type
        ,cc_name
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:34:36.258-07:00,2024-03-10T18:34:36.829-07:00,571,0,0,570,1,0,0,0,0,,,0,,,0,0.000087000,0,8.9.2,0,0,0,0,0,FALSE,0f173c61fb6b4e282a0ab56b050155f5,2,0f173c61fb6b4e282a0ab56b050155f5,1
"{""GlobalStats"":{""partitionsTotal"":160616,""partitionsAssigned"":160616,""bytesAssigned"":2759632955392},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""0.05 * ((SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE)))))) / (COUNT(SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE)))))))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_SALES_PRICE)), COUNT(SUM(STORE_SALES.SS_SALES_PRICE))]""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE))))]"",""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, STORE.S_STORE_NAME, CUSTOMER_ADDRESS.CA_STATE, STORE.S_STATE, ITEM.I_COLOR, ITEM.I_CURRENT_PRICE, ITEM.I_MANAGER_ID, ITEM.I_UNITS, ITEM.I_SIZE]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE)))]"",""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, STORE.S_STORE_NAME, CUSTOMER_ADDRESS.CA_STATE, STORE.S_STATE, ITEM.I_COLOR, ITEM.I_CURRENT_PRICE, ITEM.I_MANAGER_ID, ITEM.I_UNITS, ITEM.I_SIZE]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_CURRENT_PRICE"",""I_SIZE"",""I_COLOR"",""I_UNITS"",""I_MANAGER_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_SALES_PRICE))]"",""groupKeys: [STORE.S_STORE_NAME, STORE.S_STATE, CUSTOMER_ADDRESS.CA_STATE, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[4]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_SALES.SS_ITEM_SK = STORE_RETURNS.SR_ITEM_SK) AND (STORE_SALES.SS_TICKET_NUMBER = STORE_RETURNS.SR_TICKET_NUMBER)""],""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_SALES_PRICE)]"",""groupKeys: [STORE.S_STORE_NAME, STORE.S_STATE, CUSTOMER_ADDRESS.CA_STATE, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_TICKET_NUMBER]""],""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK) AND (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)"",""joinFilter: CUSTOMER.C_BIRTH_COUNTRY <> (UPPER(CUSTOMER_ADDRESS.CA_COUNTRY))""],""parentOperators"":[9]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_ZIP = CUSTOMER_ADDRESS.CA_ZIP)""],""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""(STORE.S_MARKET_ID = 7) AND (STORE.S_ZIP IS NOT NULL)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME"",""S_MARKET_ID"",""S_STATE"",""S_ZIP""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_ZIP IS NOT NULL""],""parentOperators"":[11]},{""id"":15,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_ZIP = CUSTOMER_ADDRESS.CA_ZIP)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE"",""CA_ZIP"",""CA_COUNTRY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[15]},{""id"":17,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)"",""joinFilter: CUSTOMER.C_BIRTH_COUNTRY <> (UPPER(CUSTOMER_ADDRESS.CA_COUNTRY))""],""parentOperators"":[10]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_ADDR_SK"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_BIRTH_COUNTRY""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[17]},{""id"":19,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[9]},{""id"":20,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_ITEM_SK"",""SS_CUSTOMER_SK"",""SS_STORE_SK"",""SS_TICKET_NUMBER"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[20]},{""id"":22,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[7]},{""id"":23,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_ITEM_SK"",""SR_TICKET_NUMBER""],""partitionsAssigned"":7070,""partitionsTotal"":7070,""bytesAssigned"":124763446272,""parentOperators"":[22]}],[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER.C_LAST_NAME"",""CUSTOMER.C_FIRST_NAME"",""STORE.S_STORE_NAME"",""SUM(SUM(STORE_SALES.SS_SALES_PRICE))""]},{""id"":1,""operation"":""Sort"",""expressions"":[""CUSTOMER.C_LAST_NAME ASC NULLS LAST"",""CUSTOMER.C_FIRST_NAME ASC NULLS LAST"",""STORE.S_STORE_NAME ASC NULLS LAST""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_SALES_PRICE)), COUNT(*)))) > Subquery(Step1)""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_SALES_PRICE)), COUNT(*)))]"",""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, STORE.S_STORE_NAME]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_SALES_PRICE)), COUNT(*))]"",""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, STORE.S_STORE_NAME]""],""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK]""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""ITEM.I_COLOR = 'mint'""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_COLOR""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_SALES_PRICE))]"",""groupKeys: [STORE.S_STORE_NAME, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[5]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_SALES.SS_ITEM_SK = STORE_RETURNS.SR_ITEM_SK) AND (STORE_SALES.SS_TICKET_NUMBER = STORE_RETURNS.SR_TICKET_NUMBER)""],""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_SALES_PRICE)]"",""groupKeys: [STORE.S_STORE_NAME, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_TICKET_NUMBER]""],""parentOperators"":[10]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK) AND (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)"",""joinFilter: CUSTOMER.C_BIRTH_COUNTRY <> (UPPER(CUSTOMER_ADDRESS.CA_COUNTRY))""],""parentOperators"":[12]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_ZIP = CUSTOMER_ADDRESS.CA_ZIP)""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""(STORE.S_MARKET_ID = 7) AND (STORE.S_ZIP IS NOT NULL)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME"",""S_MARKET_ID"",""S_ZIP""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_ZIP IS NOT NULL""],""parentOperators"":[14]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_ZIP = CUSTOMER_ADDRESS.CA_ZIP)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_ZIP"",""CA_COUNTRY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[18]},{""id"":20,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)"",""joinFilter: CUSTOMER.C_BIRTH_COUNTRY <> (UPPER(CUSTOMER_ADDRESS.CA_COUNTRY))""],""parentOperators"":[13]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_ADDR_SK"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_BIRTH_COUNTRY""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[20]},{""id"":22,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[12]},{""id"":23,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_ITEM_SK"",""SS_CUSTOMER_SK"",""SS_STORE_SK"",""SS_TICKET_NUMBER"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[23]},{""id"":25,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[10]},{""id"":26,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_ITEM_SK"",""SR_TICKET_NUMBER""],""partitionsAssigned"":7070,""partitionsTotal"":7070,""bytesAssigned"":124763446272,""parentOperators"":[25]}]]}",01b2e7fd-0002-2d83-0051-ba87000251fa,"explain using json with /* { ""query"":""query24_p1"",""streamId"":0,""querySequence"":92 } */ ssales as
(select c_last_name
      ,c_first_name
      ,s_store_name
      ,ca_state
      ,s_state
      ,i_color
      ,i_current_price
      ,i_manager_id
      ,i_units
      ,i_size
      ,sum(ss_sales_price) netpaid
from store_sales
    ,store_returns
    ,store
    ,item
    ,customer
    ,customer_address
where ss_ticket_number = sr_ticket_number
  and ss_item_sk = sr_item_sk
  and ss_customer_sk = c_customer_sk
  and ss_item_sk = i_item_sk
  and ss_store_sk = s_store_sk
  and c_current_addr_sk = ca_address_sk
  and c_birth_country <> upper(ca_country)
  and s_zip = ca_zip
and s_market_id=7
group by c_last_name
        ,c_first_name
        ,s_store_name
        ,ca_state
        ,s_state
        ,i_color
        ,i_current_price
        ,i_manager_id
        ,i_units
        ,i_size)
select c_last_name
      ,c_first_name
      ,s_store_name
      ,sum(netpaid) paid
from ssales
where i_color = 'mint'
group by c_last_name
        ,c_first_name
        ,s_store_name
having sum(netpaid) > (select 0.05*avg(netpaid)
                                 from ssales)
order by c_last_name
        ,c_first_name
        ,s_store_name
;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:39.135-07:00,2024-03-10T18:33:39.677-07:00,542,0,0,540,2,0,0,0,0,,,0,,,0,0.000083000,0,8.9.2,0,0,0,0,0,FALSE,5ef3f28d2cf1690be747e1d6a97c5cf0,2,6c4023f9fcbe1ed25a5ab68f76c10418,1
"{""GlobalStats"":{""partitionsTotal"":72978,""partitionsAssigned"":72978,""bytesAssigned"":1252710297088},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SCALED_ROUND_INT_DIVIDE(SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_QUANTITY))))), COUNT(COUNT(COUNT(COUNT(COUNT(STORE_SALES.SS_QUANTITY))))))"",""(SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) / (COUNT(COUNT(COUNT(COUNT(COUNT(STORE_SALES.SS_EXT_SALES_PRICE))))))"",""(SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_WHOLESALE_COST)))))) / (COUNT(COUNT(COUNT(COUNT(COUNT(STORE_SALES.SS_EXT_WHOLESALE_COST))))))"",""SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_WHOLESALE_COST)))))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_QUANTITY))))), COUNT(COUNT(COUNT(COUNT(COUNT(STORE_SALES.SS_QUANTITY))))), SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))))), COUNT(COUNT(COUNT(COUNT(COUNT(STORE_SALES.SS_EXT_SALES_PRICE))))), SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_WHOLESALE_COST))))), COUNT(COUNT(COUNT(COUNT(COUNT(STORE_SALES.SS_EXT_WHOLESALE_COST)))))]""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_QUANTITY)))), COUNT(COUNT(COUNT(COUNT(STORE_SALES.SS_QUANTITY)))), SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))), COUNT(COUNT(COUNT(COUNT(STORE_SALES.SS_EXT_SALES_PRICE)))), SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_WHOLESALE_COST)))), COUNT(COUNT(COUNT(COUNT(STORE_SALES.SS_EXT_WHOLESALE_COST))))]""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_QUANTITY))), COUNT(COUNT(COUNT(STORE_SALES.SS_QUANTITY))), SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), COUNT(COUNT(COUNT(STORE_SALES.SS_EXT_SALES_PRICE))), SUM(SUM(SUM(STORE_SALES.SS_EXT_WHOLESALE_COST))), COUNT(COUNT(COUNT(STORE_SALES.SS_EXT_WHOLESALE_COST)))]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[3]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 2001""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(COUNT(STORE_SALES.SS_QUANTITY)), SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)), COUNT(COUNT(STORE_SALES.SS_EXT_SALES_PRICE)), SUM(SUM(STORE_SALES.SS_EXT_WHOLESALE_COST)), COUNT(COUNT(STORE_SALES.SS_EXT_WHOLESALE_COST))]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[6]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = STORE_SALES.SS_CDEMO_SK)"",""joinFilter: ((CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS = 'S') AND (CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS = 'Primary') AND ((STORE_SALES.SS_SALES_PRICE >= 100) AND (STORE_SALES.SS_SALES_PRICE <= 150)) AND (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 3)) OR ((CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS = 'M') AND (CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS = 'College') AND ((STORE_SALES.SS_SALES_PRICE >= 50) AND (STORE_SALES.SS_SALES_PRICE <= 100)) AND (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 1)) OR ((CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS = 'D') AND (CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS = 'Advanced Degree') AND ((STORE_SALES.SS_SALES_PRICE >= 150) AND (STORE_SALES.SS_SALES_PRICE <= 200)) AND (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 1))""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS IN 'S' IN 'M' IN 'D') AND (CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS IN 'Primary' IN 'College' IN 'Advanced Degree')""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_MARITAL_STATUS"",""CD_EDUCATION_STATUS""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_QUANTITY), COUNT(STORE_SALES.SS_QUANTITY), SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(STORE_SALES.SS_EXT_SALES_PRICE), SUM(STORE_SALES.SS_EXT_WHOLESALE_COST), COUNT(STORE_SALES.SS_EXT_WHOLESALE_COST)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_SOLD_DATE_SK, STORE_SALES.SS_CDEMO_SK, HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT, STORE_SALES.SS_SALES_PRICE]""],""parentOperators"":[10]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT IN 3 IN 1""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[15]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = STORE_SALES.SS_ADDR_SK)"",""joinFilter: ((CUSTOMER_ADDRESS.CA_STATE IN 'AZ' IN 'IA' IN 'AL') AND ((STORE_SALES.SS_NET_PROFIT >= 100) AND (STORE_SALES.SS_NET_PROFIT <= 200))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'KY' IN 'TX' IN 'MT') AND ((STORE_SALES.SS_NET_PROFIT >= 150) AND (STORE_SALES.SS_NET_PROFIT <= 300))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'MO' IN 'OR' IN 'NY') AND ((STORE_SALES.SS_NET_PROFIT >= 50) AND (STORE_SALES.SS_NET_PROFIT <= 250)))""],""parentOperators"":[14]},{""id"":18,""operation"":""Filter"",""expressions"":[""(CUSTOMER_ADDRESS.CA_COUNTRY = 'United States') AND ((CUSTOMER_ADDRESS.CA_STATE IN 'AZ' IN 'IA' IN 'AL') OR (CUSTOMER_ADDRESS.CA_STATE IN 'KY' IN 'TX' IN 'MT') OR (CUSTOMER_ADDRESS.CA_STATE IN 'MO' IN 'OR' IN 'NY'))""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE"",""CA_COUNTRY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""((STORE_SALES.SS_SALES_PRICE >= 100) OR (STORE_SALES.SS_SALES_PRICE >= 50) OR (STORE_SALES.SS_SALES_PRICE <= 100) OR (STORE_SALES.SS_SALES_PRICE >= 150) OR (STORE_SALES.SS_SALES_PRICE <= 200)) AND ((STORE_SALES.SS_SALES_PRICE <= 150) OR (STORE_SALES.SS_SALES_PRICE >= 50) OR (STORE_SALES.SS_SALES_PRICE <= 100) OR (STORE_SALES.SS_SALES_PRICE >= 150) OR (STORE_SALES.SS_SALES_PRICE <= 200)) AND ((STORE_SALES.SS_NET_PROFIT >= 100) OR (STORE_SALES.SS_NET_PROFIT >= 150) OR (STORE_SALES.SS_NET_PROFIT <= 300) OR (STORE_SALES.SS_NET_PROFIT >= 50) OR (STORE_SALES.SS_NET_PROFIT <= 250)) AND ((STORE_SALES.SS_NET_PROFIT <= 200) OR (STORE_SALES.SS_NET_PROFIT >= 150) OR (STORE_SALES.SS_NET_PROFIT <= 300) OR (STORE_SALES.SS_NET_PROFIT >= 50) OR (STORE_SALES.SS_NET_PROFIT <= 250)) AND (STORE_SALES.SS_ADDR_SK IS NOT NULL) AND (STORE_SALES.SS_CDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[17]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CDEMO_SK"",""SS_HDEMO_SK"",""SS_ADDR_SK"",""SS_STORE_SK"",""SS_QUANTITY"",""SS_SALES_PRICE"",""SS_EXT_SALES_PRICE"",""SS_EXT_WHOLESALE_COST"",""SS_NET_PROFIT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[21]}]]}",01b2e7fd-0002-2f4b-0051-ba8700026192,"explain using json select /* { ""query"":""query13"",""streamId"":0,""querySequence"":91 } */ avg(ss_quantity)
       ,avg(ss_ext_sales_price)
       ,avg(ss_ext_wholesale_cost)
       ,sum(ss_ext_wholesale_cost)
 from store_sales
     ,store
     ,customer_demographics
     ,household_demographics
     ,customer_address
     ,date_dim
 where s_store_sk = ss_store_sk
 and  ss_sold_date_sk = d_date_sk and d_year = 2001
 and((ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'S'
  and cd_education_status = 'Primary'
  and ss_sales_price between 100.00 and 150.00
  and hd_dep_count = 3
     )or
     (ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'M'
  and cd_education_status = 'College'
  and ss_sales_price between 50.00 and 100.00
  and hd_dep_count = 1
     ) or
     (ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'D'
  and cd_education_status = 'Advanced Degree'
  and ss_sales_price between 150.00 and 200.00
  and hd_dep_count = 1
     ))
 and((ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('AZ', 'IA', 'AL')
  and ss_net_profit between 100 and 200
     ) or
     (ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('KY', 'TX', 'MT')
  and ss_net_profit between 150 and 300
     ) or
     (ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('MO', 'OR', 'NY')
  and ss_net_profit between 50 and 250
     ))
;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:37.892-07:00,2024-03-10T18:33:38.741-07:00,849,0,0,847,2,0,0,0,0,,,0,,,0,0.000129000,0,8.9.2,0,0,0,0,0,FALSE,17814d7b697b80d68d4a46716934186a,2,3d28fd4a72d87e2114a432db8c8c98db,1
"{""GlobalStats"":{""partitionsTotal"":156002,""partitionsAssigned"":156002,""bytesAssigned"":2639061701632},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""UNION_ALL(ITEM.I_ITEM_ID, ITEM.I_ITEM_ID, ITEM.I_ITEM_ID)"",""SUM(UNION_ALL(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))), SUM(SUM(SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE)))), SUM(SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE))))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [SUM(TMP1.TOTAL_SALES) ASC NULLS LAST, TMP1.I_ITEM_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(UNION_ALL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(WEB_SALES.WS_EXT_SALES_PRICE)))]"",""groupKeys: [UNION_ALL(ITEM.I_ITEM_ID, ITEM.I_ITEM_ID, ITEM.I_ITEM_ID)]""],""parentOperators"":[1]},{""id"":3,""operation"":""UnionAll"",""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = STORE_SALES.SS_ADDR_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_GMT_OFFSET = -5""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_GMT_OFFSET""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))]"",""groupKeys: [ITEM.I_ITEM_ID, STORE_SALES.SS_ADDR_SK]""],""parentOperators"":[6]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 3)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE)]"",""groupKeys: [ITEM.I_ITEM_ID, STORE_SALES.SS_ADDR_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[10]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""ITEM.I_COLOR IN 'yellow' IN 'honeydew' IN 'orchid'""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_ID"",""I_COLOR""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[17]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[15]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[19]},{""id"":21,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_ADDR_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[14]},{""id"":22,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = STORE_SALES.SS_ADDR_SK)""],""parentOperators"":[21]},{""id"":23,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_ADDR_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[22]},{""id"":24,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[3]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[24]},{""id"":26,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CATALOG_SALES.CS_BILL_ADDR_SK)""],""parentOperators"":[25]},{""id"":27,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_GMT_OFFSET = -5""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_GMT_OFFSET""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[27]},{""id"":29,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE))]"",""groupKeys: [ITEM.I_ITEM_ID, CATALOG_SALES.CS_BILL_ADDR_SK]""],""parentOperators"":[26]},{""id"":30,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[29]},{""id"":31,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 3)""],""parentOperators"":[30]},{""id"":32,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[31]},{""id"":33,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CATALOG_SALES.CS_EXT_SALES_PRICE)]"",""groupKeys: [ITEM.I_ITEM_ID, CATALOG_SALES.CS_BILL_ADDR_SK, CATALOG_SALES.CS_SOLD_DATE_SK]""],""parentOperators"":[30]},{""id"":34,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[33]},{""id"":35,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[34]},{""id"":36,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[35]},{""id"":37,""operation"":""Filter"",""expressions"":[""ITEM.I_COLOR IN 'yellow' IN 'honeydew' IN 'orchid'""],""parentOperators"":[36]},{""id"":38,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_ID"",""I_COLOR""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[37]},{""id"":39,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[35]},{""id"":40,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[39]},{""id"":41,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_ADDR_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[34]},{""id"":42,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CATALOG_SALES.CS_BILL_ADDR_SK)""],""parentOperators"":[41]},{""id"":43,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_ADDR_SK"",""CS_ITEM_SK"",""CS_EXT_SALES_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[42]},{""id"":44,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[3]},{""id"":45,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[44]},{""id"":46,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = WEB_SALES.WS_BILL_ADDR_SK)""],""parentOperators"":[45]},{""id"":47,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_GMT_OFFSET = -5""],""parentOperators"":[46]},{""id"":48,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_GMT_OFFSET""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[47]},{""id"":49,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE))]"",""groupKeys: [ITEM.I_ITEM_ID, WEB_SALES.WS_BILL_ADDR_SK]""],""parentOperators"":[46]},{""id"":50,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[49]},{""id"":51,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 3)""],""parentOperators"":[50]},{""id"":52,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[51]},{""id"":53,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_EXT_SALES_PRICE)]"",""groupKeys: [ITEM.I_ITEM_ID, WEB_SALES.WS_BILL_ADDR_SK, WEB_SALES.WS_SOLD_DATE_SK]""],""parentOperators"":[50]},{""id"":54,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[53]},{""id"":55,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[54]},{""id"":56,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[55]},{""id"":57,""operation"":""Filter"",""expressions"":[""ITEM.I_COLOR IN 'yellow' IN 'honeydew' IN 'orchid'""],""parentOperators"":[56]},{""id"":58,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_ID"",""I_COLOR""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[57]},{""id"":59,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[55]},{""id"":60,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[59]},{""id"":61,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_ADDR_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[54]},{""id"":62,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = WEB_SALES.WS_BILL_ADDR_SK)""],""parentOperators"":[61]},{""id"":63,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_BILL_ADDR_SK"",""WS_EXT_SALES_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[62]}]]}",01b2e7fd-0002-2f99-0051-ba87000281c2,"explain using json with /* { ""query"":""query56"",""streamId"":0,""querySequence"":83 } */ ss as (
 select i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where i_item_id in (select
     i_item_id
from item
where i_color in ('yellow','honeydew','orchid'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 1999
 and     d_moy                   = 3
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id),
 cs as (
 select i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('yellow','honeydew','orchid'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 1999
 and     d_moy                   = 3
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id),
 ws as (
 select i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('yellow','honeydew','orchid'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 1999
 and     d_moy                   = 3
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id)
  select  i_item_id ,sum(total_sales) total_sales
 from  (select * from ss
        union all
        select * from cs
        union all
        select * from ws) tmp1
 group by i_item_id
 order by total_sales,
          i_item_id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:28.308-07:00,2024-03-10T18:33:29.25-07:00,942,0,0,941,1,0,0,0,0,,,0,,,0,0.000144000,0,8.9.2,0,0,0,0,0,FALSE,a3fbc0805f0a2079ebe37f465e10eca1,2,7720631d99e135e52cb9b9b117b8f699,1
"{""GlobalStats"":{""partitionsTotal"":7590,""partitionsAssigned"":7590,""bytesAssigned"":127875918336},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER.C_CUSTOMER_ID"",""(IFNULL(CUSTOMER.C_LAST_NAME, '')) || ', ' || (IFNULL(CUSTOMER.C_FIRST_NAME, ''))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CUSTOMER.C_CUSTOMER_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = STORE_RETURNS.SR_CDEMO_SK)""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = CUSTOMER.C_CURRENT_CDEMO_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (INCOME_BAND.IB_INCOME_BAND_SK = HOUSEHOLD_DEMOGRAPHICS.HD_INCOME_BAND_SK)""],""parentOperators"":[3]},{""id"":6,""operation"":""Filter"",""expressions"":[""(INCOME_BAND.IB_LOWER_BOUND >= 1797) AND (INCOME_BAND.IB_UPPER_BOUND <= 51797)""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.INCOME_BAND""],""expressions"":[""IB_INCOME_BAND_SK"",""IB_LOWER_BOUND"",""IB_UPPER_BOUND""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1536,""parentOperators"":[6]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = CUSTOMER.C_CURRENT_HDEMO_SK)""],""parentOperators"":[5]},{""id"":9,""operation"":""JoinFilter"",""expressions"":[""joinKey: (INCOME_BAND.IB_INCOME_BAND_SK = HOUSEHOLD_DEMOGRAPHICS.HD_INCOME_BAND_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_INCOME_BAND_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[9]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[8]},{""id"":12,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_CITY = 'Bunker Hill'""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_CITY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""(CUSTOMER.C_CURRENT_CDEMO_SK IS NOT NULL) AND (CUSTOMER.C_CURRENT_HDEMO_SK IS NOT NULL)""],""parentOperators"":[11]},{""id"":15,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = CUSTOMER.C_CURRENT_CDEMO_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_ID"",""C_CURRENT_CDEMO_SK"",""C_CURRENT_HDEMO_SK"",""C_CURRENT_ADDR_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""STORE_RETURNS.SR_CDEMO_SK IS NOT NULL""],""parentOperators"":[2]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = STORE_RETURNS.SR_CDEMO_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_CDEMO_SK""],""partitionsAssigned"":7070,""partitionsTotal"":7070,""bytesAssigned"":124763446272,""parentOperators"":[18]}]]}",01b2e7fd-0002-2e22-0051-ba870002d05e,"explain using json select /* { ""query"":""query84"",""streamId"":0,""querySequence"":80 } */  c_customer_id as customer_id
       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername
 from customer
     ,customer_address
     ,customer_demographics
     ,household_demographics
     ,income_band
     ,store_returns
 where ca_city	        =  'Bunker Hill'
   and c_current_addr_sk = ca_address_sk
   and ib_lower_bound   >=  1797
   and ib_upper_bound   <=  1797 + 50000
   and ib_income_band_sk = hd_income_band_sk
   and cd_demo_sk = c_current_cdemo_sk
   and hd_demo_sk = c_current_hdemo_sk
   and sr_cdemo_sk = cd_demo_sk
 order by c_customer_id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:25.074-07:00,2024-03-10T18:33:25.686-07:00,612,0,0,611,1,0,0,0,0,,,0,,,0,0.000093000,0,8.9.2,0,0,0,0,0,FALSE,deb4293fcd17d7de292d21d23f3b2a72,2,fec8fad4510c6d5343701a0264ab72fe,1
"{""GlobalStats"":{""partitionsTotal"":72982,""partitionsAssigned"":72982,""bytesAssigned"":1254254934528},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER.C_LAST_NAME"",""CUSTOMER.C_FIRST_NAME"",""CUSTOMER.C_SALUTATION"",""CUSTOMER.C_PREFERRED_CUST_FLAG"",""STORE_SALES.SS_TICKET_NUMBER"",""COUNT(*)""]},{""id"":1,""operation"":""Sort"",""expressions"":[""COUNT(*) DESC NULLS FIRST"",""CUSTOMER.C_LAST_NAME ASC NULLS LAST""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_SALUTATION"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_PREFERRED_CUST_FLAG""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""((COUNT(*)) >= 1) AND ((COUNT(*)) <= 5)""],""parentOperators"":[2]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT_INTERNAL(*)(COUNT(*), COUNT_INTERNAL(*)(COUNT(*), COUNT(*)))]"",""groupKeys: [STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[5]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE.S_STORE_SK]""],""parentOperators"":[7]},{""id"":9,""operation"":""Filter"",""expressions"":[""STORE.S_COUNTY IN 'Dauphin County' IN 'Walker County' IN 'Quay County' IN 'Marshall County'""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_COUNTY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT_INTERNAL(*)(COUNT(*), COUNT(*))]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[7]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK]""],""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""(HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL IN '1001-5000' IN '5001-10000') AND (HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0) AND ((IFF(HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0, SCALED_ROUND_INT_DIVIDE(HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT, HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT), null)) > 1)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_BUY_POTENTIAL"",""HD_DEP_COUNT"",""HD_VEHICLE_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[12]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DOM <= 2) AND (DATE_DIM.D_YEAR IN 1998 IN 1999 IN 2000)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_DOM""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[17]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_HDEMO_SK"",""SS_STORE_SK"",""SS_TICKET_NUMBER""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[21]}]]}",01b2e7fd-0002-2ff0-0051-ba8700030066,"explain using json select /* { ""query"":""query73"",""streamId"":0,""querySequence"":79 } */ c_last_name
       ,c_first_name
       ,c_salutation
       ,c_preferred_cust_flag
       ,ss_ticket_number
       ,cnt from
   (select ss_ticket_number
          ,ss_customer_sk
          ,count(*) cnt
    from store_sales,date_dim,store,household_demographics
    where store_sales.ss_sold_date_sk = date_dim.d_date_sk
    and store_sales.ss_store_sk = store.s_store_sk
    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
    and date_dim.d_dom between 1 and 2
    and (household_demographics.hd_buy_potential = '1001-5000' or
         household_demographics.hd_buy_potential = '5001-10000')
    and household_demographics.hd_vehicle_count > 0
    and case when household_demographics.hd_vehicle_count > 0 then
             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1
    and date_dim.d_year in (1998,1998+1,1998+2)
    and store.s_county in ('Dauphin County','Walker County','Quay County','Marshall County')
    group by ss_ticket_number,ss_customer_sk) dj,customer
    where ss_customer_sk = c_customer_sk
      and cnt between 1 and 5
    order by cnt desc, c_last_name asc;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:24.333-07:00,2024-03-10T18:33:24.707-07:00,374,0,0,372,2,0,0,0,0,,,0,,,0,0.000057000,0,8.9.2,0,0,0,0,0,FALSE,458452dfb9e4cd36b6b35de9373f67a4,2,66f70559e4559cf0917847b581c9c01f,1
"{""GlobalStats"":{""partitionsTotal"":169347,""partitionsAssigned"":169347,""bytesAssigned"":2883041743360},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""X.CHANNEL"",""UNION_ALL(STORE.S_STORE_SK, CATALOG_SALES.CS_CALL_CENTER_SK, WEB_PAGE.WP_WEB_PAGE_SK)"",""SUM(UNION_ALL(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE)))))"",""SUM(UNION_ALL(IFNULL(SYS_VW.RETURNS_1, 0), SUM(CATALOG_RETURNS.CR_RETURN_AMOUNT), IFNULL(SYS_VW.RETURNS_1, 0)))"",""SUM(UNION_ALL((SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))) - (IFNULL(SYS_VW.PROFIT_LOSS_0, 0)), (SUM(CATALOG_SALES.CS_NET_PROFIT)) - (SUM(CATALOG_RETURNS.CR_NET_LOSS)), (SUM(SUM(SUM(WEB_SALES.WS_NET_PROFIT)))) - (IFNULL(SYS_VW.PROFIT_LOSS_0, 0))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [X.CHANNEL ASC NULLS LAST, X.ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""GroupingSets"",""expressions"":[""SUM(X.SALES)"",""SUM(X.RETURNS)"",""SUM(X.PROFIT)""],""parentOperators"":[1]},{""id"":3,""operation"":""UnionAll"",""parentOperators"":[2]},{""id"":4,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = SYS_VW.S_STORE_SK_2)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))]"",""groupKeys: [STORE.S_STORE_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)), SUM(SUM(STORE_SALES.SS_NET_PROFIT))]"",""groupKeys: [STORE.S_STORE_SK]""],""parentOperators"":[5]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(STORE_SALES.SS_NET_PROFIT)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[7]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2001-08-21') AND (DATE_DIM.D_DATE <= '2001-09-20')""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[10]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_STORE_SK"",""SS_EXT_SALES_PRICE"",""SS_NET_PROFIT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_RETURNS.SR_RETURN_AMT))), SUM(SUM(SUM(STORE_RETURNS.SR_NET_LOSS)))]"",""groupKeys: [STORE.S_STORE_SK]""],""parentOperators"":[4]},{""id"":17,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_RETURNS.SR_RETURN_AMT)), SUM(SUM(STORE_RETURNS.SR_NET_LOSS))]"",""groupKeys: [STORE.S_STORE_SK]""],""parentOperators"":[16]},{""id"":18,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_RETURNS.SR_STORE_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""Filter"",""expressions"":[""STORE.S_STORE_SK IS NOT NULL""],""parentOperators"":[18]},{""id"":20,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = SYS_VW.S_STORE_SK_2)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[20]},{""id"":22,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_RETURNS.SR_RETURN_AMT), SUM(STORE_RETURNS.SR_NET_LOSS)]"",""groupKeys: [STORE_RETURNS.SR_STORE_SK]""],""parentOperators"":[18]},{""id"":23,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_RETURNS.SR_RETURNED_DATE_SK)""],""parentOperators"":[22]},{""id"":24,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2001-08-21') AND (DATE_DIM.D_DATE <= '2001-09-20')""],""parentOperators"":[23]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[24]},{""id"":26,""operation"":""Filter"",""expressions"":[""(STORE_RETURNS.SR_STORE_SK IS NOT NULL) AND (STORE_RETURNS.SR_STORE_SK IS NOT NULL) AND (STORE_RETURNS.SR_RETURNED_DATE_SK IS NOT NULL)""],""parentOperators"":[23]},{""id"":27,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_RETURNS.SR_STORE_SK)""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_RETURNED_DATE_SK"",""SR_STORE_SK"",""SR_RETURN_AMT"",""SR_NET_LOSS""],""partitionsAssigned"":7070,""partitionsTotal"":7070,""bytesAssigned"":124763446272,""parentOperators"":[27]},{""id"":29,""operation"":""CartesianJoin"",""parentOperators"":[3]},{""id"":30,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(CATALOG_SALES.CS_NET_PROFIT)]"",""groupKeys: [CATALOG_SALES.CS_CALL_CENTER_SK]""],""parentOperators"":[29]},{""id"":31,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[30]},{""id"":32,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2001-08-21') AND (DATE_DIM.D_DATE <= '2001-09-20')""],""parentOperators"":[31]},{""id"":33,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[32]},{""id"":34,""operation"":""Filter"",""expressions"":[""CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[31]},{""id"":35,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[34]},{""id"":36,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_CALL_CENTER_SK"",""CS_EXT_SALES_PRICE"",""CS_NET_PROFIT""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[35]},{""id"":37,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CATALOG_RETURNS.CR_RETURN_AMOUNT), SUM(CATALOG_RETURNS.CR_NET_LOSS)]"",""groupKeys: [CATALOG_RETURNS.CR_CALL_CENTER_SK]""],""parentOperators"":[29]},{""id"":38,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_RETURNS.CR_RETURNED_DATE_SK)""],""parentOperators"":[37]},{""id"":39,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2001-08-21') AND (DATE_DIM.D_DATE <= '2001-09-20')""],""parentOperators"":[38]},{""id"":40,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[39]},{""id"":41,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_RETURNS.CR_RETURNED_DATE_SK)""],""parentOperators"":[38]},{""id"":42,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_RETURNS""],""expressions"":[""CR_RETURNED_DATE_SK"",""CR_CALL_CENTER_SK"",""CR_RETURN_AMOUNT"",""CR_NET_LOSS""],""partitionsAssigned"":4759,""partitionsTotal"":4759,""bytesAssigned"":82532796416,""parentOperators"":[41]},{""id"":43,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (SYS_VW.WP_WEB_PAGE_SK_2 = WEB_PAGE.WP_WEB_PAGE_SK)""],""parentOperators"":[3]},{""id"":44,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(WEB_RETURNS.WR_RETURN_AMT))), SUM(SUM(SUM(WEB_RETURNS.WR_NET_LOSS)))]"",""groupKeys: [WEB_PAGE.WP_WEB_PAGE_SK]""],""parentOperators"":[43]},{""id"":45,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(WEB_RETURNS.WR_RETURN_AMT)), SUM(SUM(WEB_RETURNS.WR_NET_LOSS))]"",""groupKeys: [WEB_PAGE.WP_WEB_PAGE_SK]""],""parentOperators"":[44]},{""id"":46,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_RETURNS.WR_WEB_PAGE_SK)""],""parentOperators"":[45]},{""id"":47,""operation"":""Filter"",""expressions"":[""WEB_PAGE.WP_WEB_PAGE_SK IS NOT NULL""],""parentOperators"":[46]},{""id"":48,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_PAGE""],""expressions"":[""WP_WEB_PAGE_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":63488,""parentOperators"":[47]},{""id"":49,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_RETURNS.WR_RETURN_AMT), SUM(WEB_RETURNS.WR_NET_LOSS)]"",""groupKeys: [WEB_RETURNS.WR_WEB_PAGE_SK]""],""parentOperators"":[46]},{""id"":50,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_RETURNS.WR_RETURNED_DATE_SK)""],""parentOperators"":[49]},{""id"":51,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2001-08-21') AND (DATE_DIM.D_DATE <= '2001-09-20')""],""parentOperators"":[50]},{""id"":52,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[51]},{""id"":53,""operation"":""Filter"",""expressions"":[""(WEB_RETURNS.WR_WEB_PAGE_SK IS NOT NULL) AND (WEB_RETURNS.WR_WEB_PAGE_SK IS NOT NULL) AND (WEB_RETURNS.WR_RETURNED_DATE_SK IS NOT NULL)""],""parentOperators"":[50]},{""id"":54,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_RETURNS.WR_WEB_PAGE_SK)""],""parentOperators"":[53]},{""id"":55,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_RETURNS""],""expressions"":[""WR_RETURNED_DATE_SK"",""WR_WEB_PAGE_SK"",""WR_RETURN_AMT"",""WR_NET_LOSS""],""partitionsAssigned"":2289,""partitionsTotal"":2289,""bytesAssigned"":39149218304,""parentOperators"":[54]},{""id"":56,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE))), SUM(SUM(SUM(WEB_SALES.WS_NET_PROFIT)))]"",""groupKeys: [WEB_PAGE.WP_WEB_PAGE_SK]""],""parentOperators"":[43]},{""id"":57,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE)), SUM(SUM(WEB_SALES.WS_NET_PROFIT))]"",""groupKeys: [WEB_PAGE.WP_WEB_PAGE_SK]""],""parentOperators"":[56]},{""id"":58,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_SALES.WS_WEB_PAGE_SK)""],""parentOperators"":[57]},{""id"":59,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_PAGE""],""expressions"":[""WP_WEB_PAGE_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":63488,""parentOperators"":[58]},{""id"":60,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_EXT_SALES_PRICE), SUM(WEB_SALES.WS_NET_PROFIT)]"",""groupKeys: [WEB_SALES.WS_WEB_PAGE_SK]""],""parentOperators"":[58]},{""id"":61,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[60]},{""id"":62,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2001-08-21') AND (DATE_DIM.D_DATE <= '2001-09-20')""],""parentOperators"":[61]},{""id"":63,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[62]},{""id"":64,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_WEB_PAGE_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[61]},{""id"":65,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_SALES.WS_WEB_PAGE_SK)""],""parentOperators"":[64]},{""id"":66,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_WEB_PAGE_SK"",""WS_EXT_SALES_PRICE"",""WS_NET_PROFIT""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[65]}]]}",01b2e7fd-0002-2d83-0051-ba87000251ea,"explain using json with /* { ""query"":""query77"",""streamId"":0,""querySequence"":78 } */ ss as
 (select s_store_sk,
         sum(ss_ext_sales_price) as sales,
         sum(ss_net_profit) as profit
 from store_sales,
      date_dim,
      store
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('2001-08-21' as date)
                  and (cast('2001-08-21' as date) + interval '30 days')
       and ss_store_sk = s_store_sk
 group by s_store_sk)
 ,
 sr as
 (select s_store_sk,
         sum(sr_return_amt) as returns,
         sum(sr_net_loss) as profit_loss
 from store_returns,
      date_dim,
      store
 where sr_returned_date_sk = d_date_sk
       and d_date between cast('2001-08-21' as date)
                  and (cast('2001-08-21' as date) + interval '30 days')
       and sr_store_sk = s_store_sk
 group by s_store_sk),
 cs as
 (select cs_call_center_sk,
        sum(cs_ext_sales_price) as sales,
        sum(cs_net_profit) as profit
 from catalog_sales,
      date_dim
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('2001-08-21' as date)
                  and (cast('2001-08-21' as date) + interval '30 days')
 group by cs_call_center_sk
 ),
 cr as
 (select cr_call_center_sk,
         sum(cr_return_amount) as returns,
         sum(cr_net_loss) as profit_loss
 from catalog_returns,
      date_dim
 where cr_returned_date_sk = d_date_sk
       and d_date between cast('2001-08-21' as date)
                  and (cast('2001-08-21' as date) + interval '30 days')
 group by cr_call_center_sk
 ),
 ws as
 ( select wp_web_page_sk,
        sum(ws_ext_sales_price) as sales,
        sum(ws_net_profit) as profit
 from web_sales,
      date_dim,
      web_page
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('2001-08-21' as date)
                  and (cast('2001-08-21' as date) + interval '30 days')
       and ws_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk),
 wr as
 (select wp_web_page_sk,
        sum(wr_return_amt) as returns,
        sum(wr_net_loss) as profit_loss
 from web_returns,
      date_dim,
      web_page
 where wr_returned_date_sk = d_date_sk
       and d_date between cast('2001-08-21' as date)
                  and (cast('2001-08-21' as date) + interval '30 days')
       and wr_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from
 (select 'store channel' as channel
        , ss.s_store_sk as id
        , sales
        , coalesce(returns, 0) as returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ss left join sr
        on  ss.s_store_sk = sr.s_store_sk
 union all
 select 'catalog channel' as channel
        , cs_call_center_sk as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  cs
       , cr
 union all
 select 'web channel' as channel
        , ws.wp_web_page_sk as id
        , sales
        , coalesce(returns, 0) returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ws left join wr
        on  ws.wp_web_page_sk = wr.wp_web_page_sk
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:22.778-07:00,2024-03-10T18:33:23.837-07:00,1059,0,0,1057,2,0,0,0,0,,,0,,,0,0.000162000,0,8.9.2,0,0,0,0,0,FALSE,31135642d07754374b7a31ba3e98c23e,2,31135642d07754374b7a31ba3e98c23e,1
"{""GlobalStats"":{""partitionsTotal"":156005,""partitionsAssigned"":156005,""bytesAssigned"":2643575084032},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""COUNT(*)""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[2]},{""id"":4,""operation"":""AntiJoin"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[4]},{""id"":6,""operation"":""AntiJoin"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[5]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME]""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[10]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK, DATE_DIM.D_DATE]""],""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1182) AND (DATE_DIM.D_MONTH_SEQ <= 1193)""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[16]},{""id"":18,""operation"":""Aggregate"",""expressions"":[""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[14]},{""id"":19,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[18]},{""id"":20,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[20]},{""id"":22,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[6]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[22]},{""id"":24,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[23]},{""id"":25,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[24]},{""id"":26,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME]""],""parentOperators"":[25]},{""id"":27,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[27]},{""id"":29,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE, CATALOG_SALES.CS_BILL_CUSTOMER_SK]""],""parentOperators"":[25]},{""id"":30,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[29]},{""id"":31,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK, DATE_DIM.D_DATE]""],""parentOperators"":[30]},{""id"":32,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1182) AND (DATE_DIM.D_MONTH_SEQ <= 1193)""],""parentOperators"":[31]},{""id"":33,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[32]},{""id"":34,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[33]},{""id"":35,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_BILL_CUSTOMER_SK, CATALOG_SALES.CS_SOLD_DATE_SK]""],""parentOperators"":[30]},{""id"":36,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[35]},{""id"":37,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[36]},{""id"":38,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[37]},{""id"":39,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[4]},{""id"":40,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[39]},{""id"":41,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[40]},{""id"":42,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[41]},{""id"":43,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME]""],""parentOperators"":[42]},{""id"":44,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[43]},{""id"":45,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[44]},{""id"":46,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE, WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[42]},{""id"":47,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[46]},{""id"":48,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK, DATE_DIM.D_DATE]""],""parentOperators"":[47]},{""id"":49,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1182) AND (DATE_DIM.D_MONTH_SEQ <= 1193)""],""parentOperators"":[48]},{""id"":50,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[49]},{""id"":51,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[50]},{""id"":52,""operation"":""Aggregate"",""expressions"":[""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK, WEB_SALES.WS_SOLD_DATE_SK]""],""parentOperators"":[47]},{""id"":53,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[52]},{""id"":54,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[53]},{""id"":55,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_BILL_CUSTOMER_SK""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[54]}]]}",01b2e7fd-0002-2e24-0051-ba870001d216,"explain using json select /* { ""query"":""query87"",""streamId"":0,""querySequence"":77 } */ count(*)
from ((select distinct c_last_name, c_first_name, d_date
       from store_sales, date_dim, customer
       where store_sales.ss_sold_date_sk = date_dim.d_date_sk
         and store_sales.ss_customer_sk = customer.c_customer_sk
         and d_month_seq between 1182 and 1182+11)
       except
      (select distinct c_last_name, c_first_name, d_date
       from catalog_sales, date_dim, customer
       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk
         and d_month_seq between 1182 and 1182+11)
       except
      (select distinct c_last_name, c_first_name, d_date
       from web_sales, date_dim, customer
       where web_sales.ws_sold_date_sk = date_dim.d_date_sk
         and web_sales.ws_bill_customer_sk = customer.c_customer_sk
         and d_month_seq between 1182 and 1182+11)
) cool_cust
;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:21.756-07:00,2024-03-10T18:33:22.262-07:00,506,0,0,505,1,0,0,0,0,,,0,,,0,0.000077000,0,8.9.2,0,0,0,0,0,FALSE,465a4e2d04b3d9ef53b0e60139ddec9d,2,465a4e2d04b3d9ef53b0e60139ddec9d,1
"{""GlobalStats"":{""partitionsTotal"":54926,""partitionsAssigned"":54926,""bytesAssigned"":923643444224},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""V1.I_BRAND"",""V1.D_YEAR"",""V1.D_MOY"",""V1.AVG_MONTHLY_SALES"",""V1.SUM_SALES"",""V1_LAG.SUM_SALES"",""V1_LEAD.SUM_SALES""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [(V1.SUM_SALES) - V1.AVG_MONTHLY_SALES ASC NULLS LAST, V1_LEAD.SUM_SALES ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (V1.RN = (V1_LEAD.RN) - 1) AND (V1.CC_NAME = V1_LEAD.CC_NAME) AND (V1.I_BRAND = V1_LEAD.I_BRAND) AND (V1.I_CATEGORY = V1_LEAD.I_CATEGORY)""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: ((V1_LAG.RN) + 1 = V1.RN) AND (V1_LAG.CC_NAME = V1.CC_NAME) AND (V1_LAG.I_BRAND = V1.I_BRAND) AND (V1_LAG.I_CATEGORY = V1.I_CATEGORY)""],""parentOperators"":[2]},{""id"":4,""operation"":""WithReference"",""expressions"":[""V1_LAG""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""(V1_LAG.I_BRAND IS NOT NULL) AND (V1_LAG.I_CATEGORY IS NOT NULL)""],""parentOperators"":[4]},{""id"":6,""operation"":""WithClause"",""expressions"":[""V1""],""parentOperators"":[5,25,29]},{""id"":7,""operation"":""WindowFunction"",""expressions"":[""AVG(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR)"",""RANK() OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME ORDER BY DATE_DIM.D_YEAR ASC NULLS LAST, DATE_DIM.D_MOY ASC NULLS LAST)""],""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))]"",""groupKeys: [ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR, DATE_DIM.D_MOY]""],""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))]"",""groupKeys: [ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR, DATE_DIM.D_MOY]""],""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CALL_CENTER.CC_CALL_CENTER_SK = CATALOG_SALES.CS_CALL_CENTER_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CALL_CENTER""],""expressions"":[""CC_CALL_CENTER_SK"",""CC_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":18432,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))]"",""groupKeys: [ITEM.I_BRAND, ITEM.I_CATEGORY, DATE_DIM.D_YEAR, DATE_DIM.D_MOY, CATALOG_SALES.CS_CALL_CENTER_SK]""],""parentOperators"":[10]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[13]},{""id"":15,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CATALOG_SALES.CS_SALES_PRICE)]"",""groupKeys: [DATE_DIM.D_YEAR, DATE_DIM.D_MOY, CATALOG_SALES.CS_CALL_CENTER_SK, CATALOG_SALES.CS_ITEM_SK]""],""parentOperators"":[13]},{""id"":16,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR IN 1999 IN 1998 IN 2000) AND ((DATE_DIM.D_YEAR = 1999) OR ((DATE_DIM.D_YEAR = 1998) AND (DATE_DIM.D_MOY = 12)) OR ((DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_MOY = 1)))""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[17]},{""id"":19,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_CALL_CENTER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[16]},{""id"":20,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CALL_CENTER.CC_CALL_CENTER_SK = CATALOG_SALES.CS_CALL_CENTER_SK)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_CALL_CENTER_SK"",""CS_ITEM_SK"",""CS_SALES_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[20]},{""id"":22,""operation"":""JoinFilter"",""expressions"":[""joinKey: ((V1_LAG.RN) + 1 = V1.RN) AND (V1_LAG.CC_NAME = V1.CC_NAME) AND (V1_LAG.I_BRAND = V1.I_BRAND) AND (V1_LAG.I_CATEGORY = V1.I_CATEGORY)""],""parentOperators"":[3]},{""id"":23,""operation"":""WithReference"",""parentOperators"":[22]},{""id"":24,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (AVG(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR) > 0) AND ((IFF(AVG(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR) > 0, SCALED_ROUND_INT_DIVIDE(ABS((SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))) - AVG(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR)), AVG(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR)), null)) > 0.1) AND (V1.I_BRAND IS NOT NULL) AND (V1.I_CATEGORY IS NOT NULL)""],""parentOperators"":[23]},{""id"":25,""operation"":""Filter"",""expressions"":[""(V1.I_BRAND IS NOT NULL) AND (V1.I_CATEGORY IS NOT NULL)""],""parentOperators"":[24]},{""id"":26,""operation"":""JoinFilter"",""expressions"":[""joinKey: (V1.RN = (V1_LEAD.RN) - 1) AND (V1.CC_NAME = V1_LEAD.CC_NAME) AND (V1.I_BRAND = V1_LEAD.I_BRAND) AND (V1.I_CATEGORY = V1_LEAD.I_CATEGORY)""],""parentOperators"":[2]},{""id"":27,""operation"":""WithReference"",""expressions"":[""V1_LEAD""],""parentOperators"":[26]},{""id"":28,""operation"":""Filter"",""expressions"":[""(V1_LEAD.I_BRAND IS NOT NULL) AND (V1_LEAD.I_CATEGORY IS NOT NULL)""],""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""(V1_LEAD.I_BRAND IS NOT NULL) AND (V1_LEAD.I_CATEGORY IS NOT NULL)""],""parentOperators"":[28]}]]}",01b2e7fd-0002-2e24-0051-ba870001d212,"explain using json with /* { ""query"":""query57"",""streamId"":0,""querySequence"":70 } */ v1 as(
 select i_category, i_brand,
        cc_name,
        d_year, d_moy,
        sum(cs_sales_price) sum_sales,
        avg(sum(cs_sales_price)) over
          (partition by i_category, i_brand,
                     cc_name, d_year)
          avg_monthly_sales,
        rank() over
          (partition by i_category, i_brand,
                     cc_name
           order by d_year, d_moy) rn
 from item, catalog_sales, date_dim, call_center
 where cs_item_sk = i_item_sk and
       cs_sold_date_sk = d_date_sk and
       cc_call_center_sk= cs_call_center_sk and
       (
         d_year = 1999 or
         ( d_year = 1999-1 and d_moy =12) or
         ( d_year = 1999+1 and d_moy =1)
       )
 group by i_category, i_brand,
          cc_name , d_year, d_moy),
 v2 as(
 select v1.i_brand
        ,v1.d_year, v1.d_moy
        ,v1.avg_monthly_sales
        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum
 from v1, v1 v1_lag, v1 v1_lead
 where v1.i_category = v1_lag.i_category and
       v1.i_category = v1_lead.i_category and
       v1.i_brand = v1_lag.i_brand and
       v1.i_brand = v1_lead.i_brand and
       v1. cc_name = v1_lag. cc_name and
       v1. cc_name = v1_lead. cc_name and
       v1.rn = v1_lag.rn + 1 and
       v1.rn = v1_lead.rn - 1)
  select  *
 from v2
 where  d_year = 1999 and
        avg_monthly_sales > 0 and
        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1
 order by sum_sales - avg_monthly_sales, nsum
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:14.389-07:00,2024-03-10T18:33:14.931-07:00,542,0,0,541,1,0,0,0,0,,,0,,,0,0.000083000,0,8.9.2,0,0,0,0,0,FALSE,975b9b92e674fb10a61e9a776b3544a5,2,c0b041b65c9d7925ffa207c60b7c9768,1
"{""GlobalStats"":{""partitionsTotal"":465680,""partitionsAssigned"":465680,""bytesAssigned"":7909935085568},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SCALED_ROUND_INT_DIVIDE(SUM((UNION_ALL(STORE_SALES.SS_QUANTITY, CATALOG_SALES.CS_QUANTITY, WEB_SALES.WS_QUANTITY)) * (UNION_ALL(STORE_SALES.SS_LIST_PRICE, CATALOG_SALES.CS_LIST_PRICE, WEB_SALES.WS_LIST_PRICE))), COUNT((UNION_ALL(STORE_SALES.SS_QUANTITY, CATALOG_SALES.CS_QUANTITY, WEB_SALES.WS_QUANTITY)) * (UNION_ALL(STORE_SALES.SS_LIST_PRICE, CATALOG_SALES.CS_LIST_PRICE, WEB_SALES.WS_LIST_PRICE))))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((UNION_ALL(STORE_SALES.SS_QUANTITY, CATALOG_SALES.CS_QUANTITY, WEB_SALES.WS_QUANTITY)) * (UNION_ALL(STORE_SALES.SS_LIST_PRICE, CATALOG_SALES.CS_LIST_PRICE, WEB_SALES.WS_LIST_PRICE))), COUNT((UNION_ALL(STORE_SALES.SS_QUANTITY, CATALOG_SALES.CS_QUANTITY, WEB_SALES.WS_QUANTITY)) * (UNION_ALL(STORE_SALES.SS_LIST_PRICE, CATALOG_SALES.CS_LIST_PRICE, WEB_SALES.WS_LIST_PRICE)))]""],""parentOperators"":[0]},{""id"":2,""operation"":""UnionAll"",""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR >= 1998) AND (DATE_DIM.D_YEAR <= 2000)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[4]},{""id"":6,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[3]},{""id"":7,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_QUANTITY"",""SS_LIST_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[2]},{""id"":10,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR >= 1998) AND (DATE_DIM.D_YEAR <= 2000)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[9]},{""id"":13,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_QUANTITY"",""CS_LIST_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[13]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[2]},{""id"":16,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR >= 1998) AND (DATE_DIM.D_YEAR <= 2000)""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[15]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_QUANTITY"",""WS_LIST_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[19]}],[{""id"":0,""operation"":""Result"",""expressions"":[""Y.CHANNEL"",""UNION_ALL(ITEM.I_BRAND_ID, ITEM.I_BRAND_ID, ITEM.I_BRAND_ID)"",""UNION_ALL(ITEM.I_CLASS_ID, ITEM.I_CLASS_ID, ITEM.I_CLASS_ID)"",""UNION_ALL(ITEM.I_CATEGORY_ID, ITEM.I_CATEGORY_ID, ITEM.I_CATEGORY_ID)"",""SUM(UNION_ALL(SUM(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_LIST_PRICE)))), SUM((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE)), SUM(SUM(SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE))))))"",""SUM(UNION_ALL(COUNT(*), COUNT(*), COUNT(*)))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [Y.CHANNEL ASC NULLS LAST, Y.I_BRAND_ID ASC NULLS LAST, Y.I_CLASS_ID ASC NULLS LAST, Y.I_CATEGORY_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""GroupingSets"",""expressions"":[""SUM(Y.SALES)"",""SUM(Y.NUMBER_SALES)""],""parentOperators"":[1]},{""id"":3,""operation"":""UnionAll"",""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""(SUM(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_LIST_PRICE))))) > Subquery(Step1)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_LIST_PRICE)))), COUNT(*)]"",""groupKeys: [ITEM.I_BRAND_ID, ITEM.I_CLASS_ID, ITEM.I_CATEGORY_ID]""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_LIST_PRICE))), COUNT(*)]"",""groupKeys: [ITEM.I_BRAND_ID, ITEM.I_CLASS_ID, ITEM.I_CATEGORY_ID]""],""parentOperators"":[5]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_CLASS_ID"",""I_CATEGORY_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_LIST_PRICE)), COUNT(*)]"",""groupKeys: [STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[7]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_MOY = 11)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[11]},{""id"":13,""operation"":""SemiJoin"",""expressions"":[""joinKey: (CROSS_ITEMS.SS_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[10]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CROSS_ITEMS.SS_ITEM_SK]""],""parentOperators"":[13]},{""id"":15,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""WithReference"",""parentOperators"":[15]},{""id"":17,""operation"":""WithClause"",""expressions"":[""CROSS_ITEMS""],""parentOperators"":[16,82,98]},{""id"":18,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ISS.I_BRAND_ID = ITEM.I_BRAND_ID) AND (ISS.I_CATEGORY_ID = ITEM.I_CATEGORY_ID) AND (ISS.I_CLASS_ID = ITEM.I_CLASS_ID)""],""parentOperators"":[17]},{""id"":19,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ISS.I_BRAND_ID = IWS.I_BRAND_ID) AND (ISS.I_CATEGORY_ID = IWS.I_CATEGORY_ID) AND (ISS.I_CLASS_ID = IWS.I_CLASS_ID)""],""parentOperators"":[18]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ISS.I_BRAND_ID, ISS.I_CLASS_ID, ISS.I_CATEGORY_ID]""],""parentOperators"":[19]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ISS.I_BRAND_ID, ISS.I_CLASS_ID, ISS.I_CATEGORY_ID]""],""parentOperators"":[20]},{""id"":22,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ICS.I_BRAND_ID = ISS.I_BRAND_ID) AND (ICS.I_CATEGORY_ID = ISS.I_CATEGORY_ID) AND (ICS.I_CLASS_ID = ISS.I_CLASS_ID)""],""parentOperators"":[21]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ICS.I_BRAND_ID, ICS.I_CATEGORY_ID, ICS.I_CLASS_ID]""],""parentOperators"":[22]},{""id"":24,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ICS.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[23]},{""id"":26,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_CLASS_ID"",""I_CATEGORY_ID""],""alias"":""ICS"",""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[25]},{""id"":28,""operation"":""SemiJoin"",""expressions"":[""joinKey: (D2.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[27]},{""id"":29,""operation"":""Aggregate"",""expressions"":[""groupKeys: [D2.D_DATE_SK]""],""parentOperators"":[28]},{""id"":30,""operation"":""Filter"",""expressions"":[""(D2.D_YEAR >= 1998) AND (D2.D_YEAR <= 2000)""],""parentOperators"":[29]},{""id"":31,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""alias"":""D2"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[30]},{""id"":33,""operation"":""Filter"",""expressions"":[""CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[32]},{""id"":34,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ICS.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[33]},{""id"":35,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_ITEM_SK""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[34]},{""id"":36,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ISS.I_BRAND_ID, ISS.I_CLASS_ID, ISS.I_CATEGORY_ID]""],""parentOperators"":[22]},{""id"":37,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ISS.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[36]},{""id"":38,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ISS.I_ITEM_SK, ISS.I_BRAND_ID, ISS.I_CLASS_ID, ISS.I_CATEGORY_ID]""],""parentOperators"":[37]},{""id"":39,""operation"":""Filter"",""expressions"":[""(ISS.I_BRAND_ID IS NOT NULL) AND (ISS.I_CATEGORY_ID IS NOT NULL) AND (ISS.I_CLASS_ID IS NOT NULL)""],""parentOperators"":[38]},{""id"":40,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ICS.I_BRAND_ID = ISS.I_BRAND_ID) AND (ICS.I_CATEGORY_ID = ISS.I_CATEGORY_ID) AND (ICS.I_CLASS_ID = ISS.I_CLASS_ID)""],""parentOperators"":[39]},{""id"":41,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_CLASS_ID"",""I_CATEGORY_ID""],""alias"":""ISS"",""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[40]},{""id"":43,""operation"":""SemiJoin"",""expressions"":[""joinKey: (D1.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[42]},{""id"":44,""operation"":""Aggregate"",""expressions"":[""groupKeys: [D1.D_DATE_SK]""],""parentOperators"":[43]},{""id"":45,""operation"":""Filter"",""expressions"":[""(D1.D_YEAR >= 1998) AND (D1.D_YEAR <= 2000)""],""parentOperators"":[44]},{""id"":46,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""alias"":""D1"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[45]},{""id"":48,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[47]},{""id"":49,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ISS.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[48]},{""id"":50,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[49]},{""id"":52,""operation"":""SemiJoin"",""expressions"":[""joinKey: (IWS.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[51]},{""id"":54,""operation"":""Filter"",""expressions"":[""(IWS.I_BRAND_ID IS NOT NULL) AND (IWS.I_CATEGORY_ID IS NOT NULL) AND (IWS.I_CLASS_ID IS NOT NULL)""],""parentOperators"":[53]},{""id"":55,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ISS.I_BRAND_ID = IWS.I_BRAND_ID) AND (ISS.I_CATEGORY_ID = IWS.I_CATEGORY_ID) AND (ISS.I_CLASS_ID = IWS.I_CLASS_ID)""],""parentOperators"":[54]},{""id"":56,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_CLASS_ID"",""I_CATEGORY_ID""],""alias"":""IWS"",""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[55]},{""id"":58,""operation"":""SemiJoin"",""expressions"":[""joinKey: (D3.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[57]},{""id"":59,""operation"":""Aggregate"",""expressions"":[""groupKeys: [D3.D_DATE_SK]""],""parentOperators"":[58]},{""id"":60,""operation"":""Filter"",""expressions"":[""(D3.D_YEAR >= 1998) AND (D3.D_YEAR <= 2000)""],""parentOperators"":[59]},{""id"":61,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""alias"":""D3"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[60]},{""id"":63,""operation"":""Filter"",""expressions"":[""WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[62]},{""id"":64,""operation"":""JoinFilter"",""expressions"":[""joinKey: (IWS.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[63]},{""id"":65,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[64]},{""id"":66,""operation"":""Filter"",""expressions"":[""(ITEM.I_BRAND_ID IS NOT NULL) AND (ITEM.I_CATEGORY_ID IS NOT NULL) AND (ITEM.I_CLASS_ID IS NOT NULL)""],""parentOperators"":[18]},{""id"":67,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ISS.I_BRAND_ID = ITEM.I_BRAND_ID) AND (ISS.I_CATEGORY_ID = ITEM.I_CATEGORY_ID) AND (ISS.I_CLASS_ID = ITEM.I_CLASS_ID)""],""parentOperators"":[66]},{""id"":68,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_CLASS_ID"",""I_CATEGORY_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[67]},{""id"":69,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[13]},{""id"":70,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[69]},{""id"":71,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_QUANTITY"",""SS_LIST_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[70]},{""id"":72,""operation"":""Filter"",""expressions"":[""(SUM((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE))) > Subquery(Step1)""],""parentOperators"":[3]},{""id"":73,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE)), COUNT(*)]"",""groupKeys: [ITEM.I_BRAND_ID, ITEM.I_CLASS_ID, ITEM.I_CATEGORY_ID]""],""parentOperators"":[72]},{""id"":74,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[73]},{""id"":75,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_MOY = 11)""],""parentOperators"":[74]},{""id"":76,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[75]},{""id"":77,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[74]},{""id"":78,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_CLASS_ID"",""I_CATEGORY_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[77]},{""id"":79,""operation"":""SemiJoin"",""expressions"":[""joinKey: (CROSS_ITEMS.SS_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[77]},{""id"":80,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CROSS_ITEMS.SS_ITEM_SK]""],""parentOperators"":[79]},{""id"":81,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[80]},{""id"":82,""operation"":""WithReference"",""parentOperators"":[81]},{""id"":83,""operation"":""Filter"",""expressions"":[""CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[79]},{""id"":84,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[83]},{""id"":85,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_ITEM_SK"",""CS_QUANTITY"",""CS_LIST_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[84]},{""id"":86,""operation"":""Filter"",""expressions"":[""(SUM(SUM(SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE))))) > Subquery(Step1)""],""parentOperators"":[3]},{""id"":87,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE)))), COUNT(*)]"",""groupKeys: [ITEM.I_BRAND_ID, ITEM.I_CLASS_ID, ITEM.I_CATEGORY_ID]""],""parentOperators"":[86]},{""id"":88,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE))), COUNT(*)]"",""groupKeys: [ITEM.I_BRAND_ID, ITEM.I_CLASS_ID, ITEM.I_CATEGORY_ID]""],""parentOperators"":[87]},{""id"":89,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[88]},{""id"":90,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_CLASS_ID"",""I_CATEGORY_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[89]},{""id"":91,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE)), COUNT(*)]"",""groupKeys: [WEB_SALES.WS_ITEM_SK]""],""parentOperators"":[89]},{""id"":92,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[91]},{""id"":93,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_MOY = 11)""],""parentOperators"":[92]},{""id"":94,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[93]},{""id"":95,""operation"":""SemiJoin"",""expressions"":[""joinKey: (CROSS_ITEMS.SS_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[92]},{""id"":96,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CROSS_ITEMS.SS_ITEM_SK]""],""parentOperators"":[95]},{""id"":97,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[96]},{""id"":98,""operation"":""WithReference"",""parentOperators"":[97]},{""id"":99,""operation"":""Filter"",""expressions"":[""WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[95]},{""id"":100,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[99]},{""id"":101,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_QUANTITY"",""WS_LIST_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[100]}]]}",01b2e7fc-0002-2f4b-0051-ba8700026182,"explain using json with /* { ""query"":""query14_p1"",""streamId"":0,""querySequence"":69 } */  cross_items as
 (select i_item_sk ss_item_sk
 from item,
 (select iss.i_brand_id brand_id
     ,iss.i_class_id class_id
     ,iss.i_category_id category_id
 from store_sales
     ,item iss
     ,date_dim d1
 where ss_item_sk = iss.i_item_sk
   and ss_sold_date_sk = d1.d_date_sk
   and d1.d_year between 1998 AND 1998 + 2
 intersect
 select ics.i_brand_id
     ,ics.i_class_id
     ,ics.i_category_id
 from catalog_sales
     ,item ics
     ,date_dim d2
 where cs_item_sk = ics.i_item_sk
   and cs_sold_date_sk = d2.d_date_sk
   and d2.d_year between 1998 AND 1998 + 2
 intersect
 select iws.i_brand_id
     ,iws.i_class_id
     ,iws.i_category_id
 from web_sales
     ,item iws
     ,date_dim d3
 where ws_item_sk = iws.i_item_sk
   and ws_sold_date_sk = d3.d_date_sk
   and d3.d_year between 1998 AND 1998 + 2)
 where i_brand_id = brand_id
      and i_class_id = class_id
      and i_category_id = category_id
),
 avg_sales as
 (select avg(quantity*list_price) average_sales
  from (select ss_quantity quantity
             ,ss_list_price list_price
       from store_sales
           ,date_dim
       where ss_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select cs_quantity quantity
             ,cs_list_price list_price
       from catalog_sales
           ,date_dim
       where cs_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select ws_quantity quantity
             ,ws_list_price list_price
       from web_sales
           ,date_dim
       where ws_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2) x)
  select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)
 from(
       select 'store' channel, i_brand_id,i_class_id
             ,i_category_id,sum(ss_quantity*ss_list_price) sales
             , count(*) number_sales
       from store_sales
           ,item
           ,date_dim
       where ss_item_sk in (select ss_item_sk from cross_items)
         and ss_item_sk = i_item_sk
         and ss_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)
       union all
       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales
       from catalog_sales
           ,item
           ,date_dim
       where cs_item_sk in (select ss_item_sk from cross_items)
         and cs_item_sk = i_item_sk
         and cs_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)
       union all
       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales
       from web_sales
           ,item
           ,date_dim
       where ws_item_sk in (select ss_item_sk from cross_items)
         and ws_item_sk = i_item_sk
         and ws_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)
 ) y
 group by rollup (channel, i_brand_id,i_class_id,i_category_id)
 order by channel,i_brand_id,i_class_id,i_category_id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:21.061-07:00,2024-03-10T18:32:22.697-07:00,1636,0,0,1633,3,0,0,0,0,,,0,,,0,0.000250000,0,8.9.2,0,0,0,0,0,FALSE,8a6301d750a388fb2b3c8231145aac5e,2,f4b7d17783b721509fbe659f27915940,1
"{""GlobalStats"":{""partitionsTotal"":73000,""partitionsAssigned"":73000,""bytesAssigned"":1255608787968},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""ITEM.I_ITEM_DESC"",""ITEM.I_CURRENT_PRICE""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [ITEM.I_ITEM_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[2]},{""id"":4,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[4]},{""id"":6,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = INVENTORY.INV_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '1999-03-14') AND (DATE_DIM.D_DATE <= '1999-05-13')""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = INVENTORY.INV_ITEM_SK)""],""parentOperators"":[6]},{""id"":11,""operation"":""Filter"",""expressions"":[""(ITEM.I_CURRENT_PRICE >= 26) AND (ITEM.I_CURRENT_PRICE <= 56) AND (ITEM.I_MANUFACT_ID IN 427 IN 254 IN 976 IN 359)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID"",""I_ITEM_DESC"",""I_CURRENT_PRICE"",""I_MANUFACT_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[11]},{""id"":14,""operation"":""Filter"",""expressions"":[""(INVENTORY.INV_QUANTITY_ON_HAND >= 100) AND (INVENTORY.INV_QUANTITY_ON_HAND <= 500)""],""parentOperators"":[13]},{""id"":15,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = INVENTORY.INV_DATE_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.INVENTORY""],""expressions"":[""INV_DATE_SK"",""INV_ITEM_SK"",""INV_QUANTITY_ON_HAND""],""partitionsAssigned"":279,""partitionsTotal"":279,""bytesAssigned"":3658746880,""parentOperators"":[15]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_ITEM_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[18]}]]}",01b2e7fc-0002-2d83-0051-ba87000251de,"explain using json select /* { ""query"":""query82"",""streamId"":0,""querySequence"":67 } */  i_item_id
       ,i_item_desc
       ,i_current_price
 from item, inventory, date_dim, store_sales
 where i_current_price between 26 and 26+30
 and inv_item_sk = i_item_sk
 and d_date_sk=inv_date_sk
 and d_date between cast('1999-03-14' as date) and (cast('1999-03-14' as date) + interval '60 days')
 and i_manufact_id in (427,254,976,359)
 and inv_quantity_on_hand between 100 and 500
 and ss_item_sk = i_item_sk
 group by i_item_id,i_item_desc,i_current_price
 order by i_item_id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:16.66-07:00,2024-03-10T18:32:17.015-07:00,355,0,0,354,1,0,0,0,0,,,0,,,0,0.000054000,0,8.9.2,0,0,0,0,0,FALSE,e49e7941c82b643c69d8189d0693571b,2,e49e7941c82b643c69d8189d0693571b,1
"{""GlobalStats"":{""partitionsTotal"":27582,""partitionsAssigned"":27582,""bytesAssigned"":461067436032},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""ITEM.I_ITEM_DESC"",""ITEM.I_CATEGORY"",""ITEM.I_CLASS"",""ITEM.I_CURRENT_PRICE"",""SUM(SUM_INTERNAL(SUM(WEB_SALES.WS_EXT_SALES_PRICE), COUNT(*)))"",""((SUM(SUM_INTERNAL(SUM(WEB_SALES.WS_EXT_SALES_PRICE), COUNT(*)))) * 100) / (SUM(SUM(SUM_INTERNAL(SUM(WEB_SALES.WS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [ITEM.I_CATEGORY ASC NULLS LAST, ITEM.I_CLASS ASC NULLS LAST, ITEM.I_ITEM_ID ASC NULLS LAST, ITEM.I_ITEM_DESC ASC NULLS LAST, ((SUM(WEB_SALES.WS_EXT_SALES_PRICE)) * 100) / (SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE)) OVER (PARTITION BY ITEM.I_CLASS)) ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""WindowFunction"",""expressions"":[""SUM(SUM(SUM_INTERNAL(SUM(WEB_SALES.WS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS)"",""SUM(SUM(SUM_INTERNAL(SUM(WEB_SALES.WS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS)""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(WEB_SALES.WS_EXT_SALES_PRICE), COUNT(*)))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(WEB_SALES.WS_EXT_SALES_PRICE), COUNT(*))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CURRENT_PRICE, ITEM.I_CLASS, ITEM.I_CATEGORY]""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""ITEM.I_CATEGORY IN 'Women' IN 'Books' IN 'Shoes'""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID"",""I_ITEM_DESC"",""I_CURRENT_PRICE"",""I_CLASS"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_EXT_SALES_PRICE)]"",""groupKeys: [WEB_SALES.WS_ITEM_SK]""],""parentOperators"":[5]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2002-05-01') AND (DATE_DIM.D_DATE <= '2002-05-31')""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[10]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_EXT_SALES_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[14]}]]}",01b2e7fc-0002-2f99-0051-ba87000281aa,"explain using json select /* { ""query"":""query12"",""streamId"":0,""querySequence"":64 } */  i_item_id
      ,i_item_desc
      ,i_category
      ,i_class
      ,i_current_price
      ,sum(ws_ext_sales_price) as itemrevenue
      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over
          (partition by i_class) as revenueratio
from
	web_sales
    	,item
    	,date_dim
where
	ws_item_sk = i_item_sk
  	and i_category in ('Women', 'Books', 'Shoes')
  	and ws_sold_date_sk = d_date_sk
	and d_date between cast('2002-05-01' as date)
				and (cast('2002-05-01' as date) + interval '30 days')
group by
	i_item_id
        ,i_item_desc
        ,i_category
        ,i_class
        ,i_current_price
order by
	i_category
        ,i_class
        ,i_item_id
        ,i_item_desc
        ,revenueratio
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:13.597-07:00,2024-03-10T18:32:13.803-07:00,206,0,0,205,1,0,0,0,0,,,0,,,0,0.000031000,0,8.9.2,0,0,0,0,0,FALSE,ad0c8f9fa23a25e0e2dfd54c68295c93,2,ad0c8f9fa23a25e0e2dfd54c68295c93,1
"{""GlobalStats"":{""partitionsTotal"":282,""partitionsAssigned"":282,""bytesAssigned"":3684697088},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_PRODUCT_NAME"",""ITEM.I_BRAND"",""ITEM.I_CLASS"",""ITEM.I_CATEGORY"",""SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(INVENTORY.INV_QUANTITY_ON_HAND, COUNT(*))), COUNT(COUNT_INTERNAL(INVENTORY.INV_QUANTITY_ON_HAND, COUNT(*))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [SCALED_ROUND_INT_DIVIDE(SUM(INVENTORY.INV_QUANTITY_ON_HAND), COUNT(INVENTORY.INV_QUANTITY_ON_HAND)) ASC NULLS LAST, ITEM.I_PRODUCT_NAME ASC NULLS LAST, ITEM.I_BRAND ASC NULLS LAST, ITEM.I_CLASS ASC NULLS LAST, ITEM.I_CATEGORY ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""GroupingSets"",""expressions"":[""SUM(INVENTORY.INV_QUANTITY_ON_HAND)"",""COUNT(INVENTORY.INV_QUANTITY_ON_HAND)"",""SUM(INVENTORY.INV_QUANTITY_ON_HAND)"",""COUNT(INVENTORY.INV_QUANTITY_ON_HAND)""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(INVENTORY.INV_QUANTITY_ON_HAND, COUNT(*))), COUNT(COUNT_INTERNAL(INVENTORY.INV_QUANTITY_ON_HAND, COUNT(*)))]"",""groupKeys: [ITEM.I_PRODUCT_NAME, ITEM.I_BRAND, ITEM.I_CLASS, ITEM.I_CATEGORY]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(INVENTORY.INV_QUANTITY_ON_HAND, COUNT(*)), COUNT_INTERNAL(INVENTORY.INV_QUANTITY_ON_HAND, COUNT(*))]"",""groupKeys: [ITEM.I_PRODUCT_NAME, ITEM.I_BRAND, ITEM.I_CLASS, ITEM.I_CATEGORY]""],""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = INVENTORY.INV_ITEM_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_BRAND, ITEM.I_CLASS, ITEM.I_CATEGORY, ITEM.I_PRODUCT_NAME]""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND"",""I_CLASS"",""I_CATEGORY"",""I_PRODUCT_NAME""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[6]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = INVENTORY.INV_DATE_SK)""],""parentOperators"":[5]},{""id"":9,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1176) AND (DATE_DIM.D_MONTH_SEQ <= 1187)""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[9]},{""id"":11,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = INVENTORY.INV_ITEM_SK)""],""parentOperators"":[8]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.INVENTORY""],""expressions"":[""INV_DATE_SK"",""INV_ITEM_SK"",""INV_QUANTITY_ON_HAND""],""partitionsAssigned"":279,""partitionsTotal"":279,""bytesAssigned"":3658746880,""parentOperators"":[11]}]]}",01b2e7fc-0002-2d15-0051-ba8700019702,"explain using json select /* { ""query"":""query22"",""streamId"":0,""querySequence"":55 } */  i_product_name
             ,i_brand
             ,i_class
             ,i_category
             ,avg(inv_quantity_on_hand) qoh
       from inventory
           ,date_dim
           ,item
       where inv_date_sk=d_date_sk
              and inv_item_sk=i_item_sk
              and d_month_seq between 1176 and 1176 + 11
       group by rollup(i_product_name
                       ,i_brand
                       ,i_class
                       ,i_category)
order by qoh, i_product_name, i_brand, i_class, i_category
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:06.756-07:00,2024-03-10T18:32:06.95-07:00,194,0,0,193,1,0,0,0,0,,,0,,,0,0.000029000,0,8.9.2,0,0,0,0,0,FALSE,f673d885cd8ec02a62dc06de18dfad96,2,f673d885cd8ec02a62dc06de18dfad96,1
"{""GlobalStats"":{""partitionsTotal"":72721,""partitionsAssigned"":72721,""bytesAssigned"":1251950041088},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""DT.D_YEAR"",""ITEM.I_BRAND_ID"",""ITEM.I_BRAND"",""SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [DT.D_YEAR ASC NULLS LAST, SUM(STORE_SALES.SS_EXT_SALES_PRICE) DESC NULLS FIRST, ITEM.I_BRAND_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))]"",""groupKeys: [DT.D_YEAR, ITEM.I_BRAND, ITEM.I_BRAND_ID]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))]"",""groupKeys: [DT.D_YEAR, ITEM.I_BRAND, ITEM.I_BRAND_ID]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""ITEM.I_MANAGER_ID = 1""],""parentOperators"":[4]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_BRAND"",""I_MANAGER_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE)]"",""groupKeys: [DT.D_YEAR, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[4]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DT.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""Filter"",""expressions"":[""(DT.D_YEAR = 2002) AND (DT.D_MOY = 12)""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""alias"":""DT"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[8]},{""id"":12,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[12]}]]}",01b2e7fc-0002-2e22-0051-ba870002d042,"explain using json select /* { ""query"":""query52"",""streamId"":0,""querySequence"":59 } */  dt.d_year
 	,item.i_brand_id brand_id
 	,item.i_brand brand
 	,sum(ss_ext_sales_price) ext_price
 from date_dim dt
     ,store_sales
     ,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
    and store_sales.ss_item_sk = item.i_item_sk
    and item.i_manager_id = 1
    and dt.d_moy=12
    and dt.d_year=2002
 group by dt.d_year
 	,item.i_brand
 	,item.i_brand_id
 order by dt.d_year
 	,ext_price desc
 	,brand_id
limit 100 ;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:09.826-07:00,2024-03-10T18:32:10.146-07:00,320,0,0,319,1,0,0,0,0,,,0,,,0,0.000049000,0,8.9.2,0,0,0,0,0,FALSE,974a5599032c8277962198790311326b,2,433b566299e52802998f2140da16e801,1
"{""GlobalStats"":{""partitionsTotal"":156005,""partitionsAssigned"":156005,""bytesAssigned"":2643575084032},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""COUNT(*)""]},{""id"":1,""operation"":""Limit"",""expressions"":[""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[3]},{""id"":5,""operation"":""SemiJoin"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[5]},{""id"":7,""operation"":""SemiJoin"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[6]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[9]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME]""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[11]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK, DATE_DIM.D_DATE]""],""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1182) AND (DATE_DIM.D_MONTH_SEQ <= 1193)""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[17]},{""id"":19,""operation"":""Aggregate"",""expressions"":[""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[15]},{""id"":20,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[19]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[21]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[7]},{""id"":24,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[23]},{""id"":25,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[24]},{""id"":26,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[25]},{""id"":27,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME]""],""parentOperators"":[26]},{""id"":28,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[27]},{""id"":29,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[28]},{""id"":30,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE, CATALOG_SALES.CS_BILL_CUSTOMER_SK]""],""parentOperators"":[26]},{""id"":31,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[30]},{""id"":32,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK, DATE_DIM.D_DATE]""],""parentOperators"":[31]},{""id"":33,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1182) AND (DATE_DIM.D_MONTH_SEQ <= 1193)""],""parentOperators"":[32]},{""id"":34,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[33]},{""id"":35,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[34]},{""id"":36,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_BILL_CUSTOMER_SK, CATALOG_SALES.CS_SOLD_DATE_SK]""],""parentOperators"":[31]},{""id"":37,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[36]},{""id"":38,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[37]},{""id"":39,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[38]},{""id"":40,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[5]},{""id"":41,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME, DATE_DIM.D_DATE]""],""parentOperators"":[40]},{""id"":42,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[41]},{""id"":43,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[42]},{""id"":44,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME]""],""parentOperators"":[43]},{""id"":45,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[44]},{""id"":46,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[45]},{""id"":47,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE, WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[43]},{""id"":48,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[47]},{""id"":49,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK, DATE_DIM.D_DATE]""],""parentOperators"":[48]},{""id"":50,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1182) AND (DATE_DIM.D_MONTH_SEQ <= 1193)""],""parentOperators"":[49]},{""id"":51,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_FIRST_NAME = CUSTOMER.C_FIRST_NAME) AND (CUSTOMER.C_LAST_NAME = CUSTOMER.C_LAST_NAME) AND (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[50]},{""id"":52,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[51]},{""id"":53,""operation"":""Aggregate"",""expressions"":[""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK, WEB_SALES.WS_SOLD_DATE_SK]""],""parentOperators"":[48]},{""id"":54,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[53]},{""id"":55,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[54]},{""id"":56,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_BILL_CUSTOMER_SK""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[55]}]]}",01b2e7fc-0002-2d83-0051-ba87000251b6,"explain using json select /* { ""query"":""query38"",""streamId"":0,""querySequence"":54 } */  count(*) from (
    select distinct c_last_name, c_first_name, d_date
    from store_sales, date_dim, customer
          where store_sales.ss_sold_date_sk = date_dim.d_date_sk
      and store_sales.ss_customer_sk = customer.c_customer_sk
      and d_month_seq between 1182 and 1182 + 11
  intersect
    select distinct c_last_name, c_first_name, d_date
    from catalog_sales, date_dim, customer
          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk
      and d_month_seq between 1182 and 1182 + 11
  intersect
    select distinct c_last_name, c_first_name, d_date
    from web_sales, date_dim, customer
          where web_sales.ws_sold_date_sk = date_dim.d_date_sk
      and web_sales.ws_bill_customer_sk = customer.c_customer_sk
      and d_month_seq between 1182 and 1182 + 11
) hot_cust
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:05.709-07:00,2024-03-10T18:32:06.391-07:00,682,0,0,681,1,0,0,0,0,,,0,,,0,0.000104000,0,8.9.2,0,0,0,0,0,FALSE,351a656b1f69308713fb56eb437ccee6,2,351a656b1f69308713fb56eb437ccee6,1
"{""GlobalStats"":{""partitionsTotal"":100299,""partitionsAssigned"":100299,""bytesAssigned"":1712969853952},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""IFF(SYS_VW.ITEM_SK_2 IS NOT NULL, SYS_VW.ITEM_SK_2, SYS_VW.ITEM_SK_2)"",""IFF(SYS_VW.D_DATE_1 IS NOT NULL, SYS_VW.D_DATE_1, SYS_VW.D_DATE_1)"",""SYS_VW.CUME_SALES_0"",""SYS_VW.CUME_SALES_0"",""MAX(SYS_VW.CUME_SALES_0) OVER (PARTITION BY IFF(SYS_VW.ITEM_SK_2 IS NOT NULL, SYS_VW.ITEM_SK_2, SYS_VW.ITEM_SK_2) ORDER BY IFF(SYS_VW.D_DATE_1 IS NOT NULL, SYS_VW.D_DATE_1, SYS_VW.D_DATE_1) ASC NULLS LAST)"",""MAX(SYS_VW.CUME_SALES_0) OVER (PARTITION BY IFF(SYS_VW.ITEM_SK_2 IS NOT NULL, SYS_VW.ITEM_SK_2, SYS_VW.ITEM_SK_2) ORDER BY IFF(SYS_VW.D_DATE_1 IS NOT NULL, SYS_VW.D_DATE_1, SYS_VW.D_DATE_1) ASC NULLS LAST)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [Y.ITEM_SK ASC NULLS LAST, Y.D_DATE ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""MAX(SYS_VW.CUME_SALES_0) OVER (PARTITION BY IFF(SYS_VW.ITEM_SK_2 IS NOT NULL, SYS_VW.ITEM_SK_2, SYS_VW.ITEM_SK_2) ORDER BY IFF(SYS_VW.D_DATE_1 IS NOT NULL, SYS_VW.D_DATE_1, SYS_VW.D_DATE_1) ASC NULLS LAST) > MAX(SYS_VW.CUME_SALES_0) OVER (PARTITION BY IFF(SYS_VW.ITEM_SK_2 IS NOT NULL, SYS_VW.ITEM_SK_2, SYS_VW.ITEM_SK_2) ORDER BY IFF(SYS_VW.D_DATE_1 IS NOT NULL, SYS_VW.D_DATE_1, SYS_VW.D_DATE_1) ASC NULLS LAST)""],""parentOperators"":[1]},{""id"":3,""operation"":""WindowFunction"",""expressions"":[""MAX(SYS_VW.CUME_SALES_0) OVER (PARTITION BY IFF(SYS_VW.ITEM_SK_2 IS NOT NULL, SYS_VW.ITEM_SK_2, SYS_VW.ITEM_SK_2) ORDER BY IFF(SYS_VW.D_DATE_1 IS NOT NULL, SYS_VW.D_DATE_1, SYS_VW.D_DATE_1) ASC NULLS LAST)"",""MAX(SYS_VW.CUME_SALES_0) OVER (PARTITION BY IFF(SYS_VW.ITEM_SK_2 IS NOT NULL, SYS_VW.ITEM_SK_2, SYS_VW.ITEM_SK_2) ORDER BY IFF(SYS_VW.D_DATE_1 IS NOT NULL, SYS_VW.D_DATE_1, SYS_VW.D_DATE_1) ASC NULLS LAST)""],""parentOperators"":[2]},{""id"":4,""operation"":""FullOuterJoin"",""expressions"":[""joinKey: (SYS_VW.D_DATE_1 = SYS_VW.D_DATE_1) AND (SYS_VW.ITEM_SK_2 = SYS_VW.ITEM_SK_2)""],""parentOperators"":[3]},{""id"":5,""operation"":""WindowFunction"",""expressions"":[""SUM(SUM(WEB_SALES.WS_SALES_PRICE)) OVER (PARTITION BY WEB_SALES.WS_ITEM_SK ORDER BY DATE_DIM.D_DATE ASC NULLS LAST)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_SALES_PRICE)]"",""groupKeys: [WEB_SALES.WS_ITEM_SK, DATE_DIM.D_DATE]""],""parentOperators"":[5]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1191) AND (DATE_DIM.D_MONTH_SEQ <= 1202)""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[7]},{""id"":11,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_SALES_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[11]},{""id"":13,""operation"":""WindowFunction"",""expressions"":[""SUM(SUM(STORE_SALES.SS_SALES_PRICE)) OVER (PARTITION BY STORE_SALES.SS_ITEM_SK ORDER BY DATE_DIM.D_DATE ASC NULLS LAST)""],""parentOperators"":[4]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_SALES_PRICE)]"",""groupKeys: [STORE_SALES.SS_ITEM_SK, DATE_DIM.D_DATE]""],""parentOperators"":[13]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1191) AND (DATE_DIM.D_MONTH_SEQ <= 1202)""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[15]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[19]}]]}",01b2e7fb-0002-2f99-0051-ba8700028186,"explain using json WITH /* { ""query"":""query51"",""streamId"":0,""querySequence"":46 } */ web_v1 as (
select
  ws_item_sk item_sk, d_date,
  sum(sum(ws_sales_price))
      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales
from web_sales
    ,date_dim
where ws_sold_date_sk=d_date_sk
  and d_month_seq between 1191 and 1191+11
  and ws_item_sk is not NULL
group by ws_item_sk, d_date),
store_v1 as (
select
  ss_item_sk item_sk, d_date,
  sum(sum(ss_sales_price))
      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales
from store_sales
    ,date_dim
where ss_sold_date_sk=d_date_sk
  and d_month_seq between 1191 and 1191+11
  and ss_item_sk is not NULL
group by ss_item_sk, d_date)
 select  *
from (select item_sk
     ,d_date
     ,web_sales
     ,store_sales
     ,max(web_sales)
         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative
     ,max(store_sales)
         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative
     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk
                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date
                 ,web.cume_sales web_sales
                 ,store.cume_sales store_sales
           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk
                                                          and web.d_date = store.d_date)
          )x )y
where web_cumulative > store_cumulative
order by item_sk
        ,d_date
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:55.096-07:00,2024-03-10T18:31:55.493-07:00,397,0,0,396,1,0,0,0,0,,,0,,,0,0.000061000,0,8.9.2,0,0,0,0,0,FALSE,0ab922928cecaaccae4773824509dc79,2,0ab922928cecaaccae4773824509dc79,1
"{""GlobalStats"":{""partitionsTotal"":72721,""partitionsAssigned"":70415,""bytesAssigned"":1212654208512},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""DT.D_YEAR"",""ITEM.I_BRAND_ID"",""ITEM.I_BRAND"",""SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_EXT_DISCOUNT_AMT, COUNT(*))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [DT.D_YEAR ASC NULLS LAST, SUM(STORE_SALES.SS_EXT_DISCOUNT_AMT) DESC NULLS FIRST, ITEM.I_BRAND_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_EXT_DISCOUNT_AMT, COUNT(*))))]"",""groupKeys: [DT.D_YEAR, ITEM.I_BRAND, ITEM.I_BRAND_ID]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(STORE_SALES.SS_EXT_DISCOUNT_AMT, COUNT(*)))]"",""groupKeys: [DT.D_YEAR, ITEM.I_BRAND, ITEM.I_BRAND_ID]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DT.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""DT.D_MOY = 12""],""parentOperators"":[4]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""alias"":""DT"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(STORE_SALES.SS_EXT_DISCOUNT_AMT, COUNT(*))]"",""groupKeys: [ITEM.I_BRAND_ID, ITEM.I_BRAND, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[4]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_BRAND_ID, ITEM.I_BRAND]""],""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""ITEM.I_MANUFACT_ID = 950""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_BRAND"",""I_MANUFACT_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[8]},{""id"":13,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DT.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_EXT_DISCOUNT_AMT""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[13]}]]}",01b2e7fb-0002-2fe3-0051-ba870002e04e,"explain using json select /* { ""query"":""query03"",""streamId"":0,""querySequence"":45 } */  dt.d_year
       ,item.i_brand_id brand_id
       ,item.i_brand brand
       ,sum(ss_ext_discount_amt) sum_agg
 from  date_dim dt
      ,store_sales
      ,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
   and store_sales.ss_item_sk = item.i_item_sk
   and item.i_manufact_id = 950
   and dt.d_moy=12
 group by dt.d_year
      ,item.i_brand
      ,item.i_brand_id
 order by dt.d_year
         ,sum_agg desc
         ,brand_id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:54.715-07:00,2024-03-10T18:31:54.879-07:00,164,0,0,162,2,0,0,0,0,,,0,,,0,0.000025000,0,8.9.2,0,0,0,0,0,FALSE,489476e20ce719845e0dee8fe617e13b,2,703160d91c6ea9cb406d323162144229,1
"{""GlobalStats"":{""partitionsTotal"":85284,""partitionsAssigned"":85284,""bytesAssigned"":1423052290048},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""COUNT(DISTINCT WS1.WS_ORDER_NUMBER)"",""SUM(WS1.WS_EXT_SHIP_COST)"",""SUM(WS1.WS_NET_PROFIT)""]},{""id"":1,""operation"":""Limit"",""expressions"":[""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(DISTINCT WS1.WS_ORDER_NUMBER), SUM(WS1.WS_EXT_SHIP_COST), SUM(WS1.WS_NET_PROFIT)]""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WEB_SITE.WEB_SITE_SK = WS1.WS_WEB_SITE_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""WEB_SITE.WEB_COMPANY_NAME = 'pri'""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SITE""],""expressions"":[""WEB_SITE_SK"",""WEB_COMPANY_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":20992,""parentOperators"":[4]},{""id"":6,""operation"":""SemiJoin"",""expressions"":[""joinKey: (WS1.WS_ORDER_NUMBER = WEB_RETURNS.WR_ORDER_NUMBER)""],""parentOperators"":[3]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WS1.WS_SHIP_DATE_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2002-03-01') AND (DATE_DIM.D_DATE <= '2002-04-30')""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = WS1.WS_SHIP_ADDR_SK)""],""parentOperators"":[7]},{""id"":11,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_STATE = 'MO'""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""(WS1.WS_SHIP_ADDR_SK IS NOT NULL) AND (WS1.WS_SHIP_DATE_SK IS NOT NULL) AND (WS1.WS_WEB_SITE_SK IS NOT NULL)""],""parentOperators"":[10]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WEB_SITE.WEB_SITE_SK = WS1.WS_WEB_SITE_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SHIP_DATE_SK"",""WS_SHIP_ADDR_SK"",""WS_WEB_SITE_SK"",""WS_ORDER_NUMBER"",""WS_EXT_SHIP_COST"",""WS_NET_PROFIT""],""alias"":""WS1"",""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[14]},{""id"":17,""operation"":""SemiJoin"",""expressions"":[""joinKey: (WEB_RETURNS.WR_ORDER_NUMBER = WS_WH.WS_ORDER_NUMBER)""],""parentOperators"":[16]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WS1.WS_ORDER_NUMBER = WEB_RETURNS.WR_ORDER_NUMBER)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_RETURNS""],""expressions"":[""WR_ORDER_NUMBER""],""partitionsAssigned"":2289,""partitionsTotal"":2289,""bytesAssigned"":39149218304,""parentOperators"":[19]},{""id"":22,""operation"":""SemiJoin"",""expressions"":[""joinKey: (WS2.WS_ORDER_NUMBER = WS1.WS_ORDER_NUMBER)"",""joinFilter: WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK""],""parentOperators"":[21]},{""id"":23,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WS1.WS_ORDER_NUMBER = WEB_RETURNS.WR_ORDER_NUMBER)""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_WAREHOUSE_SK"",""WS_ORDER_NUMBER""],""alias"":""WS2"",""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[23]},{""id"":25,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WS1.WS_ORDER_NUMBER = WEB_RETURNS.WR_ORDER_NUMBER)""],""parentOperators"":[22]},{""id"":26,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_WAREHOUSE_SK"",""WS_ORDER_NUMBER""],""alias"":""WS1"",""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[25]}]]}",01b2e7fb-0002-2d83-0051-ba87000251ae,"explain using json with /* { ""query"":""query95"",""streamId"":0,""querySequence"":43 } */ ws_wh as
(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2
 from web_sales ws1,web_sales ws2
 where ws1.ws_order_number = ws2.ws_order_number
   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)
 select
   count(distinct ws_order_number) as ""order count""
  ,sum(ws_ext_ship_cost) as ""total shipping cost""
  ,sum(ws_net_profit) as ""total net profit""
from
   web_sales ws1
  ,date_dim
  ,customer_address
  ,web_site
where
    d_date between '2002-3-01' and
           (cast('2002-3-01' as date) + interval '60 days')
and ws1.ws_ship_date_sk = d_date_sk
and ws1.ws_ship_addr_sk = ca_address_sk
and ca_state = 'MO'
and ws1.ws_web_site_sk = web_site_sk
and web_company_name = 'pri'
and ws1.ws_order_number in (select ws_order_number
                            from ws_wh)
and ws1.ws_order_number in (select wr_order_number
                            from web_returns,ws_wh
                            where wr_order_number = ws_wh.ws_order_number)
order by count(distinct ws_order_number)
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:52.669-07:00,2024-03-10T18:31:53.403-07:00,734,0,0,733,1,0,0,0,0,,,0,,,0,0.000112000,0,8.9.2,0,0,0,0,0,FALSE,f361426b952046af514725bbd6224bc6,2,32482648aad20f8874526a7877cf2d08,1
"{""GlobalStats"":{""partitionsTotal"":156002,""partitionsAssigned"":156002,""bytesAssigned"":2639061701632},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""UNION_ALL(ITEM.I_ITEM_ID, ITEM.I_ITEM_ID, ITEM.I_ITEM_ID)"",""SUM(UNION_ALL(SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))))), SUM(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE))))), SUM(SUM(SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE)))))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [TMP1.I_ITEM_ID ASC NULLS LAST, SUM(TMP1.TOTAL_SALES) ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(UNION_ALL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(WEB_SALES.WS_EXT_SALES_PRICE)))]"",""groupKeys: [UNION_ALL(ITEM.I_ITEM_ID, ITEM.I_ITEM_ID, ITEM.I_ITEM_ID)]""],""parentOperators"":[1]},{""id"":3,""operation"":""UnionAll"",""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[4]},{""id"":6,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""ITEM.I_CATEGORY = 'Jewelry'""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_ID"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[6]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))]"",""groupKeys: [STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[11]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = STORE_SALES.SS_ADDR_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_GMT_OFFSET = -9""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_GMT_OFFSET""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[16]},{""id"":18,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE)]"",""groupKeys: [STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_ADDR_SK]""],""parentOperators"":[15]},{""id"":19,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_MOY = 10)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[20]},{""id"":22,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_ADDR_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[19]},{""id"":23,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_ADDR_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[23]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE)))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[3]},{""id"":26,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[25]},{""id"":27,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[26]},{""id"":28,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""ITEM.I_CATEGORY = 'Jewelry'""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_ID"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[29]},{""id"":31,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[27]},{""id"":32,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[31]},{""id"":33,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[32]},{""id"":34,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[33]},{""id"":35,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE))]"",""groupKeys: [CATALOG_SALES.CS_ITEM_SK]""],""parentOperators"":[32]},{""id"":36,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CATALOG_SALES.CS_BILL_ADDR_SK)""],""parentOperators"":[35]},{""id"":37,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_GMT_OFFSET = -9""],""parentOperators"":[36]},{""id"":38,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_GMT_OFFSET""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[37]},{""id"":39,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CATALOG_SALES.CS_EXT_SALES_PRICE)]"",""groupKeys: [CATALOG_SALES.CS_ITEM_SK, CATALOG_SALES.CS_BILL_ADDR_SK]""],""parentOperators"":[36]},{""id"":40,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[39]},{""id"":41,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_MOY = 10)""],""parentOperators"":[40]},{""id"":42,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[41]},{""id"":43,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_ADDR_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[40]},{""id"":44,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[43]},{""id"":45,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_ADDR_SK"",""CS_ITEM_SK"",""CS_EXT_SALES_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[44]},{""id"":46,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE)))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[3]},{""id"":47,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[46]},{""id"":48,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[47]},{""id"":49,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[48]},{""id"":50,""operation"":""Filter"",""expressions"":[""ITEM.I_CATEGORY = 'Jewelry'""],""parentOperators"":[49]},{""id"":51,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_ID"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[50]},{""id"":52,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[48]},{""id"":53,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[52]},{""id"":54,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[53]},{""id"":55,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[54]},{""id"":56,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE))]"",""groupKeys: [WEB_SALES.WS_ITEM_SK]""],""parentOperators"":[53]},{""id"":57,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = WEB_SALES.WS_BILL_ADDR_SK)""],""parentOperators"":[56]},{""id"":58,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_GMT_OFFSET = -9""],""parentOperators"":[57]},{""id"":59,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_GMT_OFFSET""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[58]},{""id"":60,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_EXT_SALES_PRICE)]"",""groupKeys: [WEB_SALES.WS_ITEM_SK, WEB_SALES.WS_BILL_ADDR_SK]""],""parentOperators"":[57]},{""id"":61,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[60]},{""id"":62,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_MOY = 10)""],""parentOperators"":[61]},{""id"":63,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[62]},{""id"":64,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_ADDR_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[61]},{""id"":65,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[64]},{""id"":66,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_BILL_ADDR_SK"",""WS_EXT_SALES_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[65]}]]}",01b2e7fb-0002-2ff0-0051-ba8700030032,"explain using json with /* { ""query"":""query60"",""streamId"":0,""querySequence"":29 } */ ss as (
 select
          i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id in (select
  i_item_id
from
 item
where i_category in ('Jewelry'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2000
 and     d_moy                   = 10
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -9
 group by i_item_id),
 cs as (
 select
          i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from
 item
where i_category in ('Jewelry'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 2000
 and     d_moy                   = 10
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -9
 group by i_item_id),
 ws as (
 select
          i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from
 item
where i_category in ('Jewelry'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 2000
 and     d_moy                   = 10
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -9
 group by i_item_id)
  select
  i_item_id
,sum(total_sales) total_sales
 from  (select * from ss
        union all
        select * from cs
        union all
        select * from ws) tmp1
 group by i_item_id
 order by i_item_id
      ,total_sales
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:37.808-07:00,2024-03-10T18:31:38.821-07:00,1013,0,0,1010,3,0,0,0,0,,,0,,,0,0.000155000,0,8.9.2,0,0,0,0,0,FALSE,97270a1153351eb49364cc00c1f04bb8,2,5ba4f617a236b6e4db44083228d4cf21,1
"{""GlobalStats"":{""partitionsTotal"":155228,""partitionsAssigned"":155218,""bytesAssigned"":2636655289344},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""FOO.CHANNEL"",""FOO.COL_NAME"",""UNION_ALL(DATE_DIM.D_YEAR, DATE_DIM.D_YEAR, DATE_DIM.D_YEAR)"",""UNION_ALL(DATE_DIM.D_QOY, DATE_DIM.D_QOY, DATE_DIM.D_QOY)"",""UNION_ALL(ITEM.I_CATEGORY, ITEM.I_CATEGORY, ITEM.I_CATEGORY)"",""COUNT(*)"",""SUM(UNION_ALL(STORE_SALES.SS_EXT_SALES_PRICE, WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [FOO.CHANNEL ASC NULLS LAST, FOO.COL_NAME ASC NULLS LAST, FOO.D_YEAR ASC NULLS LAST, FOO.D_QOY ASC NULLS LAST, FOO.I_CATEGORY ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*), SUM(UNION_ALL(STORE_SALES.SS_EXT_SALES_PRICE, WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE))]"",""groupKeys: [UNION_ALL('store', 'web', 'catalog'), UNION_ALL('ss_addr_sk', 'ws_promo_sk', 'cs_bill_customer_sk'), UNION_ALL(DATE_DIM.D_YEAR, DATE_DIM.D_YEAR, DATE_DIM.D_YEAR), UNION_ALL(DATE_DIM.D_QOY, DATE_DIM.D_QOY, DATE_DIM.D_QOY), UNION_ALL(ITEM.I_CATEGORY, ITEM.I_CATEGORY, ITEM.I_CATEGORY)]""],""parentOperators"":[2]},{""id"":4,""operation"":""UnionAll"",""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[5]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[5]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[7]},{""id"":9,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_ADDR_SK IS NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[7]},{""id"":10,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_ADDR_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[10]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[4]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[12]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[12]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_PROMO_SK IS NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[14]},{""id"":17,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_PROMO_SK"",""WS_EXT_SALES_PRICE""],""partitionsAssigned"":27570,""partitionsTotal"":27579,""bytesAssigned"":461035915776,""parentOperators"":[17]},{""id"":19,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[4]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[19]},{""id"":21,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[19]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[21]},{""id"":23,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[21]},{""id"":24,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[23]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_ITEM_SK"",""CS_EXT_SALES_PRICE""],""partitionsAssigned"":54921,""partitionsTotal"":54922,""bytesAssigned"":923617432064,""parentOperators"":[24]}]]}",01b2e7fe-0002-2e24-0051-ba870001d222,"explain using json select /* { ""query"":""query76"",""streamId"":0,""querySequence"":99 } */  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (
        SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price
         FROM store_sales, item, date_dim
         WHERE ss_addr_sk IS NULL
           AND ss_sold_date_sk=d_date_sk
           AND ss_item_sk=i_item_sk
        UNION ALL
        SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price
         FROM web_sales, item, date_dim
         WHERE ws_promo_sk IS NULL
           AND ws_sold_date_sk=d_date_sk
           AND ws_item_sk=i_item_sk
        UNION ALL
        SELECT 'catalog' as channel, 'cs_bill_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price
         FROM catalog_sales, item, date_dim
         WHERE cs_bill_customer_sk IS NULL
           AND cs_sold_date_sk=d_date_sk
           AND cs_item_sk=i_item_sk) foo
GROUP BY channel, col_name, d_year, d_qoy, i_category
ORDER BY channel, col_name, d_year, d_qoy, i_category
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:34:41.688-07:00,2024-03-10T18:34:42.044-07:00,356,0,0,354,2,0,0,0,0,,,0,,,0,0.000054000,0,8.9.2,0,0,0,0,0,FALSE,3fcacc38ba1cd39caa7e76c24ecf104e,2,3fcacc38ba1cd39caa7e76c24ecf104e,1
"{""GlobalStats"":{""partitionsTotal"":82504,""partitionsAssigned"":82298,""bytesAssigned"":1381147276288},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""WSWSCS.D_WEEK_SEQ"",""ROUND((WSWSCS.SUN_SALES) / (WSWSCS_0.SUN_SALES), 2)"",""ROUND((WSWSCS.MON_SALES) / (WSWSCS_0.MON_SALES), 2)"",""ROUND((WSWSCS.TUE_SALES) / (WSWSCS_0.TUE_SALES), 2)"",""ROUND((WSWSCS.WED_SALES) / (WSWSCS_0.WED_SALES), 2)"",""ROUND((WSWSCS.THU_SALES) / (WSWSCS_0.THU_SALES), 2)"",""ROUND((WSWSCS.FRI_SALES) / (WSWSCS_0.FRI_SALES), 2)"",""ROUND((WSWSCS.SAT_SALES) / (WSWSCS_0.SAT_SALES), 2)""]},{""id"":1,""operation"":""Sort"",""expressions"":[""WSWSCS.D_WEEK_SEQ ASC NULLS LAST""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM_0.D_WEEK_SEQ = WSWSCS_0.D_WEEK_SEQ)""],""parentOperators"":[1]},{""id"":3,""operation"":""Filter"",""expressions"":[""DATE_DIM_0.D_YEAR = 2000""],""parentOperators"":[2]},{""id"":4,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_WEEK_SEQ"",""D_YEAR""],""alias"":""DATE_DIM_0"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WSWSCS.D_WEEK_SEQ = WSWSCS_0.D_WEEK_SEQ - 53)""],""parentOperators"":[2]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_WEEK_SEQ = WSWSCS.D_WEEK_SEQ)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 1999""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_WEEK_SEQ"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[7]},{""id"":9,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_WEEK_SEQ = WSWSCS.D_WEEK_SEQ)""],""parentOperators"":[6]},{""id"":10,""operation"":""WithReference"",""parentOperators"":[9]},{""id"":11,""operation"":""WithClause"",""expressions"":[""WSWSCS""],""parentOperators"":[10,23]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFF(DATE_DIM.D_DAY_NAME = 'Sunday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Monday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Tuesday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Wednesday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Thursday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Friday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Saturday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null))]"",""groupKeys: [DATE_DIM.D_WEEK_SEQ]""],""parentOperators"":[11]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(WEB_SALES.WS_SOLD_DATE_SK, CATALOG_SALES.CS_SOLD_DATE_SK))""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_WEEK_SEQ"",""D_DAY_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[13]},{""id"":15,""operation"":""UnionAll"",""parentOperators"":[13]},{""id"":16,""operation"":""Filter"",""expressions"":[""WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[15]},{""id"":17,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(WEB_SALES.WS_SOLD_DATE_SK, CATALOG_SALES.CS_SOLD_DATE_SK))""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_EXT_SALES_PRICE""],""partitionsAssigned"":27574,""partitionsTotal"":27579,""bytesAssigned"":460956759040,""parentOperators"":[17]},{""id"":19,""operation"":""Filter"",""expressions"":[""CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[15]},{""id"":20,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(WEB_SALES.WS_SOLD_DATE_SK, CATALOG_SALES.CS_SOLD_DATE_SK))""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_EXT_SALES_PRICE""],""partitionsAssigned"":54721,""partitionsTotal"":54922,""bytesAssigned"":920184101376,""parentOperators"":[20]},{""id"":22,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM_0.D_WEEK_SEQ = WSWSCS_0.D_WEEK_SEQ)""],""parentOperators"":[5]},{""id"":23,""operation"":""WithReference"",""expressions"":[""WSWSCS_0""],""parentOperators"":[22]}]]}",01b2e7fd-0002-2d15-0051-ba870001971e,"explain using json with /* { ""query"":""query02"",""streamId"":0,""querySequence"":84 } */ wscs as
 (select sold_date_sk
        ,sales_price
  from (select ws_sold_date_sk sold_date_sk
              ,ws_ext_sales_price sales_price
        from web_sales
        union all
        select cs_sold_date_sk sold_date_sk
              ,cs_ext_sales_price sales_price
        from catalog_sales)),
 wswscs as
 (select d_week_seq,
        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales
 from wscs
     ,date_dim
 where d_date_sk = sold_date_sk
 group by d_week_seq)
 select d_week_seq1
       ,round(sun_sales1/sun_sales2,2)
       ,round(mon_sales1/mon_sales2,2)
       ,round(tue_sales1/tue_sales2,2)
       ,round(wed_sales1/wed_sales2,2)
       ,round(thu_sales1/thu_sales2,2)
       ,round(fri_sales1/fri_sales2,2)
       ,round(sat_sales1/sat_sales2,2)
 from
 (select wswscs.d_week_seq d_week_seq1
        ,sun_sales sun_sales1
        ,mon_sales mon_sales1
        ,tue_sales tue_sales1
        ,wed_sales wed_sales1
        ,thu_sales thu_sales1
        ,fri_sales fri_sales1
        ,sat_sales sat_sales1
  from wswscs,date_dim
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 1999) y,
 (select wswscs.d_week_seq d_week_seq2
        ,sun_sales sun_sales2
        ,mon_sales mon_sales2
        ,tue_sales tue_sales2
        ,wed_sales wed_sales2
        ,thu_sales thu_sales2
        ,fri_sales fri_sales2
        ,sat_sales sat_sales2
  from wswscs
      ,date_dim
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 1999+1) z
 where d_week_seq1=d_week_seq2-53
 order by d_week_seq1;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:29.978-07:00,2024-03-10T18:33:30.361-07:00,383,0,0,382,1,0,0,0,0,,,0,,,0,0.000058000,0,8.9.2,0,0,0,0,0,FALSE,bc25f7338523f20d61120ca66c43fe0c,2,79af30faa0966a2debc90c426a82e41a,1
"{""GlobalStats"":{""partitionsTotal"":72721,""partitionsAssigned"":72721,""bytesAssigned"":1251950041088},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_BRAND_ID"",""ITEM.I_BRAND"",""SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [SUM(STORE_SALES.SS_EXT_SALES_PRICE) DESC NULLS FIRST, ITEM.I_BRAND_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))]"",""groupKeys: [ITEM.I_BRAND, ITEM.I_BRAND_ID]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))]"",""groupKeys: [ITEM.I_BRAND, ITEM.I_BRAND_ID]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""ITEM.I_MANAGER_ID = 69""],""parentOperators"":[4]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_BRAND"",""I_MANAGER_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE)]"",""groupKeys: [STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[4]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MOY = 12) AND (DATE_DIM.D_YEAR = 2002)""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[8]},{""id"":12,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[12]}]]}",01b2e7fd-0002-2f99-0051-ba87000281be,"explain using json select /* { ""query"":""query55"",""streamId"":0,""querySequence"":82 } */  i_brand_id brand_id, i_brand brand,
 	sum(ss_ext_sales_price) ext_price
 from date_dim, store_sales, item
 where d_date_sk = ss_sold_date_sk
 	and ss_item_sk = i_item_sk
 	and i_manager_id=69
 	and d_moy=12
 	and d_year=2002
 group by i_brand, i_brand_id
 order by ext_price desc, i_brand_id
limit 100 ;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:27.234-07:00,2024-03-10T18:33:27.457-07:00,223,0,0,222,1,0,0,0,0,,,0,,,0,0.000034000,0,8.9.2,0,0,0,0,0,FALSE,46ecad4d88381f5bd8741dd024fed165,2,f5886163cc2ec4c41d9bff36a7ac4213,1
"{""GlobalStats"":{""partitionsTotal"":155743,""partitionsAssigned"":153231,""bytesAssigned"":2596906613760},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""DATE_DIM.D_MONTH_SEQ + 1""]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_MONTH_SEQ + 1]""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 2)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_MONTH_SEQ"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[4]}],[{""id"":0,""operation"":""Result"",""expressions"":[""DATE_DIM.D_MONTH_SEQ + 3""]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_MONTH_SEQ + 3]""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 2)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_MONTH_SEQ"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[4]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_EXT_SALES_PRICE, COUNT(*))))) / 50"",""COUNT(*)"",""((SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_EXT_SALES_PRICE, COUNT(*))))) / 50) * 50""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [(MY_REVENUE.REVENUE) / 50 ASC NULLS LAST, COUNT(*) ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [(SUM(STORE_SALES.SS_EXT_SALES_PRICE)) / 50]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_EXT_SALES_PRICE, COUNT(*))))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(STORE_SALES.SS_EXT_SALES_PRICE, COUNT(*)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= Subquery(Step1)) AND (DATE_DIM.D_MONTH_SEQ <= Subquery(Step2))""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(STORE_SALES.SS_EXT_SALES_PRICE, COUNT(*))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[5]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[9]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_COUNTY = CUSTOMER_ADDRESS.CA_COUNTY) AND (STORE.S_STATE = CUSTOMER_ADDRESS.CA_STATE)""],""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""(STORE.S_COUNTY IS NOT NULL) AND (STORE.S_STATE IS NOT NULL)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_COUNTY"",""S_STATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""(CUSTOMER_ADDRESS.CA_COUNTY IS NOT NULL) AND (CUSTOMER_ADDRESS.CA_STATE IS NOT NULL)""],""parentOperators"":[12]},{""id"":16,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_COUNTY = CUSTOMER_ADDRESS.CA_COUNTY) AND (STORE.S_STATE = CUSTOMER_ADDRESS.CA_STATE)""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_COUNTY"",""CA_STATE""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[16]},{""id"":18,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CURRENT_ADDR_SK]""],""parentOperators"":[11]},{""id"":19,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CURRENT_ADDR_SK]""],""parentOperators"":[18]},{""id"":20,""operation"":""SemiJoin"",""expressions"":[""joinKey: (UNION_ALL(CATALOG_SALES.CS_BILL_CUSTOMER_SK, WEB_SALES.WS_BILL_CUSTOMER_SK) = CUSTOMER.C_CUSTOMER_SK)""],""parentOperators"":[19]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""groupKeys: [UNION_ALL(CATALOG_SALES.CS_BILL_CUSTOMER_SK, WEB_SALES.WS_BILL_CUSTOMER_SK)]""],""parentOperators"":[20]},{""id"":22,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(CATALOG_SALES.CS_SOLD_DATE_SK, WEB_SALES.WS_SOLD_DATE_SK))""],""parentOperators"":[21]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[22]},{""id"":24,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MOY = 2) AND (DATE_DIM.D_YEAR = 1999)""],""parentOperators"":[23]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[24]},{""id"":27,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = UNION_ALL(CATALOG_SALES.CS_ITEM_SK, WEB_SALES.WS_ITEM_SK))""],""parentOperators"":[26]},{""id"":28,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_SK]""],""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""(ITEM.I_CATEGORY = 'Children') AND (ITEM.I_CLASS = 'infants')""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_CLASS"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[29]},{""id"":32,""operation"":""UnionAll"",""parentOperators"":[31]},{""id"":33,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[32]},{""id"":34,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(CATALOG_SALES.CS_SOLD_DATE_SK, WEB_SALES.WS_SOLD_DATE_SK))""],""parentOperators"":[33]},{""id"":35,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_ITEM_SK""],""partitionsAssigned"":54721,""partitionsTotal"":54922,""bytesAssigned"":920184101376,""parentOperators"":[34]},{""id"":36,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[32]},{""id"":37,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(CATALOG_SALES.CS_SOLD_DATE_SK, WEB_SALES.WS_SOLD_DATE_SK))""],""parentOperators"":[36]},{""id"":38,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_BILL_CUSTOMER_SK""],""partitionsAssigned"":27574,""partitionsTotal"":27579,""bytesAssigned"":460956759040,""parentOperators"":[37]},{""id"":39,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CURRENT_ADDR_SK]""],""parentOperators"":[20]},{""id"":40,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[39]},{""id"":41,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_ADDR_SK""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[40]},{""id"":42,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL) AND (STORE_SALES.SS_CUSTOMER_SK IS NOT NULL)""],""parentOperators"":[9]},{""id"":43,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[42]},{""id"":44,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[43]}]]}",01b2e7fd-0002-300b-0051-ba870002c0d2,"explain using json with /* { ""query"":""query54"",""streamId"":0,""querySequence"":81 } */ my_customers as (
 select distinct c_customer_sk
        , c_current_addr_sk
 from
        ( select cs_sold_date_sk sold_date_sk,
                 cs_bill_customer_sk customer_sk,
                 cs_item_sk item_sk
          from   catalog_sales
          union all
          select ws_sold_date_sk sold_date_sk,
                 ws_bill_customer_sk customer_sk,
                 ws_item_sk item_sk
          from   web_sales
         ) cs_or_ws_sales,
         item,
         date_dim,
         customer
 where   sold_date_sk = d_date_sk
         and item_sk = i_item_sk
         and i_category = 'Children'
         and i_class = 'infants'
         and c_customer_sk = cs_or_ws_sales.customer_sk
         and d_moy = 2
         and d_year = 1999
 )
 , my_revenue as (
 select c_customer_sk,
        sum(ss_ext_sales_price) as revenue
 from   my_customers,
        store_sales,
        customer_address,
        store,
        date_dim
 where  c_current_addr_sk = ca_address_sk
        and ca_county = s_county
        and ca_state = s_state
        and ss_sold_date_sk = d_date_sk
        and c_customer_sk = ss_customer_sk
        and d_month_seq between (select distinct d_month_seq+1
                                 from   date_dim where d_year = 1999 and d_moy = 2)
                           and  (select distinct d_month_seq+3
                                 from   date_dim where d_year = 1999 and d_moy = 2)
 group by c_customer_sk
 )
 , segments as
 (select cast((revenue/50) as int) as segment
  from   my_revenue
 )
  select  segment, count(*) as num_customers, segment*50 as segment_base
 from segments
 group by segment
 order by segment, num_customers
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:26.356-07:00,2024-03-10T18:33:26.819-07:00,463,0,0,461,2,0,0,0,0,,,0,,,0,0.000071000,0,8.9.2,0,0,0,0,0,FALSE,7becd5d87245fe86fa7f9e400a4aa701,2,09de5694fa1a8c56e033645eb71a2f0d,1
"{""GlobalStats"":{""partitionsTotal"":3063,""partitionsAssigned"":3063,""bytesAssigned"":43032804864},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER.C_CUSTOMER_ID"",""CUSTOMER.C_SALUTATION"",""CUSTOMER.C_FIRST_NAME"",""CUSTOMER.C_LAST_NAME"",""CUSTOMER.C_PREFERRED_CUST_FLAG"",""CUSTOMER.C_BIRTH_DAY"",""CUSTOMER.C_BIRTH_MONTH"",""CUSTOMER.C_BIRTH_YEAR"",""CUSTOMER.C_BIRTH_COUNTRY"",""CUSTOMER.C_EMAIL_ADDRESS"",""CUSTOMER.C_LAST_REVIEW_DATE"",""CTR1.CTR_TOTAL_RETURN""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CUSTOMER.C_CUSTOMER_ID ASC NULLS LAST, CUSTOMER.C_SALUTATION ASC NULLS LAST, CUSTOMER.C_FIRST_NAME ASC NULLS LAST, CUSTOMER.C_LAST_NAME ASC NULLS LAST, CUSTOMER.C_PREFERRED_CUST_FLAG ASC NULLS LAST, CUSTOMER.C_BIRTH_DAY ASC NULLS LAST, CUSTOMER.C_BIRTH_MONTH ASC NULLS LAST, CUSTOMER.C_BIRTH_YEAR ASC NULLS LAST, CUSTOMER.C_BIRTH_COUNTRY ASC NULLS LAST, CUSTOMER.C_EMAIL_ADDRESS ASC NULLS LAST, CUSTOMER.C_LAST_REVIEW_DATE ASC NULLS LAST, CTR1.CTR_TOTAL_RETURN ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CURRENT_ADDR_SK = CUSTOMER_ADDRESS.CA_ADDRESS_SK)""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CTR1.CTR_CUSTOMER_SK = CUSTOMER.C_CUSTOMER_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CTR2.CTR_STATE = CTR1.CTR_STATE)"",""joinFilter: (CTR1.CTR_TOTAL_RETURN) > (((SUM(CTR2.CTR_TOTAL_RETURN)) / (NVL(COUNT(CTR2.CTR_TOTAL_RETURN), 0))) * 1.2)""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""(SUM(CTR2.CTR_TOTAL_RETURN) IS NOT NULL) AND (COUNT(CTR2.CTR_TOTAL_RETURN) IS NOT NULL)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CTR2.CTR_TOTAL_RETURN), COUNT(CTR2.CTR_TOTAL_RETURN)]"",""groupKeys: [CTR2.CTR_STATE]""],""parentOperators"":[5]},{""id"":7,""operation"":""WithReference"",""expressions"":[""CTR2""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""CTR2.CTR_STATE IS NOT NULL""],""parentOperators"":[7]},{""id"":9,""operation"":""WithClause"",""expressions"":[""CUSTOMER_TOTAL_RETURN""],""parentOperators"":[8,23]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(WEB_RETURNS.WR_RETURN_AMT)))]"",""groupKeys: [WEB_RETURNS.WR_RETURNING_CUSTOMER_SK, CUSTOMER_ADDRESS.CA_STATE]""],""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(WEB_RETURNS.WR_RETURN_AMT))]"",""groupKeys: [WEB_RETURNS.WR_RETURNING_CUSTOMER_SK, CUSTOMER_ADDRESS.CA_STATE]""],""parentOperators"":[10]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = WEB_RETURNS.WR_RETURNING_ADDR_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_RETURNS.WR_RETURN_AMT)]"",""groupKeys: [WEB_RETURNS.WR_RETURNING_CUSTOMER_SK, WEB_RETURNS.WR_RETURNING_ADDR_SK]""],""parentOperators"":[12]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_RETURNS.WR_RETURNED_DATE_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 2001""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""(WEB_RETURNS.WR_RETURNING_ADDR_SK IS NOT NULL) AND (WEB_RETURNS.WR_RETURNED_DATE_SK IS NOT NULL)""],""parentOperators"":[15]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = WEB_RETURNS.WR_RETURNING_ADDR_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_RETURNS""],""expressions"":[""WR_RETURNED_DATE_SK"",""WR_RETURNING_CUSTOMER_SK"",""WR_RETURNING_ADDR_SK"",""WR_RETURN_AMT""],""partitionsAssigned"":2289,""partitionsTotal"":2289,""bytesAssigned"":39149218304,""parentOperators"":[19]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CTR2.CTR_STATE = CTR1.CTR_STATE)"",""joinFilter: (CTR1.CTR_TOTAL_RETURN) > (((SUM(CTR2.CTR_TOTAL_RETURN)) / (NVL(COUNT(CTR2.CTR_TOTAL_RETURN), 0))) * 1.2)""],""parentOperators"":[4]},{""id"":22,""operation"":""WithReference"",""expressions"":[""CTR1""],""parentOperators"":[21]},{""id"":23,""operation"":""Filter"",""expressions"":[""(CUSTOMER_ADDRESS.CA_STATE IS NOT NULL) AND (CTR1.CTR_CUSTOMER_SK IS NOT NULL)""],""parentOperators"":[22]},{""id"":24,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CTR1.CTR_CUSTOMER_SK = CUSTOMER.C_CUSTOMER_SK)""],""parentOperators"":[3]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CUSTOMER_ID"",""C_CURRENT_ADDR_SK"",""C_SALUTATION"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_PREFERRED_CUST_FLAG"",""C_BIRTH_DAY"",""C_BIRTH_MONTH"",""C_BIRTH_YEAR"",""C_BIRTH_COUNTRY"",""C_EMAIL_ADDRESS"",""C_LAST_REVIEW_DATE""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[24]},{""id"":26,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_STATE = 'AR'""],""parentOperators"":[2]},{""id"":27,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CURRENT_ADDR_SK = CUSTOMER_ADDRESS.CA_ADDRESS_SK)""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[27]}]]}",01b2e7fd-0002-2e22-0051-ba870002d05a,"explain using json with /* { ""query"":""query30"",""streamId"":0,""querySequence"":75 } */ customer_total_return as
 (select wr_returning_customer_sk as ctr_customer_sk
        ,ca_state as ctr_state,
 	sum(wr_return_amt) as ctr_total_return
 from web_returns
     ,date_dim
     ,customer_address
 where wr_returned_date_sk = d_date_sk
   and d_year =2001
   and wr_returning_addr_sk = ca_address_sk
 group by wr_returning_customer_sk
         ,ca_state)
  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag
       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address
       ,c_last_review_date,ctr_total_return
 from customer_total_return ctr1
     ,customer_address
     ,customer
 where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2
 			  from customer_total_return ctr2
                  	  where ctr1.ctr_state = ctr2.ctr_state)
       and ca_address_sk = c_current_addr_sk
       and ca_state = 'AR'
       and ctr1.ctr_customer_sk = c_customer_sk
 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag
                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address
                  ,c_last_review_date,ctr_total_return
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:20.189-07:00,2024-03-10T18:33:20.408-07:00,219,0,0,218,1,0,0,0,0,,,0,,,0,0.000033000,0,8.9.2,0,0,0,0,0,FALSE,2066b24ae63266852d830235ecdbe315,2,671dc439c5d2dbf8c15e4c7175f380a3,1
"{""GlobalStats"":{""partitionsTotal"":72982,""partitionsAssigned"":70676,""bytesAssigned"":1214959101952},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER.C_LAST_NAME"",""CUSTOMER.C_FIRST_NAME"",""CUSTOMER.C_SALUTATION"",""CUSTOMER.C_PREFERRED_CUST_FLAG"",""STORE_SALES.SS_TICKET_NUMBER"",""COUNT(*)""]},{""id"":1,""operation"":""Sort"",""expressions"":[""CUSTOMER.C_LAST_NAME ASC NULLS LAST"",""CUSTOMER.C_FIRST_NAME ASC NULLS LAST"",""CUSTOMER.C_SALUTATION ASC NULLS LAST"",""CUSTOMER.C_PREFERRED_CUST_FLAG DESC NULLS FIRST"",""STORE_SALES.SS_TICKET_NUMBER ASC NULLS LAST""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_SALUTATION"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_PREFERRED_CUST_FLAG""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""((COUNT(*)) >= 15) AND ((COUNT(*)) <= 20)""],""parentOperators"":[2]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT_INTERNAL(*)(COUNT(*), COUNT_INTERNAL(*)(COUNT(*), COUNT(*)))]"",""groupKeys: [STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[5]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE.S_STORE_SK]""],""parentOperators"":[7]},{""id"":9,""operation"":""Filter"",""expressions"":[""STORE.S_COUNTY IN 'Harmon County' IN 'Tehama County' IN 'Huron County' IN 'Brazos County' IN 'Mesa County' IN 'Somerset County' IN 'Abbeville County' IN 'Van Buren County'""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_COUNTY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT_INTERNAL(*)(COUNT(*), COUNT(*))]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[7]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK]""],""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""(HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL IN '1001-5000' IN 'Unknown') AND (HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0) AND ((IFF(HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0, SCALED_ROUND_INT_DIVIDE(HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT, HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT), null)) > 1.2)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_BUY_POTENTIAL"",""HD_DEP_COUNT"",""HD_VEHICLE_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[12]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""((DATE_DIM.D_DOM <= 3) OR (DATE_DIM.D_DOM >= 25) OR (DATE_DIM.D_DOM <= 28)) AND ((DATE_DIM.D_DOM <= 3) OR ((DATE_DIM.D_DOM >= 25) AND (DATE_DIM.D_DOM <= 28))) AND (DATE_DIM.D_YEAR IN 2000 IN 2001 IN 2002)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_DOM""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[17]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_HDEMO_SK"",""SS_STORE_SK"",""SS_TICKET_NUMBER""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[21]}]]}",01b2e7fd-0002-2ff0-0051-ba870003005e,"explain using json select /* { ""query"":""query34"",""streamId"":0,""querySequence"":73 } */ c_last_name
       ,c_first_name
       ,c_salutation
       ,c_preferred_cust_flag
       ,ss_ticket_number
       ,cnt from
   (select ss_ticket_number
          ,ss_customer_sk
          ,count(*) cnt
    from store_sales,date_dim,store,household_demographics
    where store_sales.ss_sold_date_sk = date_dim.d_date_sk
    and store_sales.ss_store_sk = store.s_store_sk
    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)
    and (household_demographics.hd_buy_potential = '1001-5000' or
         household_demographics.hd_buy_potential = 'Unknown')
    and household_demographics.hd_vehicle_count > 0
    and (case when household_demographics.hd_vehicle_count > 0
	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count
	else null
	end)  > 1.2
    and date_dim.d_year in (2000,2000+1,2000+2)
    and store.s_county in ('Harmon County','Tehama County','Huron County','Brazos County',
                           'Mesa County','Somerset County','Abbeville County','Van Buren County')
    group by ss_ticket_number,ss_customer_sk) dn,customer
    where ss_customer_sk = c_customer_sk
      and cnt between 15 and 20
    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:17.893-07:00,2024-03-10T18:33:18.557-07:00,664,0,0,662,2,0,0,0,0,,,0,,,0,0.000101000,0,8.9.2,0,0,0,0,0,FALSE,cf1df67314169d308684fa9de821b0e2,2,415173faaab5669c6bbdd8007c1250dc,1
"{""GlobalStats"":{""partitionsTotal"":301705,""partitionsAssigned"":301705,""bytesAssigned"":5149777754624},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""MAX(SUM(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE)))))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE)))]""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE))))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE))]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[4]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 1999 IN 2000 IN 2001 IN 2002""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[7]},{""id"":11,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_QUANTITY"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[11]}],[{""id"":0,""operation"":""Result"",""expressions"":[""UNION_ALL(CUSTOMER.C_LAST_NAME, CUSTOMER.C_LAST_NAME)"",""UNION_ALL(CUSTOMER.C_FIRST_NAME, CUSTOMER.C_FIRST_NAME)"",""UNION_ALL(SUM(SUM(SUM(SUM(SUM((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE)))))), SUM(SUM(SUM(SUM(SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE)))))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [\""values\"".C_LAST_NAME ASC NULLS LAST, \""values\"".C_FIRST_NAME ASC NULLS LAST, \""values\"".SALES ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(SUM((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE))))))]"",""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE)))))]"",""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME]""],""parentOperators"":[3]},{""id"":5,""operation"":""SemiJoin"",""expressions"":[""joinKey: (BEST_SS_CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""groupKeys: [BEST_SS_CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[5]},{""id"":7,""operation"":""WithReference"",""parentOperators"":[6]},{""id"":8,""operation"":""WithClause"",""expressions"":[""BEST_SS_CUSTOMER""],""parentOperators"":[7,49]},{""id"":9,""operation"":""Filter"",""expressions"":[""(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE))) > ((95 / 100) * (Subquery(Step1)))""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[9]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_CUSTOMER_SK IS NOT NULL""],""parentOperators"":[11]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_CUSTOMER_SK"",""SS_QUANTITY"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE))))]"",""groupKeys: [CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CATALOG_SALES.CS_BILL_CUSTOMER_SK]""],""parentOperators"":[5]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[17]},{""id"":19,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE)))]"",""groupKeys: [CATALOG_SALES.CS_BILL_CUSTOMER_SK]""],""parentOperators"":[17]},{""id"":20,""operation"":""SemiJoin"",""expressions"":[""joinKey: (FREQUENT_SS_ITEMS.ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[19]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""groupKeys: [FREQUENT_SS_ITEMS.ITEM_SK]""],""parentOperators"":[20]},{""id"":22,""operation"":""WithReference"",""parentOperators"":[21]},{""id"":23,""operation"":""WithClause"",""expressions"":[""FREQUENT_SS_ITEMS""],""parentOperators"":[22,63]},{""id"":24,""operation"":""Filter"",""expressions"":[""(COUNT(*)) > 4""],""parentOperators"":[23]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [SUBSTR(ITEM.I_ITEM_DESC, 1, 30), ITEM.I_ITEM_SK, DATE_DIM.D_DATE]""],""parentOperators"":[24]},{""id"":26,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT_INTERNAL(*)(COUNT(*), COUNT(*))]"",""groupKeys: [SUBSTR(ITEM.I_ITEM_DESC, 1, 30), ITEM.I_ITEM_SK, DATE_DIM.D_DATE]""],""parentOperators"":[25]},{""id"":27,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[26]},{""id"":28,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_ITEM_DESC]""],""parentOperators"":[27]},{""id"":29,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_DESC""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[28]},{""id"":30,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [DATE_DIM.D_DATE, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[27]},{""id"":31,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[30]},{""id"":32,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 1999 IN 2000 IN 2001 IN 2002""],""parentOperators"":[31]},{""id"":33,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[32]},{""id"":34,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[31]},{""id"":35,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[34]},{""id"":36,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[35]},{""id"":37,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE))]"",""groupKeys: [CATALOG_SALES.CS_BILL_CUSTOMER_SK, CATALOG_SALES.CS_ITEM_SK]""],""parentOperators"":[20]},{""id"":38,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[37]},{""id"":39,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 1)""],""parentOperators"":[38]},{""id"":40,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[39]},{""id"":41,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[38]},{""id"":42,""operation"":""JoinFilter"",""expressions"":[""joinKey: (BEST_SS_CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[41]},{""id"":43,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_ITEM_SK"",""CS_QUANTITY"",""CS_LIST_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[42]},{""id"":45,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE))))))]"",""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME]""],""parentOperators"":[44]},{""id"":46,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE)))))]"",""groupKeys: [CUSTOMER.C_LAST_NAME, CUSTOMER.C_FIRST_NAME]""],""parentOperators"":[45]},{""id"":47,""operation"":""SemiJoin"",""expressions"":[""joinKey: (BEST_SS_CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[46]},{""id"":48,""operation"":""Aggregate"",""expressions"":[""groupKeys: [BEST_SS_CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[47]},{""id"":49,""operation"":""WithReference"",""parentOperators"":[48]},{""id"":50,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE))))]"",""groupKeys: [CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[47]},{""id"":51,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[50]},{""id"":52,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[51]},{""id"":53,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE)))]"",""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[51]},{""id"":54,""operation"":""SemiJoin"",""expressions"":[""joinKey: (WEB_SALES.WS_ITEM_SK = FREQUENT_SS_ITEMS.ITEM_SK)""],""parentOperators"":[53]},{""id"":55,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE))]"",""groupKeys: [WEB_SALES.WS_ITEM_SK, WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[54]},{""id"":56,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[55]},{""id"":57,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 1)""],""parentOperators"":[56]},{""id"":58,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[57]},{""id"":59,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[56]},{""id"":60,""operation"":""JoinFilter"",""expressions"":[""joinKey: (BEST_SS_CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[59]},{""id"":61,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_BILL_CUSTOMER_SK"",""WS_QUANTITY"",""WS_LIST_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[60]},{""id"":62,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WEB_SALES.WS_ITEM_SK = FREQUENT_SS_ITEMS.ITEM_SK)""],""parentOperators"":[54]},{""id"":63,""operation"":""WithReference"",""parentOperators"":[62]}]]}",01b2e7fc-0002-2ebc-0051-ba870002370a,"explain using json with /* { ""query"":""query23_p2"",""streamId"":0,""querySequence"":68 } */ frequent_ss_items as
 (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt
  from store_sales
      ,date_dim
      ,item
  where ss_sold_date_sk = d_date_sk
    and ss_item_sk = i_item_sk
    and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)
  group by substr(i_item_desc,1,30),i_item_sk,d_date
  having count(*) >4),
 max_store_sales as
 (select max(csales) tpcds_cmax
  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales
        from store_sales
            ,customer
            ,date_dim
        where ss_customer_sk = c_customer_sk
         and ss_sold_date_sk = d_date_sk
         and d_year in (1999,1999+1,1999+2,1999+3)
        group by c_customer_sk)),
 best_ss_customer as
 (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales
  from store_sales
      ,customer
  where ss_customer_sk = c_customer_sk
  group by c_customer_sk
  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select
  *
 from max_store_sales))
  select  c_last_name,c_first_name,sales
 from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales
        from catalog_sales
            ,customer
            ,date_dim
        where d_year = 1999
         and d_moy = 1
         and cs_sold_date_sk = d_date_sk
         and cs_item_sk in (select item_sk from frequent_ss_items)
         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)
         and cs_bill_customer_sk = c_customer_sk
       group by c_last_name,c_first_name
      union all
      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales
       from web_sales
           ,customer
           ,date_dim
       where d_year = 1999
         and d_moy = 1
         and ws_sold_date_sk = d_date_sk
         and ws_item_sk in (select item_sk from frequent_ss_items)
         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)
         and ws_bill_customer_sk = c_customer_sk
       group by c_last_name,c_first_name)
     order by c_last_name,c_first_name,sales
  limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:19.254-07:00,2024-03-10T18:32:20.717-07:00,1463,0,0,1461,2,0,0,0,0,,,0,,,0,0.000223000,0,8.9.2,0,0,0,0,0,FALSE,09e628ccf16103d3c02239bda0efb830,2,29ee719bf671b4146843db28c1ec70ff,1
"{""GlobalStats"":{""partitionsTotal"":79791,""partitionsAssigned"":77485,""bytesAssigned"":1337396117504},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""STORE.S_STORE_NAME"",""STORE.S_COMPANY_ID"",""STORE.S_STREET_NUMBER"",""STORE.S_STREET_NAME"",""STORE.S_STREET_TYPE"",""STORE.S_SUITE_NUMBER"",""STORE.S_CITY"",""STORE.S_COUNTY"",""STORE.S_STATE"",""STORE.S_ZIP"",""SUM(SUM_INTERNAL(SUM(SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 30, 1, 0))), COUNT(*)))"",""SUM(SUM_INTERNAL(SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 30) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 60), 1, 0))), COUNT(*)))"",""SUM(SUM_INTERNAL(SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 60) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 90), 1, 0))), COUNT(*)))"",""SUM(SUM_INTERNAL(SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 90) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 120), 1, 0))), COUNT(*)))"",""SUM(SUM_INTERNAL(SUM(SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 120, 1, 0))), COUNT(*)))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [STORE.S_STORE_NAME ASC NULLS LAST, STORE.S_COMPANY_ID ASC NULLS LAST, STORE.S_STREET_NUMBER ASC NULLS LAST, STORE.S_STREET_NAME ASC NULLS LAST, STORE.S_STREET_TYPE ASC NULLS LAST, STORE.S_SUITE_NUMBER ASC NULLS LAST, STORE.S_CITY ASC NULLS LAST, STORE.S_COUNTY ASC NULLS LAST, STORE.S_STATE ASC NULLS LAST, STORE.S_ZIP ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 30, 1, 0))), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 30) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 60), 1, 0))), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 60) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 90), 1, 0))), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 90) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 120), 1, 0))), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 120, 1, 0))), COUNT(*)))]"",""groupKeys: [STORE.S_STORE_NAME, STORE.S_COMPANY_ID, STORE.S_STREET_NUMBER, STORE.S_STREET_NAME, STORE.S_STREET_TYPE, STORE.S_SUITE_NUMBER, STORE.S_CITY, STORE.S_COUNTY, STORE.S_STATE, STORE.S_ZIP]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 30, 1, 0))), COUNT(*)), SUM_INTERNAL(SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 30) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 60), 1, 0))), COUNT(*)), SUM_INTERNAL(SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 60) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 90), 1, 0))), COUNT(*)), SUM_INTERNAL(SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 90) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 120), 1, 0))), COUNT(*)), SUM_INTERNAL(SUM(SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 120, 1, 0))), COUNT(*))]"",""groupKeys: [STORE.S_STORE_NAME, STORE.S_COMPANY_ID, STORE.S_STREET_NUMBER, STORE.S_STREET_NAME, STORE.S_STREET_TYPE, STORE.S_SUITE_NUMBER, STORE.S_CITY, STORE.S_COUNTY, STORE.S_STATE, STORE.S_ZIP]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE.S_STORE_SK, STORE.S_STORE_NAME, STORE.S_COMPANY_ID, STORE.S_STREET_NUMBER, STORE.S_STREET_NAME, STORE.S_STREET_TYPE, STORE.S_SUITE_NUMBER, STORE.S_CITY, STORE.S_COUNTY, STORE.S_STATE, STORE.S_ZIP]""],""parentOperators"":[4]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME"",""S_COMPANY_ID"",""S_STREET_NUMBER"",""S_STREET_NAME"",""S_STREET_TYPE"",""S_SUITE_NUMBER"",""S_CITY"",""S_COUNTY"",""S_STATE"",""S_ZIP""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 30, 1, 0))), SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 30) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 60), 1, 0))), SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 60) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 90), 1, 0))), SUM(SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 90) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 120), 1, 0))), SUM(SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 120, 1, 0)))]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[4]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D1.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK""],""alias"":""D1"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 30, 1, 0)), SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 30) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 60), 1, 0)), SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 60) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 90), 1, 0)), SUM(IFF(((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 90) AND ((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) <= 120), 1, 0)), SUM(IFF((STORE_RETURNS.SR_RETURNED_DATE_SK - STORE_SALES.SS_SOLD_DATE_SK) > 120, 1, 0))]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[8]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_RETURNS.SR_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK) AND (STORE_RETURNS.SR_ITEM_SK = STORE_SALES.SS_ITEM_SK) AND (STORE_RETURNS.SR_TICKET_NUMBER = STORE_SALES.SS_TICKET_NUMBER)""],""parentOperators"":[10]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D2.D_DATE_SK = STORE_RETURNS.SR_RETURNED_DATE_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""(D2.D_YEAR = 2000) AND (D2.D_MOY = 9)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""alias"":""D2"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""(STORE_RETURNS.SR_CUSTOMER_SK IS NOT NULL) AND (STORE_RETURNS.SR_RETURNED_DATE_SK IS NOT NULL)""],""parentOperators"":[12]},{""id"":16,""operation"":""JoinFilter"",""expressions"":[""joinKey: (D2.D_DATE_SK = STORE_RETURNS.SR_RETURNED_DATE_SK)""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_RETURNED_DATE_SK"",""SR_ITEM_SK"",""SR_CUSTOMER_SK"",""SR_TICKET_NUMBER""],""partitionsAssigned"":7070,""partitionsTotal"":7070,""bytesAssigned"":124763446272,""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_CUSTOMER_SK IS NOT NULL)""],""parentOperators"":[11]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_CUSTOMER_SK"",""SS_STORE_SK"",""SS_TICKET_NUMBER""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[19]}]]}",01b2e7fc-0002-2e24-0051-ba870001d1fa,"explain using json select /* { ""query"":""query50"",""streamId"":0,""querySequence"":60 } */
   s_store_name
  ,s_company_id
  ,s_street_number
  ,s_street_name
  ,s_street_type
  ,s_suite_number
  ,s_city
  ,s_county
  ,s_state
  ,s_zip
  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as ""30 days""
  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and
                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as ""31-60 days""
  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and
                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as ""61-90 days""
  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and
                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as ""91-120 days""
  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as "">120 days""
from
   store_sales
  ,store_returns
  ,store
  ,date_dim d1
  ,date_dim d2
where
    d2.d_year = 2000
and d2.d_moy  = 9
and ss_ticket_number = sr_ticket_number
and ss_item_sk = sr_item_sk
and ss_sold_date_sk   = d1.d_date_sk
and sr_returned_date_sk   = d2.d_date_sk
and ss_customer_sk = sr_customer_sk
and ss_store_sk = s_store_sk
group by
   s_store_name
  ,s_company_id
  ,s_street_number
  ,s_street_name
  ,s_street_type
  ,s_suite_number
  ,s_city
  ,s_county
  ,s_state
  ,s_zip
order by s_store_name
        ,s_company_id
        ,s_street_number
        ,s_street_name
        ,s_street_type
        ,s_suite_number
        ,s_city
        ,s_county
        ,s_state
        ,s_zip
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:10.414-07:00,2024-03-10T18:32:10.799-07:00,385,0,0,384,1,0,0,0,0,,,0,,,0,0.000059000,0,8.9.2,0,0,0,0,0,FALSE,2b69bc2feee2321dcb762c4c2e05f58e,2,6b486fc7f332be8a69874504eb617718,1
"{""GlobalStats"":{""partitionsTotal"":55440,""partitionsAssigned"":55440,""bytesAssigned"":926724607488},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER_ADDRESS.CA_ZIP"",""SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CUSTOMER_ADDRESS.CA_ZIP ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))]"",""groupKeys: [CUSTOMER_ADDRESS.CA_ZIP]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))]"",""groupKeys: [CUSTOMER_ADDRESS.CA_ZIP]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)"",""joinFilter: ((SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5)) IN '85669' IN '86197' IN '88274' IN '83405' IN '86475' IN '85392' IN '85460' IN '80348' IN '81792') OR (CUSTOMER_ADDRESS.CA_STATE IN 'CA' IN 'WA' IN 'GA') OR ((CATALOG_SALES.CS_SALES_PRICE) > 500)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE"",""CA_ZIP""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))]"",""groupKeys: [CUSTOMER.C_CURRENT_ADDR_SK, CATALOG_SALES.CS_SALES_PRICE]""],""parentOperators"":[4]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)"",""joinFilter: ((SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5)) IN '85669' IN '86197' IN '88274' IN '83405' IN '86475' IN '85392' IN '85460' IN '80348' IN '81792') OR (CUSTOMER_ADDRESS.CA_STATE IN 'CA' IN 'WA' IN 'GA') OR ((CATALOG_SALES.CS_SALES_PRICE) > 500)""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_ADDR_SK""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CATALOG_SALES.CS_SALES_PRICE)]"",""groupKeys: [CATALOG_SALES.CS_SALES_PRICE, CATALOG_SALES.CS_BILL_CUSTOMER_SK]""],""parentOperators"":[7]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_QOY = 1) AND (DATE_DIM.D_YEAR = 2002)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[11]},{""id"":15,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_SALES_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[15]}]]}",01b2e7fc-0002-2f99-0051-ba870002819e,"explain using json select /* { ""query"":""query15"",""streamId"":0,""querySequence"":57 } */  ca_zip
       ,sum(cs_sales_price)
 from catalog_sales
     ,customer
     ,customer_address
     ,date_dim
 where cs_bill_customer_sk = c_customer_sk
 	and c_current_addr_sk = ca_address_sk
 	and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',
                                   '85392', '85460', '80348', '81792')
 	      or ca_state in ('CA','WA','GA')
 	      or cs_sales_price > 500)
 	and cs_sold_date_sk = d_date_sk
 	and d_qoy = 1 and d_year = 2002
 group by ca_zip
 order by ca_zip
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:08.481-07:00,2024-03-10T18:32:08.835-07:00,354,0,0,353,1,0,0,0,0,,,0,,,0,0.000054000,0,8.9.2,0,0,0,0,0,FALSE,f86d4cc7724c5611eeeff5ff7d2e6c76,2,9b9ffdf940aa07601888593c79771f5f,1
"{""GlobalStats"":{""partitionsTotal"":72722,""partitionsAssigned"":70416,""bytesAssigned"":1212654344192},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_CATEGORY"",""ITEM.I_CLASS"",""ITEM.I_BRAND"",""STORE.S_STORE_NAME"",""STORE.S_COMPANY_NAME"",""DATE_DIM.D_MOY"",""SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))"",""AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [(TMP1.SUM_SALES) - TMP1.AVG_MONTHLY_SALES ASC NULLS LAST, TMP1.S_STORE_NAME ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(IFF(AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME) <> 0, SCALED_ROUND_INT_DIVIDE(ABS((SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) - AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME)), AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME)), null)) > 0.1""],""parentOperators"":[1]},{""id"":3,""operation"":""WindowFunction"",""expressions"":[""AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME)""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))]"",""groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, DATE_DIM.D_MOY]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*))))]"",""groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, DATE_DIM.D_MOY]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 2000""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))]"",""groupKeys: [STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, ITEM.I_BRAND, ITEM.I_CLASS, ITEM.I_CATEGORY, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[6]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME"",""S_COMPANY_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*))]"",""groupKeys: [ITEM.I_BRAND, ITEM.I_CLASS, ITEM.I_CATEGORY, STORE_SALES.SS_SOLD_DATE_SK, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[10]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_BRAND, ITEM.I_CLASS, ITEM.I_CATEGORY]""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""((ITEM.I_CATEGORY IN 'Electronics' IN 'Jewelry' IN 'Women') OR (ITEM.I_CATEGORY IN 'Children' IN 'Men' IN 'Books')) AND ((ITEM.I_CLASS IN 'audio' IN 'birdal' IN 'maternity') OR (ITEM.I_CLASS IN 'newborn' IN 'shirts' IN 'self-help')) AND (((ITEM.I_CATEGORY IN 'Electronics' IN 'Jewelry' IN 'Women') AND (ITEM.I_CLASS IN 'audio' IN 'birdal' IN 'maternity')) OR ((ITEM.I_CATEGORY IN 'Children' IN 'Men' IN 'Books') AND (ITEM.I_CLASS IN 'newborn' IN 'shirts' IN 'self-help')))""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND"",""I_CLASS"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[13]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_STORE_SK"",""SS_SALES_PRICE""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[18]}]]}",01b2e7fc-0002-2d83-0051-ba87000251be,"explain using json select /* { ""query"":""query89"",""streamId"":0,""querySequence"":56 } */  *
from(
select i_category, i_class, i_brand,
       s_store_name, s_company_name,
       d_moy,
       sum(ss_sales_price) sum_sales,
       avg(sum(ss_sales_price)) over
         (partition by i_category, i_brand, s_store_name, s_company_name)
         avg_monthly_sales
from item, store_sales, date_dim, store
where ss_item_sk = i_item_sk and
      ss_sold_date_sk = d_date_sk and
      ss_store_sk = s_store_sk and
      d_year in (2000) and
        ((i_category in ('Electronics','Jewelry','Women') and
          i_class in ('audio','birdal','maternity')
         )
      or (i_category in ('Children','Men','Books') and
          i_class in ('newborn','shirts','self-help')
        ))
group by i_category, i_class, i_brand,
         s_store_name, s_company_name, d_moy) tmp1
where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1
order by sum_sales - avg_monthly_sales, s_store_name
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:07.24-07:00,2024-03-10T18:32:08.148-07:00,908,0,0,907,1,0,0,0,0,,,0,,,0,0.000139000,0,8.9.2,0,0,0,0,0,FALSE,05011d87c6f577a82946db6681f34965,2,d63771bd0d88cb605e4388c9d0754209,1
"{""GlobalStats"":{""partitionsTotal"":55162,""partitionsAssigned"":55162,""bytesAssigned"":922111060480},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SUM(WEB_SALES.WS_EXT_DISCOUNT_AMT)""]},{""id"":1,""operation"":""Limit"",""expressions"":[""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_EXT_DISCOUNT_AMT)]""],""parentOperators"":[1]},{""id"":3,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_EXT_DISCOUNT_AMT) > (1.3 * ((SUM(WEB_SALES.WS_EXT_DISCOUNT_AMT)) / (NVL(COUNT(WEB_SALES.WS_EXT_DISCOUNT_AMT), 0))))""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_EXT_DISCOUNT_AMT), COUNT(WEB_SALES.WS_EXT_DISCOUNT_AMT)]"",""groupKeys: [SYSTEM$DISTINCT_ID(), ITEM.I_ITEM_SK, ITEM.I_MANUFACT_ID, DATE_DIM.D_DATE_SK, DATE_DIM.D_DATE, WEB_SALES.WS_SOLD_DATE_SK, WEB_SALES.WS_ITEM_SK, WEB_SALES.WS_EXT_DISCOUNT_AMT]""],""parentOperators"":[3]},{""id"":5,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2000-01-23') AND (DATE_DIM.D_DATE <= '2000-04-22')""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[6]},{""id"":10,""operation"":""Filter"",""expressions"":[""ITEM.I_MANUFACT_ID = 605""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_MANUFACT_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[9]},{""id"":13,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_EXT_DISCOUNT_AMT""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[13]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[5]},{""id"":16,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2000-01-23') AND (DATE_DIM.D_DATE <= '2000-04-22')""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_ITEM_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[15]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_SALES.WS_ITEM_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_EXT_DISCOUNT_AMT""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[19]}]]}",01b2e7fb-0002-2ebc-0051-ba87000236e2,"explain using json select /* { ""query"":""query92"",""streamId"":0,""querySequence"":44 } */
   sum(ws_ext_discount_amt)  as ""Excess Discount Amount""
from
    web_sales
   ,item
   ,date_dim
where
i_manufact_id = 605
and i_item_sk = ws_item_sk
and d_date between '2000-01-23' and
        (cast('2000-01-23' as date) + interval '90 days')
and d_date_sk = ws_sold_date_sk
and ws_ext_discount_amt
     > (
         SELECT
            1.3 * avg(ws_ext_discount_amt)
         FROM
            web_sales
           ,date_dim
         WHERE
              ws_item_sk = i_item_sk
          and d_date between '2000-01-23' and
                             (cast('2000-01-23' as date) + interval '90 days')
          and d_date_sk = ws_sold_date_sk
      )
order by sum(ws_ext_discount_amt)
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:53.815-07:00,2024-03-10T18:31:54.418-07:00,603,0,0,602,1,0,0,0,0,,,0,,,0,0.000092000,0,8.9.2,0,0,0,0,0,FALSE,4dc5129cd4d8994c0031826a6ea3cada,2,c6a16666b665ea7cd365ecac3173c13f,1
"{""GlobalStats"":{""partitionsTotal"":82509,""partitionsAssigned"":82303,""bytesAssigned"":1381147406848},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""UNION_ALL(WAREHOUSE.W_WAREHOUSE_NAME, WAREHOUSE.W_WAREHOUSE_NAME)"",""UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)"",""UNION_ALL(WAREHOUSE.W_CITY, WAREHOUSE.W_CITY)"",""UNION_ALL(WAREHOUSE.W_COUNTY, WAREHOUSE.W_COUNTY)"",""UNION_ALL(WAREHOUSE.W_STATE, WAREHOUSE.W_STATE)"",""'United States'"",""'HARMSTORF,ZOUROS'"",""UNION_ALL(DATE_DIM.D_YEAR, DATE_DIM.D_YEAR)"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT)))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))"",""SUM(UNION_ALL(SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [X.W_WAREHOUSE_NAME ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 1, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 2, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 3, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 4, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 5, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 6, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 7, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 8, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 9, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 10, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 11, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 12, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 1, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 2, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 3, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 4, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 5, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 6, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 7, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 8, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 9, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 10, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 11, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(SCALED_ROUND_INT_DIVIDE(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 12, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0))), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 1, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 2, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 3, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 4, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 5, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 6, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 7, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 8, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 9, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 10, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 11, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0)))), SUM(UNION_ALL(SUM(IFF(DATE_DIM.D_MOY = 12, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0)), SUM(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0))))]"",""groupKeys: [UNION_ALL(WAREHOUSE.W_WAREHOUSE_NAME, WAREHOUSE.W_WAREHOUSE_NAME), UNION_ALL(WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_WAREHOUSE_SQ_FT), UNION_ALL(WAREHOUSE.W_CITY, WAREHOUSE.W_CITY), UNION_ALL(WAREHOUSE.W_COUNTY, WAREHOUSE.W_COUNTY), UNION_ALL(WAREHOUSE.W_STATE, WAREHOUSE.W_STATE), UNION_ALL(DATE_DIM.D_YEAR, DATE_DIM.D_YEAR)]""],""parentOperators"":[1]},{""id"":3,""operation"":""UnionAll"",""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)))]"",""groupKeys: [WAREHOUSE.W_WAREHOUSE_NAME, WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_CITY, WAREHOUSE.W_COUNTY, WAREHOUSE.W_STATE, DATE_DIM.D_YEAR]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, (WEB_SALES.WS_SALES_PRICE) * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, WEB_SALES.WS_NET_PAID_INC_SHIP * (WEB_SALES.WS_QUANTITY), 0), COUNT(*))]"",""groupKeys: [WAREHOUSE.W_WAREHOUSE_NAME, WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_CITY, WAREHOUSE.W_COUNTY, WAREHOUSE.W_STATE, DATE_DIM.D_YEAR]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (SHIP_MODE.SM_SHIP_MODE_SK = WEB_SALES.WS_SHIP_MODE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [SHIP_MODE.SM_SHIP_MODE_SK]""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""SHIP_MODE.SM_CARRIER IN 'HARMSTORF' IN 'ZOUROS'""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.SHIP_MODE""],""expressions"":[""SM_SHIP_MODE_SK"",""SM_CARRIER""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":3072,""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WAREHOUSE.W_WAREHOUSE_SK = WEB_SALES.WS_WAREHOUSE_SK)""],""parentOperators"":[6]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WAREHOUSE""],""expressions"":[""W_WAREHOUSE_SK"",""W_WAREHOUSE_NAME"",""W_WAREHOUSE_SQ_FT"",""W_CITY"",""W_COUNTY"",""W_STATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7168,""parentOperators"":[10]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = WEB_SALES.WS_SOLD_TIME_SK)""],""parentOperators"":[10]},{""id"":13,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_TIME >= 33232) AND (TIME_DIM.T_TIME <= 62032)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_TIME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[13]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":16,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 1998""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_SOLD_TIME_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL) AND (WEB_SALES.WS_WAREHOUSE_SK IS NOT NULL) AND (WEB_SALES.WS_SHIP_MODE_SK IS NOT NULL)""],""parentOperators"":[15]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (SHIP_MODE.SM_SHIP_MODE_SK = WEB_SALES.WS_SHIP_MODE_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_SOLD_TIME_SK"",""WS_SHIP_MODE_SK"",""WS_WAREHOUSE_SK"",""WS_QUANTITY"",""WS_SALES_PRICE"",""WS_NET_PAID_INC_SHIP""],""partitionsAssigned"":27574,""partitionsTotal"":27579,""bytesAssigned"":460956759040,""parentOperators"":[19]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))), SUM(SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)))]"",""groupKeys: [WAREHOUSE.W_WAREHOUSE_NAME, WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_CITY, WAREHOUSE.W_COUNTY, WAREHOUSE.W_STATE, DATE_DIM.D_YEAR]""],""parentOperators"":[3]},{""id"":22,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_EXT_LIST_PRICE * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 1, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 2, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 3, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 4, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 5, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 6, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 7, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 8, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 9, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 10, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 11, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*)), SUM_INTERNAL(IFF(DATE_DIM.D_MOY = 12, CATALOG_SALES.CS_NET_PAID * (CATALOG_SALES.CS_QUANTITY), 0), COUNT(*))]"",""groupKeys: [WAREHOUSE.W_WAREHOUSE_NAME, WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_CITY, WAREHOUSE.W_COUNTY, WAREHOUSE.W_STATE, DATE_DIM.D_YEAR]""],""parentOperators"":[21]},{""id"":23,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WAREHOUSE.W_WAREHOUSE_SK = CATALOG_SALES.CS_WAREHOUSE_SK)""],""parentOperators"":[22]},{""id"":24,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [WAREHOUSE.W_WAREHOUSE_SK, WAREHOUSE.W_WAREHOUSE_NAME, WAREHOUSE.W_WAREHOUSE_SQ_FT, WAREHOUSE.W_CITY, WAREHOUSE.W_COUNTY, WAREHOUSE.W_STATE]""],""parentOperators"":[23]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WAREHOUSE""],""expressions"":[""W_WAREHOUSE_SK"",""W_WAREHOUSE_NAME"",""W_WAREHOUSE_SQ_FT"",""W_CITY"",""W_COUNTY"",""W_STATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7168,""parentOperators"":[24]},{""id"":26,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[23]},{""id"":27,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 1998""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[27]},{""id"":29,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = CATALOG_SALES.CS_SOLD_TIME_SK)""],""parentOperators"":[26]},{""id"":30,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_TIME >= 33232) AND (TIME_DIM.T_TIME <= 62032)""],""parentOperators"":[29]},{""id"":31,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_TIME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[30]},{""id"":32,""operation"":""InnerJoin"",""expressions"":[""joinKey: (SHIP_MODE.SM_SHIP_MODE_SK = CATALOG_SALES.CS_SHIP_MODE_SK)""],""parentOperators"":[29]},{""id"":33,""operation"":""Filter"",""expressions"":[""SHIP_MODE.SM_CARRIER IN 'HARMSTORF' IN 'ZOUROS'""],""parentOperators"":[32]},{""id"":34,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.SHIP_MODE""],""expressions"":[""SM_SHIP_MODE_SK"",""SM_CARRIER""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":3072,""parentOperators"":[33]},{""id"":35,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SOLD_TIME_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL) AND (CATALOG_SALES.CS_WAREHOUSE_SK IS NOT NULL) AND (CATALOG_SALES.CS_SHIP_MODE_SK IS NOT NULL)""],""parentOperators"":[32]},{""id"":36,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WAREHOUSE.W_WAREHOUSE_SK = CATALOG_SALES.CS_WAREHOUSE_SK)""],""parentOperators"":[35]},{""id"":37,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_SOLD_TIME_SK"",""CS_SHIP_MODE_SK"",""CS_WAREHOUSE_SK"",""CS_QUANTITY"",""CS_EXT_LIST_PRICE"",""CS_NET_PAID""],""partitionsAssigned"":54721,""partitionsTotal"":54922,""bytesAssigned"":920184101376,""parentOperators"":[36]}]]}",01b2e7fb-0002-2e22-0051-ba870002d036,"explain using json select /* { ""query"":""query66"",""streamId"":0,""querySequence"":39 } */
         w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
        ,ship_carriers
        ,year
 	,sum(jan_sales) as jan_sales
 	,sum(feb_sales) as feb_sales
 	,sum(mar_sales) as mar_sales
 	,sum(apr_sales) as apr_sales
 	,sum(may_sales) as may_sales
 	,sum(jun_sales) as jun_sales
 	,sum(jul_sales) as jul_sales
 	,sum(aug_sales) as aug_sales
 	,sum(sep_sales) as sep_sales
 	,sum(oct_sales) as oct_sales
 	,sum(nov_sales) as nov_sales
 	,sum(dec_sales) as dec_sales
 	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot
 	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot
 	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot
 	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot
 	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot
 	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot
 	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot
 	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot
 	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot
 	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot
 	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot
 	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot
 	,sum(jan_net) as jan_net
 	,sum(feb_net) as feb_net
 	,sum(mar_net) as mar_net
 	,sum(apr_net) as apr_net
 	,sum(may_net) as may_net
 	,sum(jun_net) as jun_net
 	,sum(jul_net) as jul_net
 	,sum(aug_net) as aug_net
 	,sum(sep_net) as sep_net
 	,sum(oct_net) as oct_net
 	,sum(nov_net) as nov_net
 	,sum(dec_net) as dec_net
 from (
     select
 	w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,'HARMSTORF' || ',' || 'ZOUROS' as ship_carriers
       ,d_year as year
 	,sum(case when d_moy = 1
 		then ws_sales_price* ws_quantity else 0 end) as jan_sales
 	,sum(case when d_moy = 2
 		then ws_sales_price* ws_quantity else 0 end) as feb_sales
 	,sum(case when d_moy = 3
 		then ws_sales_price* ws_quantity else 0 end) as mar_sales
 	,sum(case when d_moy = 4
 		then ws_sales_price* ws_quantity else 0 end) as apr_sales
 	,sum(case when d_moy = 5
 		then ws_sales_price* ws_quantity else 0 end) as may_sales
 	,sum(case when d_moy = 6
 		then ws_sales_price* ws_quantity else 0 end) as jun_sales
 	,sum(case when d_moy = 7
 		then ws_sales_price* ws_quantity else 0 end) as jul_sales
 	,sum(case when d_moy = 8
 		then ws_sales_price* ws_quantity else 0 end) as aug_sales
 	,sum(case when d_moy = 9
 		then ws_sales_price* ws_quantity else 0 end) as sep_sales
 	,sum(case when d_moy = 10
 		then ws_sales_price* ws_quantity else 0 end) as oct_sales
 	,sum(case when d_moy = 11
 		then ws_sales_price* ws_quantity else 0 end) as nov_sales
 	,sum(case when d_moy = 12
 		then ws_sales_price* ws_quantity else 0 end) as dec_sales
 	,sum(case when d_moy = 1
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net
 	,sum(case when d_moy = 2
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net
 	,sum(case when d_moy = 3
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net
 	,sum(case when d_moy = 4
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net
 	,sum(case when d_moy = 5
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net
 	,sum(case when d_moy = 6
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net
 	,sum(case when d_moy = 7
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net
 	,sum(case when d_moy = 8
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net
 	,sum(case when d_moy = 9
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net
 	,sum(case when d_moy = 10
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net
 	,sum(case when d_moy = 11
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net
 	,sum(case when d_moy = 12
 		then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net
     from
          web_sales
         ,warehouse
         ,date_dim
         ,time_dim
 	  ,ship_mode
     where
            ws_warehouse_sk =  w_warehouse_sk
        and ws_sold_date_sk = d_date_sk
        and ws_sold_time_sk = t_time_sk
 	and ws_ship_mode_sk = sm_ship_mode_sk
        and d_year = 1998
 	and t_time between 33232 and 33232+28800
 	and sm_carrier in ('HARMSTORF','ZOUROS')
     group by
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
       ,d_year
 union all
     select
 	w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,'HARMSTORF' || ',' || 'ZOUROS' as ship_carriers
       ,d_year as year
 	,sum(case when d_moy = 1
 		then cs_ext_list_price* cs_quantity else 0 end) as jan_sales
 	,sum(case when d_moy = 2
 		then cs_ext_list_price* cs_quantity else 0 end) as feb_sales
 	,sum(case when d_moy = 3
 		then cs_ext_list_price* cs_quantity else 0 end) as mar_sales
 	,sum(case when d_moy = 4
 		then cs_ext_list_price* cs_quantity else 0 end) as apr_sales
 	,sum(case when d_moy = 5
 		then cs_ext_list_price* cs_quantity else 0 end) as may_sales
 	,sum(case when d_moy = 6
 		then cs_ext_list_price* cs_quantity else 0 end) as jun_sales
 	,sum(case when d_moy = 7
 		then cs_ext_list_price* cs_quantity else 0 end) as jul_sales
 	,sum(case when d_moy = 8
 		then cs_ext_list_price* cs_quantity else 0 end) as aug_sales
 	,sum(case when d_moy = 9
 		then cs_ext_list_price* cs_quantity else 0 end) as sep_sales
 	,sum(case when d_moy = 10
 		then cs_ext_list_price* cs_quantity else 0 end) as oct_sales
 	,sum(case when d_moy = 11
 		then cs_ext_list_price* cs_quantity else 0 end) as nov_sales
 	,sum(case when d_moy = 12
 		then cs_ext_list_price* cs_quantity else 0 end) as dec_sales
 	,sum(case when d_moy = 1
 		then cs_net_paid * cs_quantity else 0 end) as jan_net
 	,sum(case when d_moy = 2
 		then cs_net_paid * cs_quantity else 0 end) as feb_net
 	,sum(case when d_moy = 3
 		then cs_net_paid * cs_quantity else 0 end) as mar_net
 	,sum(case when d_moy = 4
 		then cs_net_paid * cs_quantity else 0 end) as apr_net
 	,sum(case when d_moy = 5
 		then cs_net_paid * cs_quantity else 0 end) as may_net
 	,sum(case when d_moy = 6
 		then cs_net_paid * cs_quantity else 0 end) as jun_net
 	,sum(case when d_moy = 7
 		then cs_net_paid * cs_quantity else 0 end) as jul_net
 	,sum(case when d_moy = 8
 		then cs_net_paid * cs_quantity else 0 end) as aug_net
 	,sum(case when d_moy = 9
 		then cs_net_paid * cs_quantity else 0 end) as sep_net
 	,sum(case when d_moy = 10
 		then cs_net_paid * cs_quantity else 0 end) as oct_net
 	,sum(case when d_moy = 11
 		then cs_net_paid * cs_quantity else 0 end) as nov_net
 	,sum(case when d_moy = 12
 		then cs_net_paid * cs_quantity else 0 end) as dec_net
     from
          catalog_sales
         ,warehouse
         ,date_dim
         ,time_dim
 	 ,ship_mode
     where
            cs_warehouse_sk =  w_warehouse_sk
        and cs_sold_date_sk = d_date_sk
        and cs_sold_time_sk = t_time_sk
 	and cs_ship_mode_sk = sm_ship_mode_sk
        and d_year = 1998
 	and t_time between 33232 AND 33232+28800
 	and sm_carrier in ('HARMSTORF','ZOUROS')
     group by
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
       ,d_year
 ) x
 group by
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,ship_carriers
       ,year
 order by w_warehouse_name
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:47.827-07:00,2024-03-10T18:31:49.324-07:00,1497,0,0,1495,2,0,0,0,0,,,0,,,0,0.000229000,0,8.9.2,0,0,0,0,0,FALSE,c0e951196b1b99a0dca861c0c630bc89,2,de52048b1ec391fe1ec81cdfe1f9d47d,1
"{""GlobalStats"":{""partitionsTotal"":5533,""partitionsAssigned"":5533,""bytesAssigned"":86416382976},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER.C_CUSTOMER_ID"",""CUSTOMER.C_SALUTATION"",""CUSTOMER.C_FIRST_NAME"",""CUSTOMER.C_LAST_NAME"",""CUSTOMER_ADDRESS.CA_STREET_NUMBER"",""CUSTOMER_ADDRESS.CA_STREET_NAME"",""CUSTOMER_ADDRESS.CA_STREET_TYPE"",""CUSTOMER_ADDRESS.CA_SUITE_NUMBER"",""CUSTOMER_ADDRESS.CA_CITY"",""CUSTOMER_ADDRESS.CA_COUNTY"",""CUSTOMER_ADDRESS.CA_STATE"",""CUSTOMER_ADDRESS.CA_ZIP"",""CUSTOMER_ADDRESS.CA_COUNTRY"",""CUSTOMER_ADDRESS.CA_GMT_OFFSET"",""CUSTOMER_ADDRESS.CA_LOCATION_TYPE"",""CTR1.CTR_TOTAL_RETURN""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CUSTOMER.C_CUSTOMER_ID ASC NULLS LAST, CUSTOMER.C_SALUTATION ASC NULLS LAST, CUSTOMER.C_FIRST_NAME ASC NULLS LAST, CUSTOMER.C_LAST_NAME ASC NULLS LAST, CUSTOMER_ADDRESS.CA_STREET_NUMBER ASC NULLS LAST, CUSTOMER_ADDRESS.CA_STREET_NAME ASC NULLS LAST, CUSTOMER_ADDRESS.CA_STREET_TYPE ASC NULLS LAST, CUSTOMER_ADDRESS.CA_SUITE_NUMBER ASC NULLS LAST, CUSTOMER_ADDRESS.CA_CITY ASC NULLS LAST, CUSTOMER_ADDRESS.CA_COUNTY ASC NULLS LAST, CUSTOMER_ADDRESS.CA_STATE ASC NULLS LAST, CUSTOMER_ADDRESS.CA_ZIP ASC NULLS LAST, CUSTOMER_ADDRESS.CA_COUNTRY ASC NULLS LAST, CUSTOMER_ADDRESS.CA_GMT_OFFSET ASC NULLS LAST, CUSTOMER_ADDRESS.CA_LOCATION_TYPE ASC NULLS LAST, CTR1.CTR_TOTAL_RETURN ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CURRENT_ADDR_SK = CUSTOMER_ADDRESS.CA_ADDRESS_SK)""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CTR1.CTR_CUSTOMER_SK = CUSTOMER.C_CUSTOMER_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CTR2.CTR_STATE = CTR1.CTR_STATE)"",""joinFilter: (CTR1.CTR_TOTAL_RETURN) > (((SUM(CTR2.CTR_TOTAL_RETURN)) / (NVL(COUNT(CTR2.CTR_TOTAL_RETURN), 0))) * 1.2)""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""(SUM(CTR2.CTR_TOTAL_RETURN) IS NOT NULL) AND (COUNT(CTR2.CTR_TOTAL_RETURN) IS NOT NULL)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CTR2.CTR_TOTAL_RETURN), COUNT(CTR2.CTR_TOTAL_RETURN)]"",""groupKeys: [CTR2.CTR_STATE]""],""parentOperators"":[5]},{""id"":7,""operation"":""WithReference"",""expressions"":[""CTR2""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""CTR2.CTR_STATE IS NOT NULL""],""parentOperators"":[7]},{""id"":9,""operation"":""WithClause"",""expressions"":[""CUSTOMER_TOTAL_RETURN""],""parentOperators"":[8,23]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(CATALOG_RETURNS.CR_RETURN_AMT_INC_TAX)))]"",""groupKeys: [CATALOG_RETURNS.CR_RETURNING_CUSTOMER_SK, CUSTOMER_ADDRESS.CA_STATE]""],""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(CATALOG_RETURNS.CR_RETURN_AMT_INC_TAX))]"",""groupKeys: [CATALOG_RETURNS.CR_RETURNING_CUSTOMER_SK, CUSTOMER_ADDRESS.CA_STATE]""],""parentOperators"":[10]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CATALOG_RETURNS.CR_RETURNING_ADDR_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CATALOG_RETURNS.CR_RETURN_AMT_INC_TAX)]"",""groupKeys: [CATALOG_RETURNS.CR_RETURNING_CUSTOMER_SK, CATALOG_RETURNS.CR_RETURNING_ADDR_SK]""],""parentOperators"":[12]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_RETURNS.CR_RETURNED_DATE_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 1998""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""CATALOG_RETURNS.CR_RETURNING_ADDR_SK IS NOT NULL""],""parentOperators"":[15]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CATALOG_RETURNS.CR_RETURNING_ADDR_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_RETURNS""],""expressions"":[""CR_RETURNED_DATE_SK"",""CR_RETURNING_CUSTOMER_SK"",""CR_RETURNING_ADDR_SK"",""CR_RETURN_AMT_INC_TAX""],""partitionsAssigned"":4759,""partitionsTotal"":4759,""bytesAssigned"":82532796416,""parentOperators"":[19]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CTR2.CTR_STATE = CTR1.CTR_STATE)"",""joinFilter: (CTR1.CTR_TOTAL_RETURN) > (((SUM(CTR2.CTR_TOTAL_RETURN)) / (NVL(COUNT(CTR2.CTR_TOTAL_RETURN), 0))) * 1.2)""],""parentOperators"":[4]},{""id"":22,""operation"":""WithReference"",""expressions"":[""CTR1""],""parentOperators"":[21]},{""id"":23,""operation"":""Filter"",""expressions"":[""(CUSTOMER_ADDRESS.CA_STATE IS NOT NULL) AND (CTR1.CTR_CUSTOMER_SK IS NOT NULL)""],""parentOperators"":[22]},{""id"":24,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CTR1.CTR_CUSTOMER_SK = CUSTOMER.C_CUSTOMER_SK)""],""parentOperators"":[3]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CUSTOMER_ID"",""C_CURRENT_ADDR_SK"",""C_SALUTATION"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[24]},{""id"":26,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_STATE = 'AR'""],""parentOperators"":[2]},{""id"":27,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CURRENT_ADDR_SK = CUSTOMER_ADDRESS.CA_ADDRESS_SK)""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STREET_NUMBER"",""CA_STREET_NAME"",""CA_STREET_TYPE"",""CA_SUITE_NUMBER"",""CA_CITY"",""CA_COUNTY"",""CA_STATE"",""CA_ZIP"",""CA_COUNTRY"",""CA_GMT_OFFSET"",""CA_LOCATION_TYPE""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[27]}]]}",01b2e7fb-0002-2ebc-0051-ba87000236d6,"explain using json with /* { ""query"":""query81"",""streamId"":0,""querySequence"":37 } */ customer_total_return as
 (select cr_returning_customer_sk as ctr_customer_sk
        ,ca_state as ctr_state,
 	sum(cr_return_amt_inc_tax) as ctr_total_return
 from catalog_returns
     ,date_dim
     ,customer_address
 where cr_returned_date_sk = d_date_sk
   and d_year =1998
   and cr_returning_addr_sk = ca_address_sk
 group by cr_returning_customer_sk
         ,ca_state )
  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name
                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset
                  ,ca_location_type,ctr_total_return
 from customer_total_return ctr1
     ,customer_address
     ,customer
 where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2
 			  from customer_total_return ctr2
                  	  where ctr1.ctr_state = ctr2.ctr_state)
       and ca_address_sk = c_current_addr_sk
       and ca_state = 'AR'
       and ctr1.ctr_customer_sk = c_customer_sk
 order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name
                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset
                  ,ca_location_type,ctr_total_return
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:46.355-07:00,2024-03-10T18:31:46.781-07:00,426,0,0,424,2,0,0,0,0,,,0,,,0,0.000065000,0,8.9.2,0,0,0,0,0,FALSE,45dc8ed8ab6a9425df79619f721c1ec2,2,751d00f34b24b0ea8de9c60d7810f621,1
"{""GlobalStats"":{""partitionsTotal"":436308,""partitionsAssigned"":436308,""bytesAssigned"":7511544545280},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_LIST_PRICE)) / (COUNT(STORE_SALES.SS_LIST_PRICE))"",""COUNT(STORE_SALES.SS_LIST_PRICE)"",""COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)"",""(SUM(STORE_SALES.SS_LIST_PRICE)) / (COUNT(STORE_SALES.SS_LIST_PRICE))"",""COUNT(STORE_SALES.SS_LIST_PRICE)"",""COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)"",""(SUM(STORE_SALES.SS_LIST_PRICE)) / (COUNT(STORE_SALES.SS_LIST_PRICE))"",""COUNT(STORE_SALES.SS_LIST_PRICE)"",""COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)"",""(SUM(STORE_SALES.SS_LIST_PRICE)) / (COUNT(STORE_SALES.SS_LIST_PRICE))"",""COUNT(STORE_SALES.SS_LIST_PRICE)"",""COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)"",""(SUM(STORE_SALES.SS_LIST_PRICE)) / (COUNT(STORE_SALES.SS_LIST_PRICE))"",""COUNT(STORE_SALES.SS_LIST_PRICE)"",""COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)"",""(SUM(STORE_SALES.SS_LIST_PRICE)) / (COUNT(STORE_SALES.SS_LIST_PRICE))"",""COUNT(STORE_SALES.SS_LIST_PRICE)"",""COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)""]},{""id"":1,""operation"":""Limit"",""expressions"":[""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""CartesianJoin"",""parentOperators"":[1]},{""id"":3,""operation"":""CartesianJoin"",""parentOperators"":[2]},{""id"":4,""operation"":""CartesianJoin"",""parentOperators"":[3]},{""id"":5,""operation"":""CartesianJoin"",""parentOperators"":[4]},{""id"":6,""operation"":""CartesianJoin"",""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_LIST_PRICE), COUNT(STORE_SALES.SS_LIST_PRICE), COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)]""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 26) AND (STORE_SALES.SS_QUANTITY <= 30) AND (((STORE_SALES.SS_LIST_PRICE >= 186) AND (STORE_SALES.SS_LIST_PRICE <= 196)) OR ((STORE_SALES.SS_COUPON_AMT >= 15083) AND (STORE_SALES.SS_COUPON_AMT <= 16083)) OR ((STORE_SALES.SS_WHOLESALE_COST >= 11) AND (STORE_SALES.SS_WHOLESALE_COST <= 31)))""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_WHOLESALE_COST"",""SS_LIST_PRICE"",""SS_COUPON_AMT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_LIST_PRICE), COUNT(STORE_SALES.SS_LIST_PRICE), COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)]""],""parentOperators"":[6]},{""id"":11,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 21) AND (STORE_SALES.SS_QUANTITY <= 25) AND (((STORE_SALES.SS_LIST_PRICE >= 121) AND (STORE_SALES.SS_LIST_PRICE <= 131)) OR ((STORE_SALES.SS_COUPON_AMT >= 9051) AND (STORE_SALES.SS_COUPON_AMT <= 10051)) OR ((STORE_SALES.SS_WHOLESALE_COST >= 12) AND (STORE_SALES.SS_WHOLESALE_COST <= 32)))""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_WHOLESALE_COST"",""SS_LIST_PRICE"",""SS_COUPON_AMT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_LIST_PRICE), COUNT(STORE_SALES.SS_LIST_PRICE), COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)]""],""parentOperators"":[5]},{""id"":14,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 16) AND (STORE_SALES.SS_QUANTITY <= 20) AND (((STORE_SALES.SS_LIST_PRICE >= 181) AND (STORE_SALES.SS_LIST_PRICE <= 191)) OR ((STORE_SALES.SS_COUPON_AMT >= 5477) AND (STORE_SALES.SS_COUPON_AMT <= 6477)) OR ((STORE_SALES.SS_WHOLESALE_COST >= 13) AND (STORE_SALES.SS_WHOLESALE_COST <= 33)))""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_WHOLESALE_COST"",""SS_LIST_PRICE"",""SS_COUPON_AMT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_LIST_PRICE), COUNT(STORE_SALES.SS_LIST_PRICE), COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)]""],""parentOperators"":[4]},{""id"":17,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 11) AND (STORE_SALES.SS_QUANTITY <= 15) AND (((STORE_SALES.SS_LIST_PRICE >= 140) AND (STORE_SALES.SS_LIST_PRICE <= 150)) OR ((STORE_SALES.SS_COUPON_AMT >= 11659) AND (STORE_SALES.SS_COUPON_AMT <= 12659)) OR ((STORE_SALES.SS_WHOLESALE_COST >= 28) AND (STORE_SALES.SS_WHOLESALE_COST <= 48)))""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_WHOLESALE_COST"",""SS_LIST_PRICE"",""SS_COUPON_AMT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[17]},{""id"":19,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_LIST_PRICE), COUNT(STORE_SALES.SS_LIST_PRICE), COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)]""],""parentOperators"":[3]},{""id"":20,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 6) AND (STORE_SALES.SS_QUANTITY <= 10) AND (((STORE_SALES.SS_LIST_PRICE >= 105) AND (STORE_SALES.SS_LIST_PRICE <= 115)) OR ((STORE_SALES.SS_COUPON_AMT >= 6852) AND (STORE_SALES.SS_COUPON_AMT <= 7852)) OR ((STORE_SALES.SS_WHOLESALE_COST >= 75) AND (STORE_SALES.SS_WHOLESALE_COST <= 95)))""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_WHOLESALE_COST"",""SS_LIST_PRICE"",""SS_COUPON_AMT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[20]},{""id"":22,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_LIST_PRICE), COUNT(STORE_SALES.SS_LIST_PRICE), COUNT(DISTINCT STORE_SALES.SS_LIST_PRICE)]""],""parentOperators"":[2]},{""id"":23,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 0) AND (STORE_SALES.SS_QUANTITY <= 5) AND (((STORE_SALES.SS_LIST_PRICE >= 127) AND (STORE_SALES.SS_LIST_PRICE <= 137)) OR ((STORE_SALES.SS_COUPON_AMT >= 6610) AND (STORE_SALES.SS_COUPON_AMT <= 7610)) OR ((STORE_SALES.SS_WHOLESALE_COST >= 27) AND (STORE_SALES.SS_WHOLESALE_COST <= 47)))""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_WHOLESALE_COST"",""SS_LIST_PRICE"",""SS_COUPON_AMT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[23]}]]}",01b2e7fb-0002-2fe3-0051-ba870002e046,"explain using json select /* { ""query"":""query28"",""streamId"":0,""querySequence"":36 } */  *
from (select avg(ss_list_price) B1_LP
            ,count(ss_list_price) B1_CNT
            ,count(distinct ss_list_price) B1_CNTD
      from store_sales
      where ss_quantity between 0 and 5
        and (ss_list_price between 127 and 127+10
             or ss_coupon_amt between 6610 and 6610+1000
             or ss_wholesale_cost between 27 and 27+20)) B1,
     (select avg(ss_list_price) B2_LP
            ,count(ss_list_price) B2_CNT
            ,count(distinct ss_list_price) B2_CNTD
      from store_sales
      where ss_quantity between 6 and 10
        and (ss_list_price between 105 and 105+10
          or ss_coupon_amt between 6852 and 6852+1000
          or ss_wholesale_cost between 75 and 75+20)) B2,
     (select avg(ss_list_price) B3_LP
            ,count(ss_list_price) B3_CNT
            ,count(distinct ss_list_price) B3_CNTD
      from store_sales
      where ss_quantity between 11 and 15
        and (ss_list_price between 140 and 140+10
          or ss_coupon_amt between 11659 and 11659+1000
          or ss_wholesale_cost between 28 and 28+20)) B3,
     (select avg(ss_list_price) B4_LP
            ,count(ss_list_price) B4_CNT
            ,count(distinct ss_list_price) B4_CNTD
      from store_sales
      where ss_quantity between 16 and 20
        and (ss_list_price between 181 and 181+10
          or ss_coupon_amt between 5477 and 5477+1000
          or ss_wholesale_cost between 13 and 13+20)) B4,
     (select avg(ss_list_price) B5_LP
            ,count(ss_list_price) B5_CNT
            ,count(distinct ss_list_price) B5_CNTD
      from store_sales
      where ss_quantity between 21 and 25
        and (ss_list_price between 121 and 121+10
          or ss_coupon_amt between 9051 and 9051+1000
          or ss_wholesale_cost between 12 and 12+20)) B5,
     (select avg(ss_list_price) B6_LP
            ,count(ss_list_price) B6_CNT
            ,count(distinct ss_list_price) B6_CNTD
      from store_sales
      where ss_quantity between 26 and 30
        and (ss_list_price between 186 and 186+10
          or ss_coupon_amt between 15083 and 15083+1000
          or ss_wholesale_cost between 11 and 11+20)) B6
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:45.307-07:00,2024-03-10T18:31:46.074-07:00,767,0,0,766,1,0,0,0,0,,,0,,,0,0.000117000,0,8.9.2,0,0,0,0,0,FALSE,923254098b99de69a5539df0a304825e,2,923254098b99de69a5539df0a304825e,1
"{""GlobalStats"":{""partitionsTotal"":155740,""partitionsAssigned"":155740,""bytesAssigned"":2639701907968},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER_DEMOGRAPHICS.CD_GENDER"",""CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS"",""CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS"",""COUNT(*)"",""CUSTOMER_DEMOGRAPHICS.CD_PURCHASE_ESTIMATE"",""COUNT(*)"",""CUSTOMER_DEMOGRAPHICS.CD_CREDIT_RATING"",""COUNT(*)"",""CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT"",""COUNT(*)"",""CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT"",""COUNT(*)"",""CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT"",""COUNT(*)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CUSTOMER_DEMOGRAPHICS.CD_GENDER ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_PURCHASE_ESTIMATE ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_CREDIT_RATING ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER_DEMOGRAPHICS.CD_GENDER, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS, CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS, CUSTOMER_DEMOGRAPHICS.CD_PURCHASE_ESTIMATE, CUSTOMER_DEMOGRAPHICS.CD_CREDIT_RATING, CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT_INTERNAL(*)(COUNT(*), COUNT(*))]"",""groupKeys: [CUSTOMER_DEMOGRAPHICS.CD_GENDER, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS, CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS, CUSTOMER_DEMOGRAPHICS.CD_PURCHASE_ESTIMATE, CUSTOMER_DEMOGRAPHICS.CD_CREDIT_RATING, CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CA.CA_ADDRESS_SK = C.C_CURRENT_ADDR_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CA.CA_ADDRESS_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""Filter"",""expressions"":[""CA.CA_COUNTY IN 'Lee County' IN 'Stafford County' IN 'Niagara County' IN 'Parmer County' IN 'Cherokee County'""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_COUNTY""],""alias"":""CA"",""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER_DEMOGRAPHICS.CD_GENDER, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS, CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS, CUSTOMER_DEMOGRAPHICS.CD_PURCHASE_ESTIMATE, CUSTOMER_DEMOGRAPHICS.CD_CREDIT_RATING, CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, C.C_CURRENT_ADDR_SK]""],""parentOperators"":[4]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = C.C_CURRENT_CDEMO_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_GENDER"",""CD_MARITAL_STATUS"",""CD_EDUCATION_STATUS"",""CD_PURCHASE_ESTIMATE"",""CD_CREDIT_RATING"",""CD_DEP_COUNT"",""CD_DEP_EMPLOYED_COUNT"",""CD_DEP_COLLEGE_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [C.C_CURRENT_ADDR_SK, C.C_CURRENT_CDEMO_SK]""],""parentOperators"":[9]},{""id"":12,""operation"":""SemiJoin"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [C.C_CUSTOMER_SK, C.C_CURRENT_CDEMO_SK, C.C_CURRENT_ADDR_SK]""],""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SHIP_CUSTOMER_SK IS NOT NULL) OR (WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL)""],""parentOperators"":[13]},{""id"":15,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (CATALOG_SALES.CS_SHIP_CUSTOMER_SK = C.C_CUSTOMER_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_SHIP_CUSTOMER_SK]""],""parentOperators"":[15]},{""id"":17,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_SHIP_CUSTOMER_SK]""],""parentOperators"":[16]},{""id"":18,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY <= 4)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[20]},{""id"":22,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_SHIP_CUSTOMER_SK, CATALOG_SALES.CS_SOLD_DATE_SK]""],""parentOperators"":[18]},{""id"":23,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SHIP_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[22]},{""id"":24,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[23]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_SHIP_CUSTOMER_SK""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[24]},{""id"":26,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (WEB_SALES.WS_BILL_CUSTOMER_SK = C.C_CUSTOMER_SK)""],""parentOperators"":[15]},{""id"":27,""operation"":""Aggregate"",""expressions"":[""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[26]},{""id"":28,""operation"":""Aggregate"",""expressions"":[""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[27]},{""id"":29,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[28]},{""id"":30,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[29]},{""id"":31,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY <= 4)""],""parentOperators"":[30]},{""id"":32,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[31]},{""id"":33,""operation"":""Aggregate"",""expressions"":[""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK, WEB_SALES.WS_SOLD_DATE_SK]""],""parentOperators"":[29]},{""id"":34,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[33]},{""id"":35,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[34]},{""id"":36,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_BILL_CUSTOMER_SK""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[35]},{""id"":37,""operation"":""Filter"",""expressions"":[""C.C_CURRENT_CDEMO_SK IS NOT NULL""],""parentOperators"":[26]},{""id"":38,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CA.CA_ADDRESS_SK = C.C_CURRENT_ADDR_SK)""],""parentOperators"":[37]},{""id"":39,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_CDEMO_SK"",""C_CURRENT_ADDR_SK""],""alias"":""C"",""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[38]},{""id"":40,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":41,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[40]},{""id"":42,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY <= 4)""],""parentOperators"":[41]},{""id"":43,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[42]},{""id"":44,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[40]},{""id"":45,""operation"":""JoinFilter"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[44]},{""id"":46,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[45]}]]}",01b2e7fb-0002-300b-0051-ba870002c082,"explain using json select /* { ""query"":""query10"",""streamId"":0,""querySequence"":26 } */
  cd_gender,
  cd_marital_status,
  cd_education_status,
  count(*) cnt1,
  cd_purchase_estimate,
  count(*) cnt2,
  cd_credit_rating,
  count(*) cnt3,
  cd_dep_count,
  count(*) cnt4,
  cd_dep_employed_count,
  count(*) cnt5,
  cd_dep_college_count,
  count(*) cnt6
 from
  customer c,customer_address ca,customer_demographics
 where
  c.c_current_addr_sk = ca.ca_address_sk and
  ca_county in ('Lee County','Stafford County','Niagara County','Parmer County','Cherokee County') and
  cd_demo_sk = c.c_current_cdemo_sk and
  exists (select *
          from store_sales,date_dim
          where c.c_customer_sk = ss_customer_sk and
                ss_sold_date_sk = d_date_sk and
                d_year = 1999 and
                d_moy between 1 and 1+3) and
   (exists (select *
            from web_sales,date_dim
            where c.c_customer_sk = ws_bill_customer_sk and
                  ws_sold_date_sk = d_date_sk and
                  d_year = 1999 and
                  d_moy between 1 ANd 1+3) or
    exists (select *
            from catalog_sales,date_dim
            where c.c_customer_sk = cs_ship_customer_sk and
                  cs_sold_date_sk = d_date_sk and
                  d_year = 1999 and
                  d_moy between 1 and 1+3))
 group by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating,
          cd_dep_count,
          cd_dep_employed_count,
          cd_dep_college_count
 order by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating,
          cd_dep_count,
          cd_dep_employed_count,
          cd_dep_college_count
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:33.142-07:00,2024-03-10T18:31:34.02-07:00,878,0,0,877,1,0,0,0,0,,,0,,,0,0.000134000,0,8.9.2,0,0,0,0,0,FALSE,ba8c73e59ac4cd6e808a6c6cb935a300,2,92f48871552490e6367f7fecb7813a99,1
"{""GlobalStats"":{""partitionsTotal"":14133,""partitionsAssigned"":14133,""bytesAssigned"":246536143360},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""SUM(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)))"",""(SCALED_ROUND_INT_DIVIDE(SCALED_ROUND_INT_DIVIDE(SUM(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY))), ((SUM(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)))) + (SUM(SUM(SUM(CATALOG_RETURNS.CR_RETURN_QUANTITY))))) + (SUM(SUM(SUM(WEB_RETURNS.WR_RETURN_QUANTITY))))), 3)) * 100"",""SUM(SUM(SUM(CATALOG_RETURNS.CR_RETURN_QUANTITY)))"",""(SCALED_ROUND_INT_DIVIDE(SCALED_ROUND_INT_DIVIDE(SUM(SUM(SUM(CATALOG_RETURNS.CR_RETURN_QUANTITY))), ((SUM(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)))) + (SUM(SUM(SUM(CATALOG_RETURNS.CR_RETURN_QUANTITY))))) + (SUM(SUM(SUM(WEB_RETURNS.WR_RETURN_QUANTITY))))), 3)) * 100"",""SUM(SUM(SUM(WEB_RETURNS.WR_RETURN_QUANTITY)))"",""(SCALED_ROUND_INT_DIVIDE(SCALED_ROUND_INT_DIVIDE(SUM(SUM(SUM(WEB_RETURNS.WR_RETURN_QUANTITY))), ((SUM(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)))) + (SUM(SUM(SUM(CATALOG_RETURNS.CR_RETURN_QUANTITY))))) + (SUM(SUM(SUM(WEB_RETURNS.WR_RETURN_QUANTITY))))), 3)) * 100"",""SCALED_ROUND_INT_DIVIDE(((SUM(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)))) + (SUM(SUM(SUM(CATALOG_RETURNS.CR_RETURN_QUANTITY))))) + (SUM(SUM(SUM(WEB_RETURNS.WR_RETURN_QUANTITY)))), 3)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [SR_ITEMS.ITEM_ID ASC NULLS LAST, SR_ITEMS.SR_ITEM_QTY ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WR_ITEMS.ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(WEB_RETURNS.WR_RETURN_QUANTITY)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(WEB_RETURNS.WR_RETURN_QUANTITY))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_RETURNS.WR_ITEM_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_RETURNS.WR_RETURN_QUANTITY)]"",""groupKeys: [WEB_RETURNS.WR_ITEM_SK]""],""parentOperators"":[6]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_RETURNS.WR_RETURNED_DATE_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE]""],""parentOperators"":[10]},{""id"":12,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_WEEK_SEQ = DATE_DIM.D_WEEK_SEQ)""],""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_WEEK_SEQ]""],""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_DATE IN '2001-05-15' IN '2001-08-10' IN '2001-11-07'""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE"",""D_WEEK_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[14]},{""id"":16,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_WEEK_SEQ = DATE_DIM.D_WEEK_SEQ)""],""parentOperators"":[12]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE"",""D_WEEK_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[16]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[10]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""WEB_RETURNS.WR_RETURNED_DATE_SK IS NOT NULL""],""parentOperators"":[9]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = WEB_RETURNS.WR_ITEM_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_RETURNS""],""expressions"":[""WR_RETURNED_DATE_SK"",""WR_ITEM_SK"",""WR_RETURN_QUANTITY""],""partitionsAssigned"":2289,""partitionsTotal"":2289,""bytesAssigned"":39149218304,""parentOperators"":[21]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(CATALOG_RETURNS.CR_RETURN_QUANTITY)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[3]},{""id"":24,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(CATALOG_RETURNS.CR_RETURN_QUANTITY))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[23]},{""id"":25,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_RETURNS.CR_ITEM_SK)""],""parentOperators"":[24]},{""id"":26,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WR_ITEMS.ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[25]},{""id"":27,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[26]},{""id"":28,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CATALOG_RETURNS.CR_RETURN_QUANTITY)]"",""groupKeys: [CATALOG_RETURNS.CR_ITEM_SK]""],""parentOperators"":[25]},{""id"":29,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_RETURNS.CR_RETURNED_DATE_SK)""],""parentOperators"":[28]},{""id"":30,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[29]},{""id"":31,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE]""],""parentOperators"":[30]},{""id"":32,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_WEEK_SEQ = DATE_DIM.D_WEEK_SEQ)""],""parentOperators"":[31]},{""id"":33,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_WEEK_SEQ]""],""parentOperators"":[32]},{""id"":34,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_DATE IN '2001-05-15' IN '2001-08-10' IN '2001-11-07'""],""parentOperators"":[33]},{""id"":35,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE"",""D_WEEK_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[34]},{""id"":36,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_WEEK_SEQ = DATE_DIM.D_WEEK_SEQ)""],""parentOperators"":[32]},{""id"":37,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE"",""D_WEEK_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[36]},{""id"":38,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[30]},{""id"":39,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[38]},{""id"":40,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_RETURNS.CR_ITEM_SK)""],""parentOperators"":[29]},{""id"":41,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_RETURNS""],""expressions"":[""CR_RETURNED_DATE_SK"",""CR_ITEM_SK"",""CR_RETURN_QUANTITY""],""partitionsAssigned"":4759,""partitionsTotal"":4759,""bytesAssigned"":82532796416,""parentOperators"":[40]},{""id"":42,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[2]},{""id"":43,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[42]},{""id"":44,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_RETURNS.SR_ITEM_SK)""],""parentOperators"":[43]},{""id"":45,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_ID = ITEM.I_ITEM_ID)""],""parentOperators"":[44]},{""id"":46,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[45]},{""id"":47,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_RETURNS.SR_RETURN_QUANTITY)]"",""groupKeys: [STORE_RETURNS.SR_ITEM_SK]""],""parentOperators"":[44]},{""id"":48,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_RETURNS.SR_RETURNED_DATE_SK)""],""parentOperators"":[47]},{""id"":49,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[48]},{""id"":50,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE]""],""parentOperators"":[49]},{""id"":51,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_WEEK_SEQ = DATE_DIM.D_WEEK_SEQ)""],""parentOperators"":[50]},{""id"":52,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_WEEK_SEQ]""],""parentOperators"":[51]},{""id"":53,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_DATE IN '2001-05-15' IN '2001-08-10' IN '2001-11-07'""],""parentOperators"":[52]},{""id"":54,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE"",""D_WEEK_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[53]},{""id"":55,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_WEEK_SEQ = DATE_DIM.D_WEEK_SEQ)""],""parentOperators"":[51]},{""id"":56,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE"",""D_WEEK_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[55]},{""id"":57,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE = DATE_DIM.D_DATE)""],""parentOperators"":[49]},{""id"":58,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[57]},{""id"":59,""operation"":""Filter"",""expressions"":[""STORE_RETURNS.SR_RETURNED_DATE_SK IS NOT NULL""],""parentOperators"":[48]},{""id"":60,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_RETURNS.SR_ITEM_SK)""],""parentOperators"":[59]},{""id"":61,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_RETURNED_DATE_SK"",""SR_ITEM_SK"",""SR_RETURN_QUANTITY""],""partitionsAssigned"":7070,""partitionsTotal"":7070,""bytesAssigned"":124763446272,""parentOperators"":[60]}]]}",01b2e7fe-0002-3000-0051-ba870002f06e,"explain using json with /* { ""query"":""query83"",""streamId"":0,""querySequence"":96 } */ sr_items as
 (select i_item_id item_id,
        sum(sr_return_quantity) sr_item_qty
 from store_returns,
      item,
      date_dim
 where sr_item_sk = i_item_sk
 and   d_date    in
	(select d_date
	from date_dim
	where d_week_seq in
		(select d_week_seq
		from date_dim
	  where d_date in ('2001-05-15','2001-08-10','2001-11-07')))
 and   sr_returned_date_sk   = d_date_sk
 group by i_item_id),
 cr_items as
 (select i_item_id item_id,
        sum(cr_return_quantity) cr_item_qty
 from catalog_returns,
      item,
      date_dim
 where cr_item_sk = i_item_sk
 and   d_date    in
	(select d_date
	from date_dim
	where d_week_seq in
		(select d_week_seq
		from date_dim
	  where d_date in ('2001-05-15','2001-08-10','2001-11-07')))
 and   cr_returned_date_sk   = d_date_sk
 group by i_item_id),
 wr_items as
 (select i_item_id item_id,
        sum(wr_return_quantity) wr_item_qty
 from web_returns,
      item,
      date_dim
 where wr_item_sk = i_item_sk
 and   d_date    in
	(select d_date
	from date_dim
	where d_week_seq in
		(select d_week_seq
		from date_dim
		where d_date in ('2001-05-15','2001-08-10','2001-11-07')))
 and   wr_returned_date_sk   = d_date_sk
 group by i_item_id)
  select  sr_items.item_id
       ,sr_item_qty
       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev
       ,cr_item_qty
       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev
       ,wr_item_qty
       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev
       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average
 from sr_items
     ,cr_items
     ,wr_items
 where sr_items.item_id=cr_items.item_id
   and sr_items.item_id=wr_items.item_id
 order by sr_items.item_id
         ,sr_item_qty
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:34:38.115-07:00,2024-03-10T18:34:38.883-07:00,768,0,0,766,2,0,0,0,0,,,0,,,0,0.000117000,0,8.9.2,0,0,0,0,0,FALSE,b7571520fb1a8d7a50b22b44343b6207,2,b7571520fb1a8d7a50b22b44343b6207,1
"{""GlobalStats"":{""partitionsTotal"":73494,""partitionsAssigned"":71188,""bytesAssigned"":1216512011264},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER.C_LAST_NAME"",""CUSTOMER.C_FIRST_NAME"",""CURRENT_ADDR.CA_CITY"",""CUSTOMER_ADDRESS.CA_CITY"",""STORE_SALES.SS_TICKET_NUMBER"",""SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), COUNT(*)))"",""SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_TAX))), COUNT(*)))"",""SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_LIST_PRICE))), COUNT(*)))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CUSTOMER.C_LAST_NAME ASC NULLS LAST, DN.SS_TICKET_NUMBER ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)"",""joinFilter: CURRENT_ADDR.CA_CITY <> CUSTOMER_ADDRESS.CA_CITY""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CURRENT_ADDR.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_CITY""],""alias"":""CURRENT_ADDR"",""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[3]},{""id"":5,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CURRENT_ADDR.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[3]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_ADDR_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_LIST_PRICE))), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_TAX))), COUNT(*)))]"",""groupKeys: [STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ADDR_SK, CUSTOMER_ADDRESS.CA_CITY]""],""parentOperators"":[2]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), COUNT(*)), SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_LIST_PRICE))), COUNT(*)), SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_TAX))), COUNT(*))]"",""groupKeys: [STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ADDR_SK, CUSTOMER_ADDRESS.CA_CITY]""],""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE.S_STORE_SK]""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""STORE.S_CITY IN 'Forest Hills' IN 'Dayton'""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_CITY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), SUM(SUM(SUM(STORE_SALES.SS_EXT_LIST_PRICE))), SUM(SUM(SUM(STORE_SALES.SS_EXT_TAX)))]"",""groupKeys: [CUSTOMER_ADDRESS.CA_CITY, STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ADDR_SK, STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[9]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""(HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0) OR (HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT = -1)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT"",""HD_VEHICLE_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[15]},{""id"":17,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)), SUM(SUM(STORE_SALES.SS_EXT_LIST_PRICE)), SUM(SUM(STORE_SALES.SS_EXT_TAX))]"",""groupKeys: [CUSTOMER_ADDRESS.CA_CITY, STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ADDR_SK, STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[14]},{""id"":18,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = STORE_SALES.SS_ADDR_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_CITY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[18]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(STORE_SALES.SS_EXT_LIST_PRICE), SUM(STORE_SALES.SS_EXT_TAX)]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ADDR_SK, STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[18]},{""id"":21,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DOM <= 2) AND (DATE_DIM.D_YEAR IN 2000 IN 2001 IN 2002)""],""parentOperators"":[21]},{""id"":23,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_DOM""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[22]},{""id"":24,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_ADDR_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[21]},{""id"":25,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)"",""joinFilter: CURRENT_ADDR.CA_CITY <> CUSTOMER_ADDRESS.CA_CITY""],""parentOperators"":[24]},{""id"":26,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_HDEMO_SK"",""SS_ADDR_SK"",""SS_STORE_SK"",""SS_TICKET_NUMBER"",""SS_EXT_SALES_PRICE"",""SS_EXT_LIST_PRICE"",""SS_EXT_TAX""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[25]}]]}",01b2e7fe-0002-2e24-0051-ba870001d21a,"explain using json select /* { ""query"":""query68"",""streamId"":0,""querySequence"":95 } */  c_last_name
       ,c_first_name
       ,ca_city
       ,bought_city
       ,ss_ticket_number
       ,extended_price
       ,extended_tax
       ,list_price
 from (select ss_ticket_number
             ,ss_customer_sk
             ,ca_city bought_city
             ,sum(ss_ext_sales_price) extended_price
             ,sum(ss_ext_list_price) list_price
             ,sum(ss_ext_tax) extended_tax
       from store_sales
           ,date_dim
           ,store
           ,household_demographics
           ,customer_address
       where store_sales.ss_sold_date_sk = date_dim.d_date_sk
         and store_sales.ss_store_sk = store.s_store_sk
        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
        and store_sales.ss_addr_sk = customer_address.ca_address_sk
        and date_dim.d_dom between 1 and 2
        and (household_demographics.hd_dep_count = 0 or
             household_demographics.hd_vehicle_count= -1)
        and date_dim.d_year in (2000,2000+1,2000+2)
        and store.s_city in ('Forest Hills','Dayton')
       group by ss_ticket_number
               ,ss_customer_sk
               ,ss_addr_sk,ca_city) dn
      ,customer
      ,customer_address current_addr
 where ss_customer_sk = c_customer_sk
   and customer.c_current_addr_sk = current_addr.ca_address_sk
   and current_addr.ca_city <> bought_city
 order by c_last_name
         ,ss_ticket_number
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:34:37.364-07:00,2024-03-10T18:34:37.73-07:00,366,0,0,365,1,0,0,0,0,,,0,,,0,0.000056000,0,8.9.2,0,0,0,0,0,FALSE,47356cfde2035f17c7948541b5f986c0,2,0b8f78b93f26aae06892a23927118830,1
"{""GlobalStats"":{""partitionsTotal"":72722,""partitionsAssigned"":70416,""bytesAssigned"":1212654344192},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_MANUFACT_ID"",""SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))"",""AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANUFACT_ID)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [TMP1.AVG_QUARTERLY_SALES ASC NULLS LAST, TMP1.SUM_SALES ASC NULLS LAST, TMP1.I_MANUFACT_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(IFF(AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANUFACT_ID) > 0, SCALED_ROUND_INT_DIVIDE(ABS((SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) - AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANUFACT_ID)), AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANUFACT_ID)), null)) > 0.1""],""parentOperators"":[1]},{""id"":3,""operation"":""WindowFunction"",""expressions"":[""AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANUFACT_ID)""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))]"",""groupKeys: [ITEM.I_MANUFACT_ID, DATE_DIM.D_QOY]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*))))]"",""groupKeys: [ITEM.I_MANUFACT_ID, DATE_DIM.D_QOY]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_MONTH_SEQ IN 1179 IN 1180 IN 1181 IN 1182 IN 1183 IN 1184 IN 1185 IN 1186 IN 1187 IN 1188 IN 1189 IN 1190""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))]"",""groupKeys: [ITEM.I_MANUFACT_ID, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[6]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*))]"",""groupKeys: [ITEM.I_MANUFACT_ID, STORE_SALES.SS_SOLD_DATE_SK, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[10]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_MANUFACT_ID]""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""((ITEM.I_CATEGORY IN 'Books' IN 'Children' IN 'Electronics') OR (ITEM.I_CATEGORY IN 'Women' IN 'Music' IN 'Men')) AND ((ITEM.I_CLASS IN 'personal' IN 'portable' IN 'reference' IN 'self-help') OR (ITEM.I_CLASS IN 'accessories' IN 'classical' IN 'fragrances' IN 'pants')) AND ((ITEM.I_BRAND IN 'scholaramalgamalg #14' IN 'scholaramalgamalg #7' IN 'exportiunivamalg #9' IN 'scholaramalgamalg #9') OR (ITEM.I_BRAND IN 'amalgimporto #1' IN 'edu packscholar #1' IN 'exportiimporto #1' IN 'importoamalg #1')) AND (((ITEM.I_CATEGORY IN 'Books' IN 'Children' IN 'Electronics') AND (ITEM.I_CLASS IN 'personal' IN 'portable' IN 'reference' IN 'self-help') AND (ITEM.I_BRAND IN 'scholaramalgamalg #14' IN 'scholaramalgamalg #7' IN 'exportiunivamalg #9' IN 'scholaramalgamalg #9')) OR ((ITEM.I_CATEGORY IN 'Women' IN 'Music' IN 'Men') AND (ITEM.I_CLASS IN 'accessories' IN 'classical' IN 'fragrances' IN 'pants') AND (ITEM.I_BRAND IN 'amalgimporto #1' IN 'edu packscholar #1' IN 'exportiimporto #1' IN 'importo...""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND"",""I_CLASS"",""I_CATEGORY"",""I_MANUFACT_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[13]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_STORE_SK"",""SS_SALES_PRICE""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[18]}]]}",01b2e7fd-0002-2f99-0051-ba87000281ca,"explain using json select /* { ""query"":""query53"",""streamId"":0,""querySequence"":88 } */  * from
(select i_manufact_id,
sum(ss_sales_price) sum_sales,
avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales
from item, store_sales, date_dim, store
where ss_item_sk = i_item_sk and
ss_sold_date_sk = d_date_sk and
ss_store_sk = s_store_sk and
d_month_seq in (1179,1179+1,1179+2,1179+3,1179+4,1179+5,1179+6,1179+7,1179+8,1179+9,1179+10,1179+11) and
((i_category in ('Books','Children','Electronics') and
i_class in ('personal','portable','reference','self-help') and
i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',
		'exportiunivamalg #9','scholaramalgamalg #9'))
or(i_category in ('Women','Music','Men') and
i_class in ('accessories','classical','fragrances','pants') and
i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',
		'importoamalg #1')))
group by i_manufact_id, d_qoy ) tmp1
where case when avg_quarterly_sales > 0
	then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales
	else null end > 0.1
order by avg_quarterly_sales,
	 sum_sales,
	 i_manufact_id
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:34.314-07:00,2024-03-10T18:33:35.401-07:00,1087,0,0,1085,2,0,0,0,0,,,0,,,0,0.000166000,0,8.9.2,0,0,0,0,0,FALSE,5fe31009dc92b2679b6251516ed3ee3f,2,1bac9dc9f6a702f441741ede81ef8447,1
"{""GlobalStats"":{""partitionsTotal"":59969,""partitionsAssigned"":59969,""bytesAssigned"":1009846816256},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_DESC"",""WAREHOUSE.W_WAREHOUSE_NAME"",""D1.D_WEEK_SEQ"",""SUM(SUM(SUM(IFF(PROMOTION.P_PROMO_SK IS NULL, 1, 0))))"",""SUM(SUM(SUM(IFF(PROMOTION.P_PROMO_SK IS NOT NULL, 1, 0))))"",""COUNT(*)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [COUNT(*) DESC NULLS FIRST, ITEM.I_ITEM_DESC ASC NULLS LAST, WAREHOUSE.W_WAREHOUSE_NAME ASC NULLS LAST, D1.D_WEEK_SEQ ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(IFF(PROMOTION.P_PROMO_SK IS NULL, 1, 0)))), SUM(SUM(SUM(IFF(PROMOTION.P_PROMO_SK IS NOT NULL, 1, 0)))), COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_DESC, WAREHOUSE.W_WAREHOUSE_NAME, D1.D_WEEK_SEQ]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(IFF(PROMOTION.P_PROMO_SK IS NULL, 1, 0))), SUM(SUM(IFF(PROMOTION.P_PROMO_SK IS NOT NULL, 1, 0))), COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_DESC, WAREHOUSE.W_WAREHOUSE_NAME, D1.D_WEEK_SEQ]""],""parentOperators"":[2]},{""id"":4,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (CATALOG_SALES.CS_ITEM_SK = CATALOG_RETURNS.CR_ITEM_SK) AND (CATALOG_SALES.CS_ORDER_NUMBER = CATALOG_RETURNS.CR_ORDER_NUMBER)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFF(PROMOTION.P_PROMO_SK IS NULL, 1, 0)), SUM(IFF(PROMOTION.P_PROMO_SK IS NOT NULL, 1, 0)), COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_DESC, WAREHOUSE.W_WAREHOUSE_NAME, D1.D_WEEK_SEQ, CATALOG_SALES.CS_ITEM_SK, CATALOG_SALES.CS_ORDER_NUMBER]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_DESC""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[6]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = CATALOG_SALES.CS_BILL_CDEMO_SK)""],""parentOperators"":[6]},{""id"":9,""operation"":""Filter"",""expressions"":[""CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS = 'D'""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_MARITAL_STATUS""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[9]},{""id"":11,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (PROMOTION.P_PROMO_SK = CATALOG_SALES.CS_PROMO_SK)""],""parentOperators"":[8]},{""id"":12,""operation"":""Filter"",""expressions"":[""PROMOTION.P_PROMO_SK IS NOT NULL""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.PROMOTION""],""expressions"":[""P_PROMO_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":85504,""parentOperators"":[12]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WAREHOUSE.W_WAREHOUSE_SK = INVENTORY.INV_WAREHOUSE_SK)""],""parentOperators"":[11]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WAREHOUSE""],""expressions"":[""W_WAREHOUSE_SK"",""W_WAREHOUSE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7168,""parentOperators"":[14]},{""id"":16,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CATALOG_SALES.CS_ITEM_SK = INVENTORY.INV_ITEM_SK) AND (D2.D_DATE_SK = INVENTORY.INV_DATE_SK)"",""joinFilter: INVENTORY.INV_QUANTITY_ON_HAND < (CATALOG_SALES.CS_QUANTITY)""],""parentOperators"":[14]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D2.D_WEEK_SEQ = D1.D_WEEK_SEQ)""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_WEEK_SEQ""],""alias"":""D2"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[17]},{""id"":19,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = CATALOG_SALES.CS_BILL_HDEMO_SK)""],""parentOperators"":[17]},{""id"":20,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '1001-5000'""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_BUY_POTENTIAL""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[20]},{""id"":22,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D3.D_DATE_SK = CATALOG_SALES.CS_SHIP_DATE_SK)"",""joinFilter: D3.D_DATE > (DATE_ADDDAYSTODATE(5, D1.D_DATE))""],""parentOperators"":[19]},{""id"":23,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""alias"":""D3"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[22]},{""id"":24,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D1.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[22]},{""id"":25,""operation"":""Filter"",""expressions"":[""D1.D_YEAR = 1998""],""parentOperators"":[24]},{""id"":26,""operation"":""JoinFilter"",""expressions"":[""joinKey: (D2.D_WEEK_SEQ = D1.D_WEEK_SEQ)""],""parentOperators"":[25]},{""id"":27,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_WEEK_SEQ"",""D_YEAR""],""alias"":""D1"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[26]},{""id"":28,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CDEMO_SK IS NOT NULL) AND (CATALOG_SALES.CS_SHIP_DATE_SK IS NOT NULL) AND (CATALOG_SALES.CS_BILL_HDEMO_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[24]},{""id"":29,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_SHIP_DATE_SK"",""CS_BILL_CDEMO_SK"",""CS_BILL_HDEMO_SK"",""CS_ITEM_SK"",""CS_PROMO_SK"",""CS_ORDER_NUMBER"",""CS_QUANTITY""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[29]},{""id"":31,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[16]},{""id"":32,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.INVENTORY""],""expressions"":[""INV_DATE_SK"",""INV_ITEM_SK"",""INV_WAREHOUSE_SK"",""INV_QUANTITY_ON_HAND""],""partitionsAssigned"":279,""partitionsTotal"":279,""bytesAssigned"":3658746880,""parentOperators"":[31]},{""id"":33,""operation"":""Filter"",""expressions"":[""(CATALOG_RETURNS.CR_ITEM_SK IS NOT NULL) AND (CATALOG_RETURNS.CR_ORDER_NUMBER IS NOT NULL)""],""parentOperators"":[4]},{""id"":34,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CATALOG_SALES.CS_ITEM_SK = CATALOG_RETURNS.CR_ITEM_SK) AND (CATALOG_SALES.CS_ORDER_NUMBER = CATALOG_RETURNS.CR_ORDER_NUMBER)""],""parentOperators"":[33]},{""id"":35,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_RETURNS""],""expressions"":[""CR_ITEM_SK"",""CR_ORDER_NUMBER""],""partitionsAssigned"":4759,""partitionsTotal"":4759,""bytesAssigned"":82532796416,""parentOperators"":[34]}]]}",01b2e7fd-0002-2d83-0051-ba87000251ee,"explain using json select /* { ""query"":""query72"",""streamId"":0,""querySequence"":87 } */  i_item_desc
      ,w_warehouse_name
      ,d1.d_week_seq
      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo
      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo
      ,count(*) total_cnt
from catalog_sales
join inventory on (cs_item_sk = inv_item_sk)
join warehouse on (w_warehouse_sk=inv_warehouse_sk)
join item on (i_item_sk = cs_item_sk)
join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)
join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)
join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)
join date_dim d2 on (inv_date_sk = d2.d_date_sk)
join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)
left outer join promotion on (cs_promo_sk=p_promo_sk)
left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)
where d1.d_week_seq = d2.d_week_seq
  and inv_quantity_on_hand < cs_quantity
  and d3.d_date > d1.d_date + 5
  and hd_buy_potential = '1001-5000'
  and d1.d_year = 1998
  and cd_marital_status = 'D'
group by i_item_desc,w_warehouse_name,d1.d_week_seq
order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:32.878-07:00,2024-03-10T18:33:33.847-07:00,969,0,0,967,2,0,0,0,0,,,0,,,0,0.000148000,0,8.9.2,0,0,0,0,0,FALSE,9bf1751660250a078c6c0a07f6798dd8,2,5bf9b16ea9853af741d904028455b16f,1
"{""GlobalStats"":{""partitionsTotal"":100821,""partitionsAssigned"":100821,""bytesAssigned"":1717626931200},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""T_S_SECYEAR.CUSTOMER_ID"",""T_S_SECYEAR.CUSTOMER_FIRST_NAME"",""T_S_SECYEAR.CUSTOMER_LAST_NAME""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [T_S_SECYEAR.CUSTOMER_ID ASC NULLS LAST, T_S_SECYEAR.CUSTOMER_LAST_NAME ASC NULLS LAST, T_S_SECYEAR.CUSTOMER_FIRST_NAME ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_W_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_W_FIRSTYEAR.YEAR_TOTAL > 0, (T_W_SECYEAR.YEAR_TOTAL) / (T_W_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, (T_S_SECYEAR.YEAR_TOTAL) / (T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[1]},{""id"":3,""operation"":""WithReference"",""expressions"":[""T_W_SECYEAR""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'w')) = 'w') AND (T_W_SECYEAR.YEAR = 2002)""],""parentOperators"":[3]},{""id"":5,""operation"":""WithClause"",""expressions"":[""YEAR_TOTAL""],""parentOperators"":[4,38,42,45]},{""id"":6,""operation"":""UnionAll"",""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(MAX(MAX(MAX(STORE_SALES.SS_NET_PAID))))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, DATE_DIM.D_YEAR]""],""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(MAX(MAX(STORE_SALES.SS_NET_PAID)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, DATE_DIM.D_YEAR]""],""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME]""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CUSTOMER_ID"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(MAX(STORE_SALES.SS_NET_PAID))]"",""groupKeys: [DATE_DIM.D_YEAR, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[9]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK, DATE_DIM.D_YEAR]""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 2001 IN 2002""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[15]},{""id"":17,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(STORE_SALES.SS_NET_PAID)]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[13]},{""id"":18,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[17]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_NET_PAID""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[19]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(MAX(MAX(MAX(WEB_SALES.WS_NET_PAID))))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, DATE_DIM.D_YEAR]""],""parentOperators"":[6]},{""id"":22,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(MAX(MAX(WEB_SALES.WS_NET_PAID)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, DATE_DIM.D_YEAR]""],""parentOperators"":[21]},{""id"":23,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[22]},{""id"":24,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME]""],""parentOperators"":[23]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CUSTOMER_ID"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[24]},{""id"":26,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(MAX(WEB_SALES.WS_NET_PAID))]"",""groupKeys: [DATE_DIM.D_YEAR, WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[23]},{""id"":27,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[26]},{""id"":28,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK, DATE_DIM.D_YEAR]""],""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 2001 IN 2002""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[29]},{""id"":31,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(WEB_SALES.WS_NET_PAID)]"",""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK, WEB_SALES.WS_SOLD_DATE_SK]""],""parentOperators"":[27]},{""id"":32,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[31]},{""id"":33,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[32]},{""id"":34,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_BILL_CUSTOMER_SK"",""WS_NET_PAID""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[33]},{""id"":35,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)""],""parentOperators"":[2]},{""id"":36,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_W_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_W_FIRSTYEAR.YEAR_TOTAL > 0, (T_W_SECYEAR.YEAR_TOTAL) / (T_W_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, (T_S_SECYEAR.YEAR_TOTAL) / (T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[35]},{""id"":37,""operation"":""WithReference"",""expressions"":[""T_S_SECYEAR""],""parentOperators"":[36]},{""id"":38,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'w')) = 's') AND (T_S_SECYEAR.YEAR = 2002)""],""parentOperators"":[37]},{""id"":39,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_W_FIRSTYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)""],""parentOperators"":[35]},{""id"":40,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_W_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_W_FIRSTYEAR.YEAR_TOTAL > 0, (T_W_SECYEAR.YEAR_TOTAL) / (T_W_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, (T_S_SECYEAR.YEAR_TOTAL) / (T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[39]},{""id"":41,""operation"":""WithReference"",""expressions"":[""T_W_FIRSTYEAR""],""parentOperators"":[40]},{""id"":42,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'w')) = 'w') AND (T_W_FIRSTYEAR.YEAR = 2001) AND (T_W_FIRSTYEAR.YEAR_TOTAL > 0)""],""parentOperators"":[41]},{""id"":43,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_W_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_W_FIRSTYEAR.YEAR_TOTAL > 0, (T_W_SECYEAR.YEAR_TOTAL) / (T_W_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, (T_S_SECYEAR.YEAR_TOTAL) / (T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[39]},{""id"":44,""operation"":""WithReference"",""expressions"":[""T_S_FIRSTYEAR""],""parentOperators"":[43]},{""id"":45,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'w')) = 's') AND (T_S_FIRSTYEAR.YEAR = 2001) AND (T_S_FIRSTYEAR.YEAR_TOTAL > 0)""],""parentOperators"":[44]}]]}",01b2e7fd-0002-2f99-0051-ba87000281ba,"explain using json with /* { ""query"":""query74"",""streamId"":0,""querySequence"":76 } */ year_total as (
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,d_year as year
       ,max(ss_net_paid) year_total
       ,'s' sale_type
 from customer
     ,store_sales
     ,date_dim
 where c_customer_sk = ss_customer_sk
   and ss_sold_date_sk = d_date_sk
   and d_year in (2001,2001+1)
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,d_year
 union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,d_year as year
       ,max(ws_net_paid) year_total
       ,'w' sale_type
 from customer
     ,web_sales
     ,date_dim
 where c_customer_sk = ws_bill_customer_sk
   and ws_sold_date_sk = d_date_sk
   and d_year in (2001,2001+1)
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,d_year
         )
  select
        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name
 from year_total t_s_firstyear
     ,year_total t_s_secyear
     ,year_total t_w_firstyear
     ,year_total t_w_secyear
 where t_s_secyear.customer_id = t_s_firstyear.customer_id
         and t_s_firstyear.customer_id = t_w_secyear.customer_id
         and t_s_firstyear.customer_id = t_w_firstyear.customer_id
         and t_s_firstyear.sale_type = 's'
         and t_w_firstyear.sale_type = 'w'
         and t_s_secyear.sale_type = 's'
         and t_w_secyear.sale_type = 'w'
         and t_s_firstyear.year = 2001
         and t_s_secyear.year = 2001+1
         and t_w_firstyear.year = 2001
         and t_w_secyear.year = 2001+1
         and t_s_firstyear.year_total > 0
         and t_w_firstyear.year_total > 0
         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end
           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end
 order by 1,3,2
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:20.762-07:00,2024-03-10T18:33:21.29-07:00,528,0,0,527,1,0,0,0,0,,,0,,,0,0.000081000,0,8.9.2,0,0,0,0,0,FALSE,99a9ce6aecfa48d544749c03d0f74a69,2,e5c9ba90b114d02eaf074cb943a51311,1
"{""GlobalStats"":{""partitionsTotal"":145441,""partitionsAssigned"":145441,""bytesAssigned"":2503876406272},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""STORE.S_STORE_NAME"",""ITEM.I_ITEM_DESC"",""SUM(STORE_SALES.SS_SALES_PRICE)"",""ITEM.I_CURRENT_PRICE"",""ITEM.I_WHOLESALE_COST"",""ITEM.I_BRAND""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [STORE.S_STORE_NAME ASC NULLS LAST, ITEM.I_ITEM_DESC ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_DESC"",""I_CURRENT_PRICE"",""I_WHOLESALE_COST"",""I_BRAND""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_SALES.SS_STORE_SK = STORE_SALES.SS_STORE_SK)"",""joinFilter: (SUM(STORE_SALES.SS_SALES_PRICE)) <= (0.1 * ((SUM(SUM(STORE_SALES.SS_SALES_PRICE))) / (COUNT(SUM(STORE_SALES.SS_SALES_PRICE)))))""],""parentOperators"":[2]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_SALES_PRICE)), COUNT(SUM(STORE_SALES.SS_SALES_PRICE))]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_SALES_PRICE)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[6]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1201) AND (DATE_DIM.D_MONTH_SEQ <= 1212)""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[8]},{""id"":12,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_STORE_SK"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[12]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK)""],""parentOperators"":[5]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_SALES_PRICE)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[4]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1201) AND (DATE_DIM.D_MONTH_SEQ <= 1212)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[17]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_STORE_SK"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[21]}]]}",01b2e7fd-0002-300b-0051-ba870002c0c2,"explain using json select /* { ""query"":""query65"",""streamId"":0,""querySequence"":71 } */
	s_store_name,
	i_item_desc,
	sc.revenue,
	i_current_price,
	i_wholesale_cost,
	i_brand
 from store, item,
     (select ss_store_sk, avg(revenue) as ave
 	from
 	    (select  ss_store_sk, ss_item_sk,
 		     sum(ss_sales_price) as revenue
 		from store_sales, date_dim
 		where ss_sold_date_sk = d_date_sk and d_month_seq between 1201 and 1201+11
 		group by ss_store_sk, ss_item_sk) sa
 	group by ss_store_sk) sb,
     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue
 	from store_sales, date_dim
 	where ss_sold_date_sk = d_date_sk and d_month_seq between 1201 and 1201+11
 	group by ss_store_sk, ss_item_sk) sc
 where sb.ss_store_sk = sc.ss_store_sk and
       sc.revenue <= 0.1 * sb.ave and
       s_store_sk = sc.ss_store_sk and
       i_item_sk = sc.ss_item_sk
 order by s_store_name, i_item_desc
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:15.26-07:00,2024-03-10T18:33:15.635-07:00,375,0,0,374,1,0,0,0,0,,,0,,,0,0.000057000,0,8.9.2,0,0,0,0,0,FALSE,879a3b11d6f6cf687292f47111ea4e1e,2,879a3b11d6f6cf687292f47111ea4e1e,1
"{""GlobalStats"":{""partitionsTotal"":155225,""partitionsAssigned"":155225,""bytesAssigned"":2636614404096},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_BRAND_ID"",""ITEM.I_BRAND"",""TIME_DIM.T_HOUR"",""TIME_DIM.T_MINUTE"",""SUM(SUM_INTERNAL(SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE, STORE_SALES.SS_EXT_SALES_PRICE)), COUNT(*)))""]},{""id"":1,""operation"":""Sort"",""expressions"":[""SUM(SUM_INTERNAL(SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE, STORE_SALES.SS_EXT_SALES_PRICE)), COUNT(*))) DESC NULLS FIRST"",""ITEM.I_BRAND_ID ASC NULLS LAST""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE, STORE_SALES.SS_EXT_SALES_PRICE)), COUNT(*)))]"",""groupKeys: [ITEM.I_BRAND, ITEM.I_BRAND_ID, TIME_DIM.T_HOUR, TIME_DIM.T_MINUTE]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE, STORE_SALES.SS_EXT_SALES_PRICE)), COUNT(*))]"",""groupKeys: [ITEM.I_BRAND, ITEM.I_BRAND_ID, TIME_DIM.T_HOUR, TIME_DIM.T_MINUTE]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = UNION_ALL(WEB_SALES.WS_SOLD_TIME_SK, CATALOG_SALES.CS_SOLD_TIME_SK, STORE_SALES.SS_SOLD_TIME_SK))""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [TIME_DIM.T_TIME_SK, TIME_DIM.T_HOUR, TIME_DIM.T_MINUTE]""],""parentOperators"":[4]},{""id"":6,""operation"":""Filter"",""expressions"":[""TIME_DIM.T_MEAL_TIME IN 'breakfast' IN 'dinner'""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR"",""T_MINUTE"",""T_MEAL_TIME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE, STORE_SALES.SS_EXT_SALES_PRICE))]"",""groupKeys: [ITEM.I_BRAND_ID, ITEM.I_BRAND, UNION_ALL(WEB_SALES.WS_SOLD_TIME_SK, CATALOG_SALES.CS_SOLD_TIME_SK, STORE_SALES.SS_SOLD_TIME_SK)]""],""parentOperators"":[4]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = UNION_ALL(WEB_SALES.WS_ITEM_SK, CATALOG_SALES.CS_ITEM_SK, STORE_SALES.SS_ITEM_SK))""],""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""ITEM.I_MANAGER_ID = 1""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND_ID"",""I_BRAND"",""I_MANAGER_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[10]},{""id"":12,""operation"":""UnionAll"",""parentOperators"":[9]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MOY = 11) AND (DATE_DIM.D_YEAR = 1998)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_SOLD_TIME_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[13]},{""id"":17,""operation"":""JoinFilter"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = UNION_ALL(WEB_SALES.WS_SOLD_TIME_SK, CATALOG_SALES.CS_SOLD_TIME_SK, STORE_SALES.SS_SOLD_TIME_SK))""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_SOLD_TIME_SK"",""WS_ITEM_SK"",""WS_EXT_SALES_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[17]},{""id"":19,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":20,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MOY = 11) AND (DATE_DIM.D_YEAR = 1998)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[20]},{""id"":22,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SOLD_TIME_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[19]},{""id"":23,""operation"":""JoinFilter"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = UNION_ALL(WEB_SALES.WS_SOLD_TIME_SK, CATALOG_SALES.CS_SOLD_TIME_SK, STORE_SALES.SS_SOLD_TIME_SK))""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_SOLD_TIME_SK"",""CS_ITEM_SK"",""CS_EXT_SALES_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[23]},{""id"":25,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":26,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MOY = 11) AND (DATE_DIM.D_YEAR = 1998)""],""parentOperators"":[25]},{""id"":27,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[26]},{""id"":28,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_TIME_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[25]},{""id"":29,""operation"":""JoinFilter"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = UNION_ALL(WEB_SALES.WS_SOLD_TIME_SK, CATALOG_SALES.CS_SOLD_TIME_SK, STORE_SALES.SS_SOLD_TIME_SK))""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_SOLD_TIME_SK"",""SS_ITEM_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[29]}]]}",01b2e7fd-0002-2f4b-0051-ba870002618a,"explain using json select /* { ""query"":""query71"",""streamId"":0,""querySequence"":72 } */ i_brand_id brand_id, i_brand brand,t_hour,t_minute,
 	sum(ext_price) ext_price
 from item, (select ws_ext_sales_price as ext_price,
                        ws_sold_date_sk as sold_date_sk,
                        ws_item_sk as sold_item_sk,
                        ws_sold_time_sk as time_sk
                 from web_sales,date_dim
                 where d_date_sk = ws_sold_date_sk
                   and d_moy=11
                   and d_year=1998
                 union all
                 select cs_ext_sales_price as ext_price,
                        cs_sold_date_sk as sold_date_sk,
                        cs_item_sk as sold_item_sk,
                        cs_sold_time_sk as time_sk
                 from catalog_sales,date_dim
                 where d_date_sk = cs_sold_date_sk
                   and d_moy=11
                   and d_year=1998
                 union all
                 select ss_ext_sales_price as ext_price,
                        ss_sold_date_sk as sold_date_sk,
                        ss_item_sk as sold_item_sk,
                        ss_sold_time_sk as time_sk
                 from store_sales,date_dim
                 where d_date_sk = ss_sold_date_sk
                   and d_moy=11
                   and d_year=1998
                 ) tmp,time_dim
 where
   sold_item_sk = i_item_sk
   and i_manager_id=1
   and time_sk = t_time_sk
   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')
 group by i_brand, i_brand_id,t_hour,t_minute
 order by ext_price desc, i_brand_id
 ;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:16.305-07:00,2024-03-10T18:33:17.274-07:00,969,0,0,968,1,0,0,0,0,,,0,,,0,0.000148000,0,8.9.2,0,0,0,0,0,FALSE,0848ef9c4f1a5db7814edcb85e76398b,2,9727470b8faeb6ffc386c6b886d2cd72,1
"{""GlobalStats"":{""partitionsTotal"":301183,""partitionsAssigned"":301183,""bytesAssigned"":5145120677376},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""MAX(SUM(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE)))))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE)))]""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE))))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE))]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[4]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 1999 IN 2000 IN 2001 IN 2002""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[7]},{""id"":11,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_QUANTITY"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[11]}],[{""id"":0,""operation"":""Result"",""expressions"":[""SUM(UNION_ALL((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE), (WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE)))""]},{""id"":1,""operation"":""Limit"",""expressions"":[""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(UNION_ALL((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_LIST_PRICE), (WEB_SALES.WS_QUANTITY) * (WEB_SALES.WS_LIST_PRICE)))]""],""parentOperators"":[1]},{""id"":3,""operation"":""UnionAll"",""parentOperators"":[2]},{""id"":4,""operation"":""SemiJoin"",""expressions"":[""joinKey: (BEST_SS_CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""groupKeys: [BEST_SS_CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""WithReference"",""parentOperators"":[5]},{""id"":7,""operation"":""WithClause"",""expressions"":[""BEST_SS_CUSTOMER""],""parentOperators"":[6,40]},{""id"":8,""operation"":""Filter"",""expressions"":[""(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE))) > ((95 / 100) * (Subquery(Step1)))""],""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_CUSTOMER_SK IS NOT NULL""],""parentOperators"":[10]},{""id"":13,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_CUSTOMER_SK"",""SS_QUANTITY"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[13]},{""id"":15,""operation"":""SemiJoin"",""expressions"":[""joinKey: (FREQUENT_SS_ITEMS.ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[4]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""groupKeys: [FREQUENT_SS_ITEMS.ITEM_SK]""],""parentOperators"":[15]},{""id"":17,""operation"":""WithReference"",""parentOperators"":[16]},{""id"":18,""operation"":""WithClause"",""expressions"":[""FREQUENT_SS_ITEMS""],""parentOperators"":[17,50]},{""id"":19,""operation"":""Filter"",""expressions"":[""(COUNT(*)) > 4""],""parentOperators"":[18]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [SUBSTR(ITEM.I_ITEM_DESC, 1, 30), ITEM.I_ITEM_SK, DATE_DIM.D_DATE]""],""parentOperators"":[19]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT_INTERNAL(*)(COUNT(*), COUNT(*))]"",""groupKeys: [SUBSTR(ITEM.I_ITEM_DESC, 1, 30), ITEM.I_ITEM_SK, DATE_DIM.D_DATE]""],""parentOperators"":[20]},{""id"":22,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[21]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_ITEM_DESC]""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_DESC""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[23]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [DATE_DIM.D_DATE, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[22]},{""id"":26,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[25]},{""id"":27,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 1999 IN 2000 IN 2001 IN 2002""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[26]},{""id"":30,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[29]},{""id"":31,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[30]},{""id"":32,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[15]},{""id"":33,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 1)""],""parentOperators"":[32]},{""id"":34,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[33]},{""id"":35,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[32]},{""id"":36,""operation"":""JoinFilter"",""expressions"":[""joinKey: (BEST_SS_CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[35]},{""id"":37,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_ITEM_SK"",""CS_QUANTITY"",""CS_LIST_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[36]},{""id"":38,""operation"":""SemiJoin"",""expressions"":[""joinKey: (BEST_SS_CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[3]},{""id"":39,""operation"":""Aggregate"",""expressions"":[""groupKeys: [BEST_SS_CUSTOMER.C_CUSTOMER_SK]""],""parentOperators"":[38]},{""id"":40,""operation"":""WithReference"",""parentOperators"":[39]},{""id"":41,""operation"":""SemiJoin"",""expressions"":[""joinKey: (WEB_SALES.WS_ITEM_SK = FREQUENT_SS_ITEMS.ITEM_SK)""],""parentOperators"":[38]},{""id"":42,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[41]},{""id"":43,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 1)""],""parentOperators"":[42]},{""id"":44,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[43]},{""id"":45,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[42]},{""id"":46,""operation"":""JoinFilter"",""expressions"":[""joinKey: (BEST_SS_CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[45]},{""id"":47,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_BILL_CUSTOMER_SK"",""WS_QUANTITY"",""WS_LIST_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[46]},{""id"":49,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WEB_SALES.WS_ITEM_SK = FREQUENT_SS_ITEMS.ITEM_SK)""],""parentOperators"":[48]},{""id"":50,""operation"":""WithReference"",""parentOperators"":[49]}]]}",01b2e7fc-0002-2d15-0051-ba8700019712,"explain using json with /* { ""query"":""query23_p1"",""streamId"":0,""querySequence"":68 } */ frequent_ss_items as
 (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt
  from store_sales
      ,date_dim
      ,item
  where ss_sold_date_sk = d_date_sk
    and ss_item_sk = i_item_sk
    and d_year in (1999,1999+1,1999+2,1999+3)
  group by substr(i_item_desc,1,30),i_item_sk,d_date
  having count(*) >4),
 max_store_sales as
 (select max(csales) tpcds_cmax
  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales
        from store_sales
            ,customer
            ,date_dim
        where ss_customer_sk = c_customer_sk
         and ss_sold_date_sk = d_date_sk
         and d_year in (1999,1999+1,1999+2,1999+3)
        group by c_customer_sk)),
 best_ss_customer as
 (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales
  from store_sales
      ,customer
  where ss_customer_sk = c_customer_sk
  group by c_customer_sk
  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select
  *
from
 max_store_sales))
  select  sum(sales)
 from (select cs_quantity*cs_list_price sales
       from catalog_sales
           ,date_dim
       where d_year = 1999
         and d_moy = 1
         and cs_sold_date_sk = d_date_sk
         and cs_item_sk in (select item_sk from frequent_ss_items)
         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)
      union all
      select ws_quantity*ws_list_price sales
       from web_sales
           ,date_dim
       where d_year = 1999
         and d_moy = 1
         and ws_sold_date_sk = d_date_sk
         and ws_item_sk in (select item_sk from frequent_ss_items)
         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer))
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:17.441-07:00,2024-03-10T18:32:18.747-07:00,1306,0,0,1304,2,0,0,0,0,,,0,,,0,0.000199000,0,8.9.2,0,0,0,0,0,FALSE,08ea89a08b713b427d2fbc0be24f9e07,2,263e8875da0f7c8742133d4dda4faf66,1
"{""GlobalStats"":{""partitionsTotal"":73493,""partitionsAssigned"":71187,""bytesAssigned"":1216511980544},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""STORE.S_STORE_NAME"",""SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [STORE.S_STORE_NAME ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))))]"",""groupKeys: [STORE.S_STORE_NAME]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))]"",""groupKeys: [STORE.S_STORE_NAME]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (SUBSTR(SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5), 1, 2) = SUBSTR(STORE.S_ZIP, 1, 2))""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""groupKeys: [SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5)]""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""groupKeys: [SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5)]""],""parentOperators"":[5]},{""id"":7,""operation"":""SemiJoin"",""expressions"":[""joinKey: (SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5) = SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5))""],""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""groupKeys: [SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5)]""],""parentOperators"":[7]},{""id"":9,""operation"":""Filter"",""expressions"":[""COUNT(*) > 10""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER_ADDRESS.CA_ZIP]""],""parentOperators"":[9]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_ZIP""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""CUSTOMER.C_PREFERRED_CUST_FLAG = 'Y'""],""parentOperators"":[11]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CURRENT_ADDR_SK"",""C_PREFERRED_CUST_FLAG""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""groupKeys: [SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5)]""],""parentOperators"":[7]},{""id"":17,""operation"":""Filter"",""expressions"":[""((SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5)) IN '63138' IN '67860' IN '61967' IN '53708' IN '58786' IN '76781' IN '57657' IN '22833' IN '40701' IN '19526' IN '24251' IN '42756' IN '93357' IN '70900' IN '97478' IN '25826' IN '89352' IN '83287' IN '87852' IN '71728' IN '20435' IN '97347' IN '12829' IN '31192' IN '68398' IN '77153' IN '76831' IN '24463' IN '89163' IN '26332' IN '75358' IN '91801' IN '33809' IN '40432' IN '81945' IN '99662' IN '97217' IN '57073' IN '65311' IN '74620' IN '37716' IN '35022' IN '76576' IN '19259' IN '78957' IN '39704' IN '61563' IN '65732' IN '35232' IN '23086' IN '92817' IN '28855' IN '11008' IN '92650' IN '10280' IN '57312' IN '90853' IN '68049' IN '25184' IN '40886' IN '15096' IN '48457' IN '93467' IN '62316' IN '41732' IN '14351' IN '46679' IN '19198' IN '34531' IN '67619' IN '21781' IN '15762' IN '41893' IN '61351' IN '30899' IN '72568' IN '23977' IN '72730' IN '98690' IN '14381' IN '15025' IN '11061' IN '91659' IN '63492' IN '30467' IN '58823' IN '34225'...""],""parentOperators"":[16]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5) = SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5))""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ZIP""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[18]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_NET_PROFIT))]"",""groupKeys: [STORE.S_STORE_NAME, SUBSTR(STORE.S_ZIP, 1, 2)]""],""parentOperators"":[4]},{""id"":21,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""Filter"",""expressions"":[""SUBSTR(STORE.S_ZIP, 1, 2) IS NOT NULL""],""parentOperators"":[21]},{""id"":23,""operation"":""JoinFilter"",""expressions"":[""joinKey: (SUBSTR(SUBSTR(CUSTOMER_ADDRESS.CA_ZIP, 1, 5), 1, 2) = SUBSTR(STORE.S_ZIP, 1, 2))""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME"",""S_ZIP""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[23]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_NET_PROFIT)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[21]},{""id"":26,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[25]},{""id"":27,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_QOY = 2) AND (DATE_DIM.D_YEAR = 2002)""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[26]},{""id"":30,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[29]},{""id"":31,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_STORE_SK"",""SS_NET_PROFIT""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[30]}]]}",01b2e7fc-0002-2d83-0051-ba87000251ca,"explain using json select /* { ""query"":""query08"",""streamId"":0,""querySequence"":63 } */  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '63138','67860','61967','53708','58786','76781',
                          '57657','22833','40701','19526','24251',
                          '42756','93357','70900','97478','25826',
                          '89352','83287','87852','71728','20435',
                          '97347','12829','31192','68398','77153',
                          '76831','24463','89163','26332','75358',
                          '91801','33809','40432','81945','99662',
                          '97217','57073','65311','74620','37716',
                          '35022','76576','19259','78957','39704',
                          '61563','65732','35232','23086','92817',
                          '28855','11008','92650','10280','57312',
                          '90853','68049','25184','40886','15096',
                          '48457','93467','62316','41732','14351',
                          '46679','19198','34531','67619','21781',
                          '15762','41893','61351','30899','72568',
                          '23977','72730','98690','14381','15025',
                          '11061','91659','63492','30467','58823',
                          '34225','41751','22966','53904','10850',
                          '49272','18533','91413','26270','66650',
                          '78977','32727','41618','86724','89574',
                          '80102','29243','56284','78679','41170',
                          '65834','58524','17609','14482','65420',
                          '61305','61602','55063','29845','37472',
                          '92495','20762','98534','52840','94611',
                          '88246','20941','77180','42161','50818',
                          '59986','42931','96083','39284','42488',
                          '18887','97244','87237','12691','70174',
                          '45221','68006','43306','70606','51736',
                          '69742','44782','22889','94777','78658',
                          '57896','26701','16853','15015','35216',
                          '51705','21424','38948','85706','63759',
                          '43382','36655','43425','76461','27640',
                          '20462','82792','49093','43674','56981',
                          '65914','55967','35912','46158','78273',
                          '38880','53734','41868','34833','67272',
                          '85734','34147','96967','82112','40226',
                          '70925','34591','21710','14823','52153',
                          '38828','52994','15134','66643','39851',
                          '56582','51108','46155','92016','51482',
                          '62159','18137','96064','75231','91241',
                          '82099','51090','77652','88986','21413',
                          '34541','36011','46399','81547','31527',
                          '87163','32251','79823','75752','82160',
                          '10124','96204','95013','40385','25827',
                          '93942','30382','18596','51115','51175',
                          '20450','40294','53607','99744','26750',
                          '44360','70414','70485','27962','99544',
                          '20113','67297','26745','43124','76481',
                          '13569','27295','10874','88751','65381',
                          '35530','53520','74830','36758','34012',
                          '77294','37011','27942','33548','23328',
                          '18788','27889','89554','57476','53067',
                          '90564','59313','24320','59616','78526',
                          '62798','38573','92977','15249','32892',
                          '13079','71636','27619','16195','42929',
                          '35105','74684','21513','86627','77383',
                          '87610','74689','91817','40620','35374',
                          '71852','96322','15057','20308','33887',
                          '44377','80226','29992','13647','74617',
                          '46066','92902','46500','15191','47218',
                          '47105','31405','67232','41698','20372',
                          '43007','50248','11177','30705','11188',
                          '90478','21509','59137','40264','15195',
                          '39835','87611','52823','65271','28124',
                          '61631','13764','71312','35636','91323',
                          '46111','97081','91071','33770','56410',
                          '65217','59087','55449','46572','42052',
                          '42905','72602','80191','33901','97429',
                          '83423','43443','68275','33275','46878',
                          '96277','20178','12201','71391','37401',
                          '66453','42093','45748','95121','86248',
                          '76141','92863','36918','21700','67505',
                          '46756','16507','18916','21804','78175',
                          '13016','64727','39860','83563','16236',
                          '96737','36363','94082','35839','65560',
                          '16775','60185','82286','61848','89954',
                          '62574','87619','35237','69642','32304',
                          '65704','22592','84696','86673','25711',
                          '57289','13095','56175','70743','53622',
                          '16905','88034','55033','70258')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:12.476-07:00,2024-03-10T18:32:13.174-07:00,698,0,0,697,1,0,0,0,0,,,0,,,0,0.000106000,0,8.9.2,0,0,0,0,0,FALSE,66d80720ddb19effbb53439897c4ba57,2,8a3e2f0638250f96be12fcd08a36a570,1
"{""GlobalStats"":{""partitionsTotal"":73241,""partitionsAssigned"":73241,""bytesAssigned"":1255080984576},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""DATE_DIM.D_MONTH_SEQ""]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_MONTH_SEQ]""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1998) AND (DATE_DIM.D_MOY = 4)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_MONTH_SEQ"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[4]}],[{""id"":0,""operation"":""Result"",""expressions"":[""A.CA_STATE"",""COUNT(*)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [COUNT(*) ASC NULLS LAST, A.CA_STATE ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(COUNT(*)) >= 10""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [A.CA_STATE]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT_INTERNAL(*)(COUNT(*), COUNT(*))]"",""groupKeys: [A.CA_STATE]""],""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (I.I_ITEM_SK = S.SS_ITEM_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [I.I_ITEM_SK]""],""parentOperators"":[5]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (J.I_CATEGORY = I.I_CATEGORY)"",""joinFilter: (I.I_CURRENT_PRICE) > (1.2 * ((SUM(J.I_CURRENT_PRICE)) / (NVL(COUNT(J.I_CURRENT_PRICE), 0))))""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""(SUM(J.I_CURRENT_PRICE) IS NOT NULL) AND (COUNT(J.I_CURRENT_PRICE) IS NOT NULL)""],""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(J.I_CURRENT_PRICE), COUNT(J.I_CURRENT_PRICE)]"",""groupKeys: [J.I_CATEGORY]""],""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""J.I_CATEGORY IS NOT NULL""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_CURRENT_PRICE"",""I_CATEGORY""],""alias"":""J"",""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""I.I_CATEGORY IS NOT NULL""],""parentOperators"":[7]},{""id"":13,""operation"":""JoinFilter"",""expressions"":[""joinKey: (J.I_CATEGORY = I.I_CATEGORY)"",""joinFilter: (I.I_CURRENT_PRICE) > (1.2 * ((SUM(J.I_CURRENT_PRICE)) / (NVL(COUNT(J.I_CURRENT_PRICE), 0))))""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_CURRENT_PRICE"",""I_CATEGORY""],""alias"":""I"",""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[13]},{""id"":15,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [A.CA_STATE, S.SS_ITEM_SK]""],""parentOperators"":[5]},{""id"":16,""operation"":""InnerJoin"",""expressions"":[""joinKey: (A.CA_ADDRESS_SK = C.C_CURRENT_ADDR_SK)""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE""],""alias"":""A"",""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[16]},{""id"":18,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [S.SS_ITEM_SK, C.C_CURRENT_ADDR_SK]""],""parentOperators"":[16]},{""id"":19,""operation"":""InnerJoin"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = S.SS_CUSTOMER_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""JoinFilter"",""expressions"":[""joinKey: (A.CA_ADDRESS_SK = C.C_CURRENT_ADDR_SK)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_ADDR_SK""],""alias"":""C"",""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[20]},{""id"":22,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [S.SS_ITEM_SK, S.SS_CUSTOMER_SK]""],""parentOperators"":[19]},{""id"":23,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D.D_DATE_SK = S.SS_SOLD_DATE_SK)""],""parentOperators"":[22]},{""id"":24,""operation"":""Filter"",""expressions"":[""D.D_MONTH_SEQ = Subquery(Step1)""],""parentOperators"":[23]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""alias"":""D"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[24]},{""id"":26,""operation"":""Filter"",""expressions"":[""(S.SS_CUSTOMER_SK IS NOT NULL) AND (S.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[23]},{""id"":27,""operation"":""JoinFilter"",""expressions"":[""joinKey: (I.I_ITEM_SK = S.SS_ITEM_SK)""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_CUSTOMER_SK""],""alias"":""S"",""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[27]}]]}",01b2e7fc-0002-2fe3-0051-ba870002e05e,"explain using json select /* { ""query"":""query06"",""streamId"":0,""querySequence"":58 } */  a.ca_state state, count(*) cnt
 from customer_address a
     ,customer c
     ,store_sales s
     ,date_dim d
     ,item i
 where       a.ca_address_sk = c.c_current_addr_sk
 	and c.c_customer_sk = s.ss_customer_sk
 	and s.ss_sold_date_sk = d.d_date_sk
 	and s.ss_item_sk = i.i_item_sk
 	and d.d_month_seq =
 	     (select distinct (d_month_seq)
 	      from date_dim
               where d_year = 1998
 	        and d_moy = 4 )
 	and i.i_current_price > 1.2 *
             (select avg(j.i_current_price)
 	     from item j
 	     where j.i_category = i.i_category)
 group by a.ca_state
 having count(*) >= 10
 order by cnt, a.ca_state
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:09.118-07:00,2024-03-10T18:32:09.404-07:00,286,0,0,284,2,0,0,0,0,,,0,,,0,0.000044000,0,8.9.2,0,0,0,0,0,FALSE,82e790a891a73f867474258907b80d79,2,436b68f0f04e61e361486e0a77f63bb0,1
"{""GlobalStats"":{""partitionsTotal"":134716,""partitionsAssigned"":134354,""bytesAssigned"":2294155961344},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""ITEM.I_ITEM_DESC"",""STORE.S_STORE_ID"",""STORE.S_STORE_NAME"",""MAX(MAX(MAX(MAX(STORE_SALES.SS_QUANTITY))))"",""MAX(MAX(MAX(MAX(STORE_RETURNS.SR_RETURN_QUANTITY))))"",""MAX(MAX(MAX(MAX(CATALOG_SALES.CS_QUANTITY))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [ITEM.I_ITEM_ID ASC NULLS LAST, ITEM.I_ITEM_DESC ASC NULLS LAST, STORE.S_STORE_ID ASC NULLS LAST, STORE.S_STORE_NAME ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(MAX(MAX(MAX(STORE_SALES.SS_QUANTITY)))), MAX(MAX(MAX(MAX(STORE_RETURNS.SR_RETURN_QUANTITY)))), MAX(MAX(MAX(MAX(CATALOG_SALES.CS_QUANTITY))))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, STORE.S_STORE_ID, STORE.S_STORE_NAME]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(MAX(MAX(STORE_SALES.SS_QUANTITY))), MAX(MAX(MAX(STORE_RETURNS.SR_RETURN_QUANTITY))), MAX(MAX(MAX(CATALOG_SALES.CS_QUANTITY)))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, STORE.S_STORE_ID, STORE.S_STORE_NAME]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D3.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""groupKeys: [D3.D_DATE_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""Filter"",""expressions"":[""D3.D_YEAR IN 1999 IN 2000 IN 2001""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""alias"":""D3"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(MAX(STORE_SALES.SS_QUANTITY)), MAX(MAX(STORE_RETURNS.SR_RETURN_QUANTITY)), MAX(MAX(CATALOG_SALES.CS_QUANTITY))]"",""groupKeys: [STORE.S_STORE_ID, STORE.S_STORE_NAME, ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, CATALOG_SALES.CS_SOLD_DATE_SK]""],""parentOperators"":[4]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_RETURNS.SR_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK) AND (STORE_RETURNS.SR_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(STORE_SALES.SS_QUANTITY), MAX(STORE_RETURNS.SR_RETURN_QUANTITY)]"",""groupKeys: [STORE.S_STORE_ID, STORE.S_STORE_NAME, ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, STORE_RETURNS.SR_ITEM_SK, STORE_RETURNS.SR_CUSTOMER_SK]""],""parentOperators"":[9]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[10]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_ID"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[12]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[11]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID"",""I_ITEM_DESC""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[14]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D2.D_DATE_SK = STORE_RETURNS.SR_RETURNED_DATE_SK)""],""parentOperators"":[16]},{""id"":19,""operation"":""Filter"",""expressions"":[""(D2.D_MOY >= 4) AND (D2.D_MOY <= 7) AND (D2.D_YEAR = 1999)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""alias"":""D2"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[19]},{""id"":21,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_SALES.SS_CUSTOMER_SK = STORE_RETURNS.SR_CUSTOMER_SK) AND (STORE_SALES.SS_ITEM_SK = STORE_RETURNS.SR_ITEM_SK) AND (STORE_SALES.SS_TICKET_NUMBER = STORE_RETURNS.SR_TICKET_NUMBER)""],""parentOperators"":[17]},{""id"":23,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D1.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[22]},{""id"":25,""operation"":""Filter"",""expressions"":[""(D1.D_MOY = 4) AND (D1.D_YEAR = 1999)""],""parentOperators"":[24]},{""id"":26,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""alias"":""D1"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[25]},{""id"":28,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[27]},{""id"":29,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_CUSTOMER_SK"",""SS_STORE_SK"",""SS_TICKET_NUMBER"",""SS_QUANTITY""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[29]},{""id"":32,""operation"":""Filter"",""expressions"":[""(STORE_RETURNS.SR_CUSTOMER_SK IS NOT NULL) AND (STORE_RETURNS.SR_RETURNED_DATE_SK IS NOT NULL)""],""parentOperators"":[31]},{""id"":33,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[32]},{""id"":34,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_RETURNED_DATE_SK"",""SR_ITEM_SK"",""SR_CUSTOMER_SK"",""SR_TICKET_NUMBER"",""SR_RETURN_QUANTITY""],""partitionsAssigned"":6909,""partitionsTotal"":7070,""bytesAssigned"":122017405952,""parentOperators"":[33]},{""id"":35,""operation"":""Aggregate"",""expressions"":[""aggExprs: [MAX(CATALOG_SALES.CS_QUANTITY)]"",""groupKeys: [CATALOG_SALES.CS_SOLD_DATE_SK, CATALOG_SALES.CS_BILL_CUSTOMER_SK, CATALOG_SALES.CS_ITEM_SK]""],""parentOperators"":[9]},{""id"":36,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL) AND (CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL)""],""parentOperators"":[35]},{""id"":37,""operation"":""JoinFilter"",""expressions"":[""joinKey: (D3.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[36]},{""id"":38,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_ITEM_SK"",""CS_QUANTITY""],""partitionsAssigned"":54721,""partitionsTotal"":54922,""bytesAssigned"":920184101376,""parentOperators"":[37]}]]}",01b2e7fc-0002-2f99-0051-ba8700028192,"explain using json select /* { ""query"":""query29"",""streamId"":0,""querySequence"":53 } */
     i_item_id
    ,i_item_desc
    ,s_store_id
    ,s_store_name
    ,max(ss_quantity)        as store_sales_quantity
    ,max(sr_return_quantity) as store_returns_quantity
    ,max(cs_quantity)        as catalog_sales_quantity
 from
    store_sales
   ,store_returns
   ,catalog_sales
   ,date_dim             d1
   ,date_dim             d2
   ,date_dim             d3
   ,store
   ,item
 where
     d1.d_moy               = 4
 and d1.d_year              = 1999
 and d1.d_date_sk           = ss_sold_date_sk
 and i_item_sk              = ss_item_sk
 and s_store_sk             = ss_store_sk
 and ss_customer_sk         = sr_customer_sk
 and ss_item_sk             = sr_item_sk
 and ss_ticket_number       = sr_ticket_number
 and sr_returned_date_sk    = d2.d_date_sk
 and d2.d_moy               between 4 and  4 + 3
 and d2.d_year              = 1999
 and sr_customer_sk         = cs_bill_customer_sk
 and sr_item_sk             = cs_item_sk
 and cs_sold_date_sk        = d3.d_date_sk
 and d3.d_year              in (1999,1999+1,1999+2)
 group by
    i_item_id
   ,i_item_desc
   ,s_store_id
   ,s_store_name
 order by
    i_item_id
   ,i_item_desc
   ,s_store_id
   ,s_store_name
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:03.687-07:00,2024-03-10T18:32:05.334-07:00,1647,0,0,1645,2,0,0,0,0,,,0,,,0,0.000251000,0,8.9.2,0,0,0,0,0,FALSE,d68236aa637536c81e061ea73b9fc7f1,2,3c7ca16e3bf5e0a4212a2431c16b32b0,1
"{""GlobalStats"":{""partitionsTotal"":79789,""partitionsAssigned"":79789,""bytesAssigned"":1376687539712},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""STORE_SALES.SS_CUSTOMER_SK"",""SUM(IFF(STORE_RETURNS.SR_RETURN_QUANTITY IS NOT NULL, (STORE_SALES.SS_QUANTITY - STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_SALES.SS_SALES_PRICE), (STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE)))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [SUM(IFF(SYS_VW.SR_RETURN_QUANTITY_7 IS NOT NULL, (SYS_VW.SS_QUANTITY_2 - SYS_VW.SR_RETURN_QUANTITY_7) * (SYS_VW.SS_SALES_PRICE_3), (SYS_VW.SS_QUANTITY_2) * (SYS_VW.SS_SALES_PRICE_3))) ASC NULLS LAST, SYS_VW.SS_CUSTOMER_SK_0 ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFF(STORE_RETURNS.SR_RETURN_QUANTITY IS NOT NULL, (STORE_SALES.SS_QUANTITY - STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_SALES.SS_SALES_PRICE), (STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_SALES_PRICE)))]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_RETURNS.SR_ITEM_SK = STORE_SALES.SS_ITEM_SK) AND (STORE_RETURNS.SR_TICKET_NUMBER = STORE_SALES.SS_TICKET_NUMBER)""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (REASON.R_REASON_SK = STORE_RETURNS.SR_REASON_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""REASON.R_REASON_DESC = 'Gift exchange'""],""parentOperators"":[4]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.REASON""],""expressions"":[""R_REASON_SK"",""R_REASON_DESC""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2560,""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""(STORE_RETURNS.SR_REASON_SK IS NOT NULL) AND (STORE_RETURNS.SR_ITEM_SK IS NOT NULL) AND (STORE_RETURNS.SR_TICKET_NUMBER IS NOT NULL)""],""parentOperators"":[4]},{""id"":8,""operation"":""JoinFilter"",""expressions"":[""joinKey: (REASON.R_REASON_SK = STORE_RETURNS.SR_REASON_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_ITEM_SK"",""SR_REASON_SK"",""SR_TICKET_NUMBER"",""SR_RETURN_QUANTITY""],""partitionsAssigned"":7070,""partitionsTotal"":7070,""bytesAssigned"":124763446272,""parentOperators"":[8]},{""id"":10,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE_RETURNS.SR_ITEM_SK = STORE_SALES.SS_ITEM_SK) AND (STORE_RETURNS.SR_TICKET_NUMBER = STORE_SALES.SS_TICKET_NUMBER)""],""parentOperators"":[3]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_ITEM_SK"",""SS_CUSTOMER_SK"",""SS_TICKET_NUMBER"",""SS_QUANTITY"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[10]}]]}",01b2e7fc-0002-2e24-0051-ba870001d1ea,"explain using json select /* { ""query"":""query93"",""streamId"":0,""querySequence"":52 } */  ss_customer_sk
            ,sum(act_sales) sumsales
      from (select ss_item_sk
                  ,ss_ticket_number
                  ,ss_customer_sk
                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price
                                                            else (ss_quantity*ss_sales_price) end act_sales
            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk
                                                               and sr_ticket_number = ss_ticket_number)
                ,reason
            where sr_reason_sk = r_reason_sk
              and r_reason_desc = 'Gift exchange') t
      group by ss_customer_sk
      order by sumsales, ss_customer_sk
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:02.892-07:00,2024-03-10T18:32:03.106-07:00,214,0,0,213,1,0,0,0,0,,,0,,,0,0.000033000,0,8.9.2,0,0,0,0,0,FALSE,8e76b83c2a9679b73fc8db25eb38f126,2,1e3034ea66b363e3a12d07a0b4c0a0e1,1
"{""GlobalStats"":{""partitionsTotal"":100821,""partitionsAssigned"":100821,""bytesAssigned"":1717626931200},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""T_S_SECYEAR.CUSTOMER_ID"",""T_S_SECYEAR.CUSTOMER_FIRST_NAME"",""T_S_SECYEAR.CUSTOMER_LAST_NAME"",""T_S_SECYEAR.CUSTOMER_BIRTH_COUNTRY""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [T_S_SECYEAR.CUSTOMER_ID ASC NULLS LAST, T_S_SECYEAR.CUSTOMER_FIRST_NAME ASC NULLS LAST, T_S_SECYEAR.CUSTOMER_LAST_NAME ASC NULLS LAST, T_S_SECYEAR.CUSTOMER_BIRTH_COUNTRY ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_S_FIRSTYEAR.CUSTOMER_ID = T_W_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_W_FIRSTYEAR.YEAR_TOTAL > 0, (T_W_SECYEAR.YEAR_TOTAL) / (T_W_FIRSTYEAR.YEAR_TOTAL), 0)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, (T_S_SECYEAR.YEAR_TOTAL) / (T_S_FIRSTYEAR.YEAR_TOTAL), 0))""],""parentOperators"":[1]},{""id"":3,""operation"":""WithReference"",""expressions"":[""T_S_FIRSTYEAR""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'w')) = 's') AND (T_S_FIRSTYEAR.DYEAR = 2000) AND (T_S_FIRSTYEAR.YEAR_TOTAL > 0)""],""parentOperators"":[3]},{""id"":5,""operation"":""WithClause"",""expressions"":[""YEAR_TOTAL""],""parentOperators"":[4,36,40,43]},{""id"":6,""operation"":""UnionAll"",""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_EXT_LIST_PRICE - STORE_SALES.SS_EXT_DISCOUNT_AMT)), COUNT(*)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_EXT_LIST_PRICE - STORE_SALES.SS_EXT_DISCOUNT_AMT)), COUNT(*))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS]""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CUSTOMER_ID"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_PREFERRED_CUST_FLAG"",""C_BIRTH_COUNTRY"",""C_EMAIL_ADDRESS""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_LIST_PRICE - STORE_SALES.SS_EXT_DISCOUNT_AMT))]"",""groupKeys: [DATE_DIM.D_YEAR, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[9]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 2000 IN 2001""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_LIST_PRICE - STORE_SALES.SS_EXT_DISCOUNT_AMT)]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[13]},{""id"":17,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[16]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_EXT_DISCOUNT_AMT"",""SS_EXT_LIST_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[18]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM(WEB_SALES.WS_EXT_LIST_PRICE - WEB_SALES.WS_EXT_DISCOUNT_AMT)), COUNT(*)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[6]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM(WEB_SALES.WS_EXT_LIST_PRICE - WEB_SALES.WS_EXT_DISCOUNT_AMT)), COUNT(*))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[20]},{""id"":22,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[21]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS]""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CUSTOMER_ID"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_PREFERRED_CUST_FLAG"",""C_BIRTH_COUNTRY"",""C_EMAIL_ADDRESS""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[23]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(WEB_SALES.WS_EXT_LIST_PRICE - WEB_SALES.WS_EXT_DISCOUNT_AMT))]"",""groupKeys: [DATE_DIM.D_YEAR, WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[22]},{""id"":26,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[25]},{""id"":27,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 2000 IN 2001""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[27]},{""id"":29,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_EXT_LIST_PRICE - WEB_SALES.WS_EXT_DISCOUNT_AMT)]"",""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK, WEB_SALES.WS_SOLD_DATE_SK]""],""parentOperators"":[26]},{""id"":30,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[29]},{""id"":31,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[30]},{""id"":32,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_BILL_CUSTOMER_SK"",""WS_EXT_DISCOUNT_AMT"",""WS_EXT_LIST_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[31]},{""id"":33,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_W_SECYEAR.CUSTOMER_ID = T_W_FIRSTYEAR.CUSTOMER_ID)""],""parentOperators"":[2]},{""id"":34,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_S_FIRSTYEAR.CUSTOMER_ID = T_W_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_W_FIRSTYEAR.YEAR_TOTAL > 0, (T_W_SECYEAR.YEAR_TOTAL) / (T_W_FIRSTYEAR.YEAR_TOTAL), 0)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, (T_S_SECYEAR.YEAR_TOTAL) / (T_S_FIRSTYEAR.YEAR_TOTAL), 0))""],""parentOperators"":[33]},{""id"":35,""operation"":""WithReference"",""expressions"":[""T_W_SECYEAR""],""parentOperators"":[34]},{""id"":36,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'w')) = 'w') AND (T_W_SECYEAR.DYEAR = 2001)""],""parentOperators"":[35]},{""id"":37,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_W_FIRSTYEAR.CUSTOMER_ID = T_S_SECYEAR.CUSTOMER_ID)""],""parentOperators"":[33]},{""id"":38,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_S_FIRSTYEAR.CUSTOMER_ID = T_W_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_W_FIRSTYEAR.YEAR_TOTAL > 0, (T_W_SECYEAR.YEAR_TOTAL) / (T_W_FIRSTYEAR.YEAR_TOTAL), 0)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, (T_S_SECYEAR.YEAR_TOTAL) / (T_S_FIRSTYEAR.YEAR_TOTAL), 0))""],""parentOperators"":[37]},{""id"":39,""operation"":""WithReference"",""expressions"":[""T_W_FIRSTYEAR""],""parentOperators"":[38]},{""id"":40,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'w')) = 'w') AND (T_W_FIRSTYEAR.DYEAR = 2000) AND (T_W_FIRSTYEAR.YEAR_TOTAL > 0)""],""parentOperators"":[39]},{""id"":41,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_S_FIRSTYEAR.CUSTOMER_ID = T_W_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_W_FIRSTYEAR.YEAR_TOTAL > 0, (T_W_SECYEAR.YEAR_TOTAL) / (T_W_FIRSTYEAR.YEAR_TOTAL), 0)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, (T_S_SECYEAR.YEAR_TOTAL) / (T_S_FIRSTYEAR.YEAR_TOTAL), 0))""],""parentOperators"":[37]},{""id"":42,""operation"":""WithReference"",""expressions"":[""T_S_SECYEAR""],""parentOperators"":[41]},{""id"":43,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'w')) = 's') AND (T_S_SECYEAR.DYEAR = 2001)""],""parentOperators"":[42]}]]}",01b2e7fc-0002-2fe3-0051-ba870002e05a,"explain using json with /* { ""query"":""query11"",""streamId"":0,""querySequence"":51 } */ year_total as (
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total
       ,'s' sale_type
 from customer
     ,store_sales
     ,date_dim
 where c_customer_sk = ss_customer_sk
   and ss_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
 union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total
       ,'w' sale_type
 from customer
     ,web_sales
     ,date_dim
 where c_customer_sk = ws_bill_customer_sk
   and ws_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
         )
  select
                  t_s_secyear.customer_id
                 ,t_s_secyear.customer_first_name
                 ,t_s_secyear.customer_last_name
                 ,t_s_secyear.customer_birth_country
 from year_total t_s_firstyear
     ,year_total t_s_secyear
     ,year_total t_w_firstyear
     ,year_total t_w_secyear
 where t_s_secyear.customer_id = t_s_firstyear.customer_id
         and t_s_firstyear.customer_id = t_w_secyear.customer_id
         and t_s_firstyear.customer_id = t_w_firstyear.customer_id
         and t_s_firstyear.sale_type = 's'
         and t_w_firstyear.sale_type = 'w'
         and t_s_secyear.sale_type = 's'
         and t_w_secyear.sale_type = 'w'
         and t_s_firstyear.dyear = 2000
         and t_s_secyear.dyear = 2000+1
         and t_w_firstyear.dyear = 2000
         and t_w_secyear.dyear = 2000+1
         and t_s_firstyear.year_total > 0
         and t_w_firstyear.year_total > 0
         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end
             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end
 order by t_s_secyear.customer_id
         ,t_s_secyear.customer_first_name
         ,t_s_secyear.customer_last_name
         ,t_s_secyear.customer_birth_country
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:01.869-07:00,2024-03-10T18:32:02.542-07:00,673,0,0,671,2,0,0,0,0,,,0,,,0,0.000103000,0,8.9.2,0,0,0,0,0,FALSE,fe3e7cc1794737823884130f0461ded4,2,ed1dcbafbde7f476d63d6bad9216a46a,1
"{""GlobalStats"":{""partitionsTotal"":155740,""partitionsAssigned"":155740,""bytesAssigned"":2639701907968},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CA.CA_STATE"",""CUSTOMER_DEMOGRAPHICS.CD_GENDER"",""CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS"",""CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT"",""COUNT(*)"",""MAX(MAX(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT))"",""SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) - 1), 0))))"",""SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) * ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)))) - 1), 0))))"",""CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT"",""COUNT(*)"",""MAX(MAX(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT))"",""SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) - 1), 0))))"",""SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) * ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)))) - 1), 0))))"",""CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT"",""COUNT(*)"",""MAX(MAX(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT))"",""SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) - 1), 0))))"",""SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*))))) - ((SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * (SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) * ((COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))) - 1), 0))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CA.CA_STATE ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_GENDER ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*), MAX(MAX(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT)), COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*))), SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*))), SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*))), MAX(MAX(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT)), COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*))), SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*))), SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*))), MAX(MAX(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT)), COUNT(COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*))), SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*))), SUM(SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)))]"",""groupKeys: [CA.CA_STATE, CUSTOMER_DEMOGRAPHICS.CD_GENDER, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS, CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*), MAX(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT), COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)), SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)), SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, COUNT(*)), MAX(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT), COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)), SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)), SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, COUNT(*)), MAX(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT), COUNT_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)), SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT * CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*)), SUM_INTERNAL(CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT, COUNT(*))]"",""groupKeys: [CA.CA_STATE, CUSTOMER_DEMOGRAPHICS.CD_GENDER, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS, CUSTOMER_DEMOGRAPHICS.CD_DEP_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_EMPLOYED_COUNT, CUSTOMER_DEMOGRAPHICS.CD_DEP_COLLEGE_COUNT]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = C.C_CURRENT_CDEMO_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_GENDER"",""CD_MARITAL_STATUS"",""CD_DEP_COUNT"",""CD_DEP_EMPLOYED_COUNT"",""CD_DEP_COLLEGE_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CA.CA_STATE, C.C_CURRENT_CDEMO_SK]""],""parentOperators"":[4]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CA.CA_ADDRESS_SK = C.C_CURRENT_ADDR_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE""],""alias"":""CA"",""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [C.C_CURRENT_CDEMO_SK, C.C_CURRENT_ADDR_SK]""],""parentOperators"":[7]},{""id"":10,""operation"":""SemiJoin"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [C.C_CUSTOMER_SK, C.C_CURRENT_CDEMO_SK, C.C_CURRENT_ADDR_SK]""],""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SHIP_CUSTOMER_SK IS NOT NULL) OR (WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL)""],""parentOperators"":[11]},{""id"":13,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (CATALOG_SALES.CS_SHIP_CUSTOMER_SK = C.C_CUSTOMER_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_SHIP_CUSTOMER_SK]""],""parentOperators"":[13]},{""id"":15,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_SHIP_CUSTOMER_SK]""],""parentOperators"":[14]},{""id"":16,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[15]},{""id"":17,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2001) AND (DATE_DIM.D_QOY < 4)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[18]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_SHIP_CUSTOMER_SK, CATALOG_SALES.CS_SOLD_DATE_SK]""],""parentOperators"":[16]},{""id"":21,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SHIP_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[20]},{""id"":22,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[21]},{""id"":23,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_SHIP_CUSTOMER_SK""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[22]},{""id"":24,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (WEB_SALES.WS_BILL_CUSTOMER_SK = C.C_CUSTOMER_SK)""],""parentOperators"":[13]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[24]},{""id"":26,""operation"":""Aggregate"",""expressions"":[""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[25]},{""id"":27,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[26]},{""id"":28,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2001) AND (DATE_DIM.D_QOY < 4)""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[29]},{""id"":31,""operation"":""Aggregate"",""expressions"":[""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK, WEB_SALES.WS_SOLD_DATE_SK]""],""parentOperators"":[27]},{""id"":32,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[31]},{""id"":33,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[32]},{""id"":34,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_BILL_CUSTOMER_SK""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[33]},{""id"":35,""operation"":""Filter"",""expressions"":[""C.C_CURRENT_CDEMO_SK IS NOT NULL""],""parentOperators"":[24]},{""id"":36,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = C.C_CURRENT_CDEMO_SK)""],""parentOperators"":[35]},{""id"":37,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_CDEMO_SK"",""C_CURRENT_ADDR_SK""],""alias"":""C"",""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[36]},{""id"":38,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[10]},{""id"":39,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[38]},{""id"":40,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2001) AND (DATE_DIM.D_QOY < 4)""],""parentOperators"":[39]},{""id"":41,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[40]},{""id"":42,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[38]},{""id"":43,""operation"":""JoinFilter"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[42]},{""id"":44,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[43]}]]}",01b2e7fb-0002-2d15-0051-ba87000196f2,"explain using json select /* { ""query"":""query35"",""streamId"":0,""querySequence"":47 } */
  ca_state,
  cd_gender,
  cd_marital_status,
  cd_dep_count,
  count(*) cnt1,
  max(cd_dep_count),
  stddev_samp(cd_dep_count),
  stddev_samp(cd_dep_count),
  cd_dep_employed_count,
  count(*) cnt2,
  max(cd_dep_employed_count),
  stddev_samp(cd_dep_employed_count),
  stddev_samp(cd_dep_employed_count),
  cd_dep_college_count,
  count(*) cnt3,
  max(cd_dep_college_count),
  stddev_samp(cd_dep_college_count),
  stddev_samp(cd_dep_college_count)
 from
  customer c,customer_address ca,customer_demographics
 where
  c.c_current_addr_sk = ca.ca_address_sk and
  cd_demo_sk = c.c_current_cdemo_sk and
  exists (select *
          from store_sales,date_dim
          where c.c_customer_sk = ss_customer_sk and
                ss_sold_date_sk = d_date_sk and
                d_year = 2001 and
                d_qoy < 4) and
   (exists (select *
            from web_sales,date_dim
            where c.c_customer_sk = ws_bill_customer_sk and
                  ws_sold_date_sk = d_date_sk and
                  d_year = 2001 and
                  d_qoy < 4) or
    exists (select *
            from catalog_sales,date_dim
            where c.c_customer_sk = cs_ship_customer_sk and
                  cs_sold_date_sk = d_date_sk and
                  d_year = 2001 and
                  d_qoy < 4))
 group by ca_state,
          cd_gender,
          cd_marital_status,
          cd_dep_count,
          cd_dep_employed_count,
          cd_dep_college_count
 order by ca_state,
          cd_gender,
          cd_marital_status,
          cd_dep_count,
          cd_dep_employed_count,
          cd_dep_college_count
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:55.851-07:00,2024-03-10T18:31:57.047-07:00,1196,0,0,1194,2,0,0,0,0,,,0,,,0,0.000183000,0,8.9.2,0,0,0,0,0,FALSE,9d23271c5dd50d01a9eb37893b6e656c,2,6e93e49b73ff0a28bdba24454d6830d4,1
"{""GlobalStats"":{""partitionsTotal"":72722,""partitionsAssigned"":72722,""bytesAssigned"":1251950176768},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""V1.I_BRAND"",""V1.D_YEAR"",""V1.D_MOY"",""V1.AVG_MONTHLY_SALES"",""V1.SUM_SALES"",""V1_LAG.SUM_SALES"",""V1_LEAD.SUM_SALES""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [(V1.SUM_SALES) - V1.AVG_MONTHLY_SALES ASC NULLS LAST, V1.AVG_MONTHLY_SALES ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (V1.RN = (V1_LEAD.RN) - 1) AND (V1.I_BRAND = V1_LEAD.I_BRAND) AND (V1.I_CATEGORY = V1_LEAD.I_CATEGORY) AND (V1.S_COMPANY_NAME = V1_LEAD.S_COMPANY_NAME) AND (V1.S_STORE_NAME = V1_LEAD.S_STORE_NAME)""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: ((V1_LAG.RN) + 1 = V1.RN) AND (V1_LAG.I_BRAND = V1.I_BRAND) AND (V1_LAG.I_CATEGORY = V1.I_CATEGORY) AND (V1_LAG.S_COMPANY_NAME = V1.S_COMPANY_NAME) AND (V1_LAG.S_STORE_NAME = V1.S_STORE_NAME)""],""parentOperators"":[2]},{""id"":4,""operation"":""WithReference"",""expressions"":[""V1_LAG""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""(V1_LAG.I_BRAND IS NOT NULL) AND (V1_LAG.I_CATEGORY IS NOT NULL) AND (V1_LAG.S_COMPANY_NAME IS NOT NULL) AND (V1_LAG.S_STORE_NAME IS NOT NULL)""],""parentOperators"":[4]},{""id"":6,""operation"":""WithClause"",""expressions"":[""V1""],""parentOperators"":[5,25,29]},{""id"":7,""operation"":""WindowFunction"",""expressions"":[""AVG(SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, DATE_DIM.D_YEAR)"",""RANK() OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME ORDER BY DATE_DIM.D_YEAR ASC NULLS LAST, DATE_DIM.D_MOY ASC NULLS LAST)""],""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE))))]"",""groupKeys: [ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, DATE_DIM.D_YEAR, DATE_DIM.D_MOY]""],""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE)))]"",""groupKeys: [ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, DATE_DIM.D_YEAR, DATE_DIM.D_MOY]""],""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME"",""S_COMPANY_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_SALES_PRICE))]"",""groupKeys: [ITEM.I_BRAND, ITEM.I_CATEGORY, DATE_DIM.D_YEAR, DATE_DIM.D_MOY, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[10]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[13]},{""id"":15,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_SALES_PRICE)]"",""groupKeys: [DATE_DIM.D_YEAR, DATE_DIM.D_MOY, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[13]},{""id"":16,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR IN 2000 IN 1999 IN 2001) AND ((DATE_DIM.D_YEAR = 2000) OR ((DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 12)) OR ((DATE_DIM.D_YEAR = 2001) AND (DATE_DIM.D_MOY = 1)))""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[17]},{""id"":19,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[16]},{""id"":20,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_STORE_SK"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[20]},{""id"":22,""operation"":""JoinFilter"",""expressions"":[""joinKey: ((V1_LAG.RN) + 1 = V1.RN) AND (V1_LAG.I_BRAND = V1.I_BRAND) AND (V1_LAG.I_CATEGORY = V1.I_CATEGORY) AND (V1_LAG.S_COMPANY_NAME = V1.S_COMPANY_NAME) AND (V1_LAG.S_STORE_NAME = V1.S_STORE_NAME)""],""parentOperators"":[3]},{""id"":23,""operation"":""WithReference"",""parentOperators"":[22]},{""id"":24,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2000) AND (AVG(SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, DATE_DIM.D_YEAR) > 0) AND ((IFF(AVG(SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, DATE_DIM.D_YEAR) > 0, SCALED_ROUND_INT_DIVIDE(ABS((SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE))))) - AVG(SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, DATE_DIM.D_YEAR)), AVG(SUM(SUM(SUM(SUM(STORE_SALES.SS_SALES_PRICE))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, STORE.S_STORE_NAME, STORE.S_COMPANY_NAME, DATE_DIM.D_YEAR)), null)) > 0.1) AND (V1.I_BRAND IS NOT NULL) AND (V1.I_CATEGORY IS NOT NULL) AND (V1.S_COMPANY_NAME IS NOT NULL) AND (V1.S_STORE_NAME IS NOT NULL)""],""parentOperators"":[23]},{""id"":25,""operation"":""Filter"",""expressions"":[""(V1.I_BRAND IS NOT NULL) AND (V1.I_CATEGORY IS NOT NULL) AND (V1.S_COMPANY_NAME IS NOT NULL) AND (V1.S_STORE_NAME IS NOT NULL)""],""parentOperators"":[24]},{""id"":26,""operation"":""JoinFilter"",""expressions"":[""joinKey: (V1.RN = (V1_LEAD.RN) - 1) AND (V1.I_BRAND = V1_LEAD.I_BRAND) AND (V1.I_CATEGORY = V1_LEAD.I_CATEGORY) AND (V1.S_COMPANY_NAME = V1_LEAD.S_COMPANY_NAME) AND (V1.S_STORE_NAME = V1_LEAD.S_STORE_NAME)""],""parentOperators"":[2]},{""id"":27,""operation"":""WithReference"",""expressions"":[""V1_LEAD""],""parentOperators"":[26]},{""id"":28,""operation"":""Filter"",""expressions"":[""(V1_LEAD.I_BRAND IS NOT NULL) AND (V1_LEAD.I_CATEGORY IS NOT NULL) AND (V1_LEAD.S_COMPANY_NAME IS NOT NULL) AND (V1_LEAD.S_STORE_NAME IS NOT NULL)""],""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""(V1_LEAD.I_BRAND IS NOT NULL) AND (V1_LEAD.I_CATEGORY IS NOT NULL) AND (V1_LEAD.S_COMPANY_NAME IS NOT NULL) AND (V1_LEAD.S_STORE_NAME IS NOT NULL)""],""parentOperators"":[28]}]]}",01b2e7fb-0002-2d15-0051-ba87000196ee,"explain using json with /* { ""query"":""query47"",""streamId"":0,""querySequence"":42 } */ v1 as(
 select i_category, i_brand,
        s_store_name, s_company_name,
        d_year, d_moy,
        sum(ss_sales_price) sum_sales,
        avg(sum(ss_sales_price)) over
          (partition by i_category, i_brand,
                     s_store_name, s_company_name, d_year)
          avg_monthly_sales,
        rank() over
          (partition by i_category, i_brand,
                     s_store_name, s_company_name
           order by d_year, d_moy) rn
 from item, store_sales, date_dim, store
 where ss_item_sk = i_item_sk and
       ss_sold_date_sk = d_date_sk and
       ss_store_sk = s_store_sk and
       (
         d_year = 2000 or
         ( d_year = 2000-1 and d_moy =12) or
         ( d_year = 2000+1 and d_moy =1)
       )
 group by i_category, i_brand,
          s_store_name, s_company_name,
          d_year, d_moy),
 v2 as(
 select v1.i_brand
        ,v1.d_year, v1.d_moy
        ,v1.avg_monthly_sales
        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum
 from v1, v1 v1_lag, v1 v1_lead
 where v1.i_category = v1_lag.i_category and
       v1.i_category = v1_lead.i_category and
       v1.i_brand = v1_lag.i_brand and
       v1.i_brand = v1_lead.i_brand and
       v1.s_store_name = v1_lag.s_store_name and
       v1.s_store_name = v1_lead.s_store_name and
       v1.s_company_name = v1_lag.s_company_name and
       v1.s_company_name = v1_lead.s_company_name and
       v1.rn = v1_lag.rn + 1 and
       v1.rn = v1_lead.rn - 1)
  select  *
 from v2
 where  d_year = 2000 and
        avg_monthly_sales > 0 and
        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1
 order by sum_sales - avg_monthly_sales, avg_monthly_sales
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:51.788-07:00,2024-03-10T18:31:52.237-07:00,449,0,0,448,1,0,0,0,0,,,0,,,0,0.000068000,0,8.9.2,0,0,0,0,0,FALSE,afaccd06f8e80f1bdff5400dea356ce6,2,d115187ca27ab064dec3290e1a630f6f,1
"{""GlobalStats"":{""partitionsTotal"":55164,""partitionsAssigned"":55164,""bytesAssigned"":922085408768},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""(COUNT(*)) / (COUNT(*))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [(AT.AMC) / (PT.PMC) ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""CartesianJoin"",""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = WEB_SALES.WS_SHIP_HDEMO_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [WEB_SALES.WS_SHIP_HDEMO_SK]""],""parentOperators"":[5]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = WEB_SALES.WS_SOLD_TIME_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR >= 14) AND (TIME_DIM.T_HOUR <= 15)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [WEB_SALES.WS_SHIP_HDEMO_SK, WEB_SALES.WS_SOLD_TIME_SK]""],""parentOperators"":[9]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_SALES.WS_WEB_PAGE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""(WEB_PAGE.WP_CHAR_COUNT >= 5000) AND (WEB_PAGE.WP_CHAR_COUNT <= 5200)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_PAGE""],""expressions"":[""WP_WEB_PAGE_SK"",""WP_CHAR_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":63488,""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_SOLD_TIME_SK IS NOT NULL) AND (WEB_SALES.WS_SHIP_HDEMO_SK IS NOT NULL) AND (WEB_SALES.WS_WEB_PAGE_SK IS NOT NULL)""],""parentOperators"":[13]},{""id"":17,""operation"":""JoinFilter"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = WEB_SALES.WS_SHIP_HDEMO_SK)""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_TIME_SK"",""WS_SHIP_HDEMO_SK"",""WS_WEB_PAGE_SK""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[17]},{""id"":19,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[2]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[19]},{""id"":21,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = WEB_SALES.WS_SHIP_HDEMO_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0""],""parentOperators"":[21]},{""id"":23,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[22]},{""id"":24,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [WEB_SALES.WS_SHIP_HDEMO_SK]""],""parentOperators"":[21]},{""id"":25,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = WEB_SALES.WS_SOLD_TIME_SK)""],""parentOperators"":[24]},{""id"":26,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR >= 8) AND (TIME_DIM.T_HOUR <= 9)""],""parentOperators"":[25]},{""id"":27,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[26]},{""id"":28,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [WEB_SALES.WS_SHIP_HDEMO_SK, WEB_SALES.WS_SOLD_TIME_SK]""],""parentOperators"":[25]},{""id"":29,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_SALES.WS_WEB_PAGE_SK)""],""parentOperators"":[28]},{""id"":30,""operation"":""Filter"",""expressions"":[""(WEB_PAGE.WP_CHAR_COUNT >= 5000) AND (WEB_PAGE.WP_CHAR_COUNT <= 5200)""],""parentOperators"":[29]},{""id"":31,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_PAGE""],""expressions"":[""WP_WEB_PAGE_SK"",""WP_CHAR_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":63488,""parentOperators"":[30]},{""id"":32,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_SOLD_TIME_SK IS NOT NULL) AND (WEB_SALES.WS_SHIP_HDEMO_SK IS NOT NULL) AND (WEB_SALES.WS_WEB_PAGE_SK IS NOT NULL)""],""parentOperators"":[29]},{""id"":33,""operation"":""JoinFilter"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = WEB_SALES.WS_SHIP_HDEMO_SK)""],""parentOperators"":[32]},{""id"":34,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_TIME_SK"",""WS_SHIP_HDEMO_SK"",""WS_WEB_PAGE_SK""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[33]}]]}",01b2e7fb-0002-300b-0051-ba870002c08e,"explain using json select /* { ""query"":""query90"",""streamId"":0,""querySequence"":40 } */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio
 from ( select count(*) amc
       from web_sales, household_demographics , time_dim, web_page
       where ws_sold_time_sk = time_dim.t_time_sk
         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
         and ws_web_page_sk = web_page.wp_web_page_sk
         and time_dim.t_hour between 8 and 8+1
         and household_demographics.hd_dep_count = 0
         and web_page.wp_char_count between 5000 and 5200) at,
      ( select count(*) pmc
       from web_sales, household_demographics , time_dim, web_page
       where ws_sold_time_sk = time_dim.t_time_sk
         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
         and ws_web_page_sk = web_page.wp_web_page_sk
         and time_dim.t_hour between 14 and 14+1
         and household_demographics.hd_dep_count = 0
         and web_page.wp_char_count between 5000 and 5200) pt
 order by am_pm_ratio
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:49.789-07:00,2024-03-10T18:31:50.183-07:00,394,0,0,393,1,0,0,0,0,,,0,,,0,0.000060000,0,8.9.2,0,0,0,0,0,FALSE,f1e6ddfc113383964c61d4002185834f,2,df549f2464c689c34fcf31a55730b82c,1
"{""GlobalStats"":{""partitionsTotal"":127642,""partitionsAssigned"":127642,""bytesAssigned"":2175545843712},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SUM(IFF((SYS_VW.CUSTOMER_SK_0 IS NOT NULL) AND (SYS_VW.CUSTOMER_SK_0 IS NULL), 1, 0))"",""SUM(IFF((SYS_VW.CUSTOMER_SK_0 IS NULL) AND (SYS_VW.CUSTOMER_SK_0 IS NOT NULL), 1, 0))"",""SUM(IFF((SYS_VW.CUSTOMER_SK_0 IS NOT NULL) AND (SYS_VW.CUSTOMER_SK_0 IS NOT NULL), 1, 0))""]},{""id"":1,""operation"":""Limit"",""expressions"":[""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFF((SYS_VW.CUSTOMER_SK_0 IS NOT NULL) AND (SYS_VW.CUSTOMER_SK_0 IS NULL), 1, 0)), SUM(IFF((SYS_VW.CUSTOMER_SK_0 IS NULL) AND (SYS_VW.CUSTOMER_SK_0 IS NOT NULL), 1, 0)), SUM(IFF((SYS_VW.CUSTOMER_SK_0 IS NOT NULL) AND (SYS_VW.CUSTOMER_SK_0 IS NOT NULL), 1, 0))]""],""parentOperators"":[1]},{""id"":3,""operation"":""FullOuterJoin"",""expressions"":[""joinKey: (SYS_VW.CUSTOMER_SK_0 = SYS_VW.CUSTOMER_SK_0) AND (SYS_VW.ITEM_SK_1 = SYS_VW.ITEM_SK_1)""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1206) AND (DATE_DIM.D_MONTH_SEQ <= 1217)""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""groupKeys: [STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[6]},{""id"":11,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[10]},{""id"":12,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_CUSTOMER_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_BILL_CUSTOMER_SK, CATALOG_SALES.CS_ITEM_SK]""],""parentOperators"":[3]},{""id"":15,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_BILL_CUSTOMER_SK, CATALOG_SALES.CS_ITEM_SK]""],""parentOperators"":[14]},{""id"":16,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[15]},{""id"":17,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1206) AND (DATE_DIM.D_MONTH_SEQ <= 1217)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[18]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""groupKeys: [CATALOG_SALES.CS_BILL_CUSTOMER_SK, CATALOG_SALES.CS_ITEM_SK, CATALOG_SALES.CS_SOLD_DATE_SK]""],""parentOperators"":[16]},{""id"":21,""operation"":""Filter"",""expressions"":[""CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[20]},{""id"":22,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[21]},{""id"":23,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_ITEM_SK""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[22]}]]}",01b2e7fb-0002-2e24-0051-ba870001d1e2,"explain using json with /* { ""query"":""query97"",""streamId"":0,""querySequence"":38 } */ ssci as (
select ss_customer_sk customer_sk
      ,ss_item_sk item_sk
from store_sales,date_dim
where ss_sold_date_sk = d_date_sk
  and d_month_seq between 1206 and 1206 + 11
group by ss_customer_sk
        ,ss_item_sk),
csci as(
 select cs_bill_customer_sk customer_sk
      ,cs_item_sk item_sk
from catalog_sales,date_dim
where cs_sold_date_sk = d_date_sk
  and d_month_seq between 1206 and 1206 + 11
group by cs_bill_customer_sk
        ,cs_item_sk)
 select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only
      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only
      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog
from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk
                               and ssci.item_sk = csci.item_sk)
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:47.141-07:00,2024-03-10T18:31:47.506-07:00,365,0,0,364,1,0,0,0,0,,,0,,,0,0.000056000,0,8.9.2,0,0,0,0,0,FALSE,4a858739bad4ec1d607986a68733ca01,2,4a858739bad4ec1d607986a68733ca01,1
"{""GlobalStats"":{""partitionsTotal"":145440,""partitionsAssigned"":145440,""bytesAssigned"":2503852730368},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))"",""STORE.S_STATE"",""STORE.S_COUNTY"",""(GROUPING_ID(STORE.S_STATE)) + (GROUPING_ID(STORE.S_COUNTY))"",""RANK() OVER (PARTITION BY (GROUPING_ID(STORE.S_STATE)) + (GROUPING_ID(STORE.S_COUNTY)), IFF((GROUPING_ID(STORE.S_COUNTY)) = 0, STORE.S_STATE, null) ORDER BY SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))) DESC NULLS FIRST)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [(GROUPING_ID(STORE.S_STATE)) + (GROUPING_ID(STORE.S_COUNTY)) DESC NULLS FIRST, IFF(((GROUPING_ID(STORE.S_STATE)) + (GROUPING_ID(STORE.S_COUNTY))) = 0, STORE.S_STATE, null) ASC NULLS LAST, RANK() OVER (PARTITION BY (GROUPING_ID(STORE.S_STATE)) + (GROUPING_ID(STORE.S_COUNTY)), IFF((GROUPING_ID(STORE.S_COUNTY)) = 0, STORE.S_STATE, null) ORDER BY SUM(STORE_SALES.SS_NET_PROFIT) DESC NULLS FIRST) ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""WindowFunction"",""expressions"":[""RANK() OVER (PARTITION BY (GROUPING_ID(STORE.S_STATE)) + (GROUPING_ID(STORE.S_COUNTY)), IFF((GROUPING_ID(STORE.S_COUNTY)) = 0, STORE.S_STATE, null) ORDER BY SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))) DESC NULLS FIRST)"",""RANK() OVER (PARTITION BY (GROUPING_ID(STORE.S_STATE)) + (GROUPING_ID(STORE.S_COUNTY)), IFF((GROUPING_ID(STORE.S_COUNTY)) = 0, STORE.S_STATE, null) ORDER BY SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))) DESC NULLS FIRST)""],""parentOperators"":[1]},{""id"":3,""operation"":""GroupingSets"",""expressions"":[""SUM(STORE_SALES.SS_NET_PROFIT)"",""SUM(STORE_SALES.SS_NET_PROFIT)"",""SUM(STORE_SALES.SS_NET_PROFIT)""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))]"",""groupKeys: [STORE.S_STATE, STORE.S_COUNTY]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_NET_PROFIT))]"",""groupKeys: [STORE.S_STATE, STORE.S_COUNTY]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D1.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""(D1.D_MONTH_SEQ >= 1219) AND (D1.D_MONTH_SEQ <= 1230)""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""alias"":""D1"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_NET_PROFIT)]"",""groupKeys: [STORE.S_COUNTY, STORE.S_STATE, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[6]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""SemiJoin"",""expressions"":[""joinKey: (STORE.S_STATE = STORE.S_STATE)""],""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""groupKeys: [STORE.S_STATE]""],""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""RANK() OVER (PARTITION BY STORE.S_STATE ORDER BY SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))) DESC NULLS FIRST) <= 5""],""parentOperators"":[12]},{""id"":14,""operation"":""WindowFunction"",""expressions"":[""RANK() OVER (PARTITION BY STORE.S_STATE ORDER BY SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))) DESC NULLS FIRST)""],""parentOperators"":[13]},{""id"":15,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))]"",""groupKeys: [STORE.S_STATE]""],""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_NET_PROFIT))]"",""groupKeys: [STORE.S_STATE]""],""parentOperators"":[15]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""STORE.S_STATE IS NOT NULL""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[18]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_NET_PROFIT)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[17]},{""id"":21,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1219) AND (DATE_DIM.D_MONTH_SEQ <= 1230)""],""parentOperators"":[21]},{""id"":23,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[22]},{""id"":24,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[21]},{""id"":25,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[24]},{""id"":26,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_STORE_SK"",""SS_NET_PROFIT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[25]},{""id"":27,""operation"":""Filter"",""expressions"":[""STORE.S_STATE IS NOT NULL""],""parentOperators"":[11]},{""id"":28,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STATE = STORE.S_STATE)""],""parentOperators"":[27]},{""id"":29,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_COUNTY"",""S_STATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[28]},{""id"":30,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[10]},{""id"":31,""operation"":""JoinFilter"",""expressions"":[""joinKey: (D1.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[30]},{""id"":32,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_STORE_SK"",""SS_NET_PROFIT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[31]}]]}",01b2e7fb-0002-2ff0-0051-ba870003003e,"explain using json select /* { ""query"":""query70"",""streamId"":0,""querySequence"":34 } */
    sum(ss_net_profit) as total_sum
   ,s_state
   ,s_county
   ,grouping(s_state)+grouping(s_county) as lochierarchy
   ,rank() over (
 	partition by grouping(s_state)+grouping(s_county),
 	case when grouping(s_county) = 0 then s_state end
 	order by sum(ss_net_profit) desc) as rank_within_parent
 from
    store_sales
   ,date_dim       d1
   ,store
 where
    d1.d_month_seq between 1219 and 1219+11
 and d1.d_date_sk = ss_sold_date_sk
 and s_store_sk  = ss_store_sk
 and s_state in
             ( select s_state
               from  (select s_state as s_state,
 			    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking
                      from   store_sales, store, date_dim
                      where  d_month_seq between 1219 and 1219+11
 			    and d_date_sk = ss_sold_date_sk
 			    and s_store_sk  = ss_store_sk
                      group by s_state
                     ) tmp1
               where ranking <= 5
             )
 group by rollup(s_state,s_county)
 order by
   lochierarchy desc
  ,case when lochierarchy = 0 then s_state end
  ,rank_within_parent
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:43.927-07:00,2024-03-10T18:31:44.466-07:00,539,0,0,537,2,0,0,0,0,,,0,,,0,0.000082000,0,8.9.2,0,0,0,0,0,FALSE,82ff4ad718cf0aa0297321a4891af0d4,2,8a8e54465b6e6d48ccd7f51dd3acb111,1
"{""GlobalStats"":{""partitionsTotal"":30129,""partitionsAssigned"":30124,""bytesAssigned"":500899529728},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SUBSTR(REASON.R_REASON_DESC, 1, 20)"",""SCALED_ROUND_INT_DIVIDE(SUM(SUM(SUM(WEB_SALES.WS_QUANTITY))), COUNT(COUNT(COUNT(WEB_SALES.WS_QUANTITY))))"",""(SUM(SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH)))) / (COUNT(COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH))))"",""(SUM(SUM(SUM(WEB_RETURNS.WR_FEE)))) / (COUNT(COUNT(COUNT(WEB_RETURNS.WR_FEE))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [SUBSTR(REASON.R_REASON_DESC, 1, 20) ASC NULLS LAST, SCALED_ROUND_INT_DIVIDE(SUM(WEB_SALES.WS_QUANTITY), COUNT(WEB_SALES.WS_QUANTITY)) ASC NULLS LAST, (SUM(WEB_RETURNS.WR_REFUNDED_CASH)) / (COUNT(WEB_RETURNS.WR_REFUNDED_CASH)) ASC NULLS LAST, (SUM(WEB_RETURNS.WR_FEE)) / (COUNT(WEB_RETURNS.WR_FEE)) ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(WEB_SALES.WS_QUANTITY))), COUNT(COUNT(COUNT(WEB_SALES.WS_QUANTITY))), SUM(SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH))), COUNT(COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH))), SUM(SUM(SUM(WEB_RETURNS.WR_FEE))), COUNT(COUNT(COUNT(WEB_RETURNS.WR_FEE)))]"",""groupKeys: [REASON.R_REASON_DESC]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(WEB_SALES.WS_QUANTITY)), COUNT(COUNT(WEB_SALES.WS_QUANTITY)), SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH)), COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH)), SUM(SUM(WEB_RETURNS.WR_FEE)), COUNT(COUNT(WEB_RETURNS.WR_FEE))]"",""groupKeys: [REASON.R_REASON_DESC]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS) AND (CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS) AND (WEB_RETURNS.WR_RETURNING_CDEMO_SK = CD2.CD_DEMO_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_QUANTITY), COUNT(WEB_SALES.WS_QUANTITY), SUM(WEB_RETURNS.WR_REFUNDED_CASH), COUNT(WEB_RETURNS.WR_REFUNDED_CASH), SUM(WEB_RETURNS.WR_FEE), COUNT(WEB_RETURNS.WR_FEE)]"",""groupKeys: [REASON.R_REASON_DESC, CD1.CD_MARITAL_STATUS, CD1.CD_EDUCATION_STATUS, WEB_RETURNS.WR_RETURNING_CDEMO_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (REASON.R_REASON_SK = WEB_RETURNS.WR_REASON_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.REASON""],""expressions"":[""R_REASON_SK"",""R_REASON_DESC""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2560,""parentOperators"":[6]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_SALES.WS_WEB_PAGE_SK)""],""parentOperators"":[6]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_PAGE""],""expressions"":[""WP_WEB_PAGE_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":63488,""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[8]},{""id"":11,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 1999""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[11]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CD1.CD_DEMO_SK = WEB_RETURNS.WR_REFUNDED_CDEMO_SK)"",""joinFilter: ((CD1.CD_MARITAL_STATUS = 'U') AND (CD1.CD_EDUCATION_STATUS = 'Secondary') AND ((WEB_SALES.WS_SALES_PRICE >= 100) AND (WEB_SALES.WS_SALES_PRICE <= 150))) OR ((CD1.CD_MARITAL_STATUS = 'D') AND (CD1.CD_EDUCATION_STATUS = 'Advanced Degree') AND ((WEB_SALES.WS_SALES_PRICE >= 50) AND (WEB_SALES.WS_SALES_PRICE <= 100))) OR ((CD1.CD_MARITAL_STATUS = 'S') AND (CD1.CD_EDUCATION_STATUS = 'Unknown') AND ((WEB_SALES.WS_SALES_PRICE >= 150) AND (WEB_SALES.WS_SALES_PRICE <= 200)))""],""parentOperators"":[10]},{""id"":14,""operation"":""Filter"",""expressions"":[""(CD1.CD_MARITAL_STATUS IN 'U' IN 'D' IN 'S') AND (CD1.CD_EDUCATION_STATUS IN 'Secondary' IN 'Advanced Degree' IN 'Unknown')""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_MARITAL_STATUS"",""CD_EDUCATION_STATUS""],""alias"":""CD1"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[14]},{""id"":16,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WEB_RETURNS.WR_ITEM_SK = WEB_SALES.WS_ITEM_SK) AND (WEB_RETURNS.WR_ORDER_NUMBER = WEB_SALES.WS_ORDER_NUMBER)"",""joinFilter: ((CUSTOMER_ADDRESS.CA_STATE IN 'OK' IN 'NC' IN 'TN') AND ((WEB_SALES.WS_NET_PROFIT >= 100) AND (WEB_SALES.WS_NET_PROFIT <= 200))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'IA' IN 'MO' IN 'IL') AND ((WEB_SALES.WS_NET_PROFIT >= 150) AND (WEB_SALES.WS_NET_PROFIT <= 300))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'MN' IN 'MT' IN 'WI') AND ((WEB_SALES.WS_NET_PROFIT >= 50) AND (WEB_SALES.WS_NET_PROFIT <= 250)))""],""parentOperators"":[13]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = WEB_RETURNS.WR_REFUNDED_ADDR_SK)""],""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""(CUSTOMER_ADDRESS.CA_COUNTRY = 'United States') AND ((CUSTOMER_ADDRESS.CA_STATE IN 'OK' IN 'NC' IN 'TN') OR (CUSTOMER_ADDRESS.CA_STATE IN 'IA' IN 'MO' IN 'IL') OR (CUSTOMER_ADDRESS.CA_STATE IN 'MN' IN 'MT' IN 'WI'))""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE"",""CA_COUNTRY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""(WEB_RETURNS.WR_REFUNDED_ADDR_SK IS NOT NULL) AND (WEB_RETURNS.WR_RETURNING_CDEMO_SK IS NOT NULL) AND (WEB_RETURNS.WR_REFUNDED_CDEMO_SK IS NOT NULL) AND (WEB_RETURNS.WR_REASON_SK IS NOT NULL)""],""parentOperators"":[17]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (REASON.R_REASON_SK = WEB_RETURNS.WR_REASON_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_RETURNS""],""expressions"":[""WR_ITEM_SK"",""WR_REFUNDED_CDEMO_SK"",""WR_REFUNDED_ADDR_SK"",""WR_RETURNING_CDEMO_SK"",""WR_REASON_SK"",""WR_ORDER_NUMBER"",""WR_FEE"",""WR_REFUNDED_CASH""],""partitionsAssigned"":2289,""partitionsTotal"":2289,""bytesAssigned"":39149218304,""parentOperators"":[21]},{""id"":23,""operation"":""Filter"",""expressions"":[""((WEB_SALES.WS_SALES_PRICE >= 100) OR (WEB_SALES.WS_SALES_PRICE >= 50) OR (WEB_SALES.WS_SALES_PRICE <= 100) OR (WEB_SALES.WS_SALES_PRICE >= 150) OR (WEB_SALES.WS_SALES_PRICE <= 200)) AND ((WEB_SALES.WS_SALES_PRICE <= 150) OR (WEB_SALES.WS_SALES_PRICE >= 50) OR (WEB_SALES.WS_SALES_PRICE <= 100) OR (WEB_SALES.WS_SALES_PRICE >= 150) OR (WEB_SALES.WS_SALES_PRICE <= 200)) AND ((WEB_SALES.WS_NET_PROFIT >= 100) OR (WEB_SALES.WS_NET_PROFIT >= 150) OR (WEB_SALES.WS_NET_PROFIT <= 300) OR (WEB_SALES.WS_NET_PROFIT >= 50) OR (WEB_SALES.WS_NET_PROFIT <= 250)) AND ((WEB_SALES.WS_NET_PROFIT <= 200) OR (WEB_SALES.WS_NET_PROFIT >= 150) OR (WEB_SALES.WS_NET_PROFIT <= 300) OR (WEB_SALES.WS_NET_PROFIT >= 50) OR (WEB_SALES.WS_NET_PROFIT <= 250)) AND (WEB_SALES.WS_WEB_PAGE_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[16]},{""id"":24,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_SALES.WS_WEB_PAGE_SK)""],""parentOperators"":[23]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_WEB_PAGE_SK"",""WS_ORDER_NUMBER"",""WS_QUANTITY"",""WS_SALES_PRICE"",""WS_NET_PROFIT""],""partitionsAssigned"":27574,""partitionsTotal"":27579,""bytesAssigned"":460956759040,""parentOperators"":[24]},{""id"":26,""operation"":""Filter"",""expressions"":[""(CD2.CD_MARITAL_STATUS IN 'U' IN 'D' IN 'S') AND (CD2.CD_EDUCATION_STATUS IN 'Secondary' IN 'Advanced Degree' IN 'Unknown')""],""parentOperators"":[4]},{""id"":27,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS) AND (CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS) AND (WEB_RETURNS.WR_RETURNING_CDEMO_SK = CD2.CD_DEMO_SK)""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_MARITAL_STATUS"",""CD_EDUCATION_STATUS""],""alias"":""CD2"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[27]}]]}",01b2e7fb-0002-2e24-0051-ba870001d1de,"explain using json select /* { ""query"":""query85"",""streamId"":0,""querySequence"":33 } */  substr(r_reason_desc,1,20)
       ,avg(ws_quantity)
       ,avg(wr_refunded_cash)
       ,avg(wr_fee)
 from web_sales, web_returns, web_page, customer_demographics cd1,
      customer_demographics cd2, customer_address, date_dim, reason
 where ws_web_page_sk = wp_web_page_sk
   and ws_item_sk = wr_item_sk
   and ws_order_number = wr_order_number
   and ws_sold_date_sk = d_date_sk and d_year = 1999
   and cd1.cd_demo_sk = wr_refunded_cdemo_sk
   and cd2.cd_demo_sk = wr_returning_cdemo_sk
   and ca_address_sk = wr_refunded_addr_sk
   and r_reason_sk = wr_reason_sk
   and
   (
    (
     cd1.cd_marital_status = 'U'
     and
     cd1.cd_marital_status = cd2.cd_marital_status
     and
     cd1.cd_education_status = 'Secondary'
     and
     cd1.cd_education_status = cd2.cd_education_status
     and
     ws_sales_price between 100.00 and 150.00
    )
   or
    (
     cd1.cd_marital_status = 'D'
     and
     cd1.cd_marital_status = cd2.cd_marital_status
     and
     cd1.cd_education_status = 'Advanced Degree'
     and
     cd1.cd_education_status = cd2.cd_education_status
     and
     ws_sales_price between 50.00 and 100.00
    )
   or
    (
     cd1.cd_marital_status = 'S'
     and
     cd1.cd_marital_status = cd2.cd_marital_status
     and
     cd1.cd_education_status = 'Unknown'
     and
     cd1.cd_education_status = cd2.cd_education_status
     and
     ws_sales_price between 150.00 and 200.00
    )
   )
   and
   (
    (
     ca_country = 'United States'
     and
     ca_state in ('OK', 'NC', 'TN')
     and ws_net_profit between 100 and 200
    )
    or
    (
     ca_country = 'United States'
     and
     ca_state in ('IA', 'MO', 'IL')
     and ws_net_profit between 150 and 300
    )
    or
    (
     ca_country = 'United States'
     and
     ca_state in ('MN', 'MT', 'WI')
     and ws_net_profit between 50 and 250
    )
   )
group by r_reason_desc
order by substr(r_reason_desc,1,20)
        ,avg(ws_quantity)
        ,avg(wr_refunded_cash)
        ,avg(wr_fee)
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:42.03-07:00,2024-03-10T18:31:43.448-07:00,1418,0,0,1416,2,0,0,0,0,,,0,,,0,0.000216000,0,8.9.2,0,0,0,0,0,FALSE,7a39c465ad042819f2e36c9ece9ede04,2,2d95496aa5be68bc04a0f33f7e3d7f9d,1
"{""GlobalStats"":{""partitionsTotal"":72723,""partitionsAssigned"":72723,""bytesAssigned"":1251930778112},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""STORE.S_STORE_NAME"",""STORE.S_STORE_ID"",""WSS.D_WEEK_SEQ"",""(WSS.SUN_SALES) / (WSS_0.SUN_SALES)"",""(WSS.MON_SALES) / (WSS_0.MON_SALES)"",""(WSS.TUE_SALES) / (WSS_0.TUE_SALES)"",""(WSS.WED_SALES) / (WSS_0.WED_SALES)"",""(WSS.THU_SALES) / (WSS_0.THU_SALES)"",""(WSS.FRI_SALES) / (WSS_0.FRI_SALES)"",""(WSS.SAT_SALES) / (WSS_0.SAT_SALES)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [STORE.S_STORE_NAME ASC NULLS LAST, STORE.S_STORE_ID ASC NULLS LAST, WSS.D_WEEK_SEQ ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D_0.D_WEEK_SEQ = WSS_0.D_WEEK_SEQ)""],""parentOperators"":[1]},{""id"":3,""operation"":""Filter"",""expressions"":[""(D_0.D_MONTH_SEQ >= 1189) AND (D_0.D_MONTH_SEQ <= 1200)""],""parentOperators"":[2]},{""id"":4,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_MONTH_SEQ"",""D_WEEK_SEQ""],""alias"":""D_0"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WSS_0.D_WEEK_SEQ - 52 = WSS.D_WEEK_SEQ) AND (WSS_0.SS_STORE_SK = STORE_0.S_STORE_SK)""],""parentOperators"":[2]},{""id"":6,""operation"":""JoinFilter"",""expressions"":[""joinKey: (D_0.D_WEEK_SEQ = WSS_0.D_WEEK_SEQ)""],""parentOperators"":[5]},{""id"":7,""operation"":""WithReference"",""expressions"":[""WSS_0""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""WSS_0.SS_STORE_SK IS NOT NULL""],""parentOperators"":[7]},{""id"":9,""operation"":""WithClause"",""expressions"":[""WSS""],""parentOperators"":[8,29]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFF(DATE_DIM.D_DAY_NAME = 'Sunday', STORE_SALES.SS_SALES_PRICE, null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Monday', STORE_SALES.SS_SALES_PRICE, null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Tuesday', STORE_SALES.SS_SALES_PRICE, null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Wednesday', STORE_SALES.SS_SALES_PRICE, null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Thursday', STORE_SALES.SS_SALES_PRICE, null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Friday', STORE_SALES.SS_SALES_PRICE, null)), SUM(IFF(DATE_DIM.D_DAY_NAME = 'Saturday', STORE_SALES.SS_SALES_PRICE, null))]"",""groupKeys: [DATE_DIM.D_WEEK_SEQ, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[9]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_WEEK_SEQ"",""D_DAY_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[11]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_STORE_SK"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[14]},{""id"":16,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WSS_0.D_WEEK_SEQ - 52 = WSS.D_WEEK_SEQ) AND (WSS_0.SS_STORE_SK = STORE_0.S_STORE_SK)""],""parentOperators"":[5]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_0.S_STORE_ID = STORE.S_STORE_ID)""],""parentOperators"":[16]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WSS_0.D_WEEK_SEQ - 52 = WSS.D_WEEK_SEQ) AND (WSS_0.SS_STORE_SK = STORE_0.S_STORE_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_ID""],""alias"":""STORE_0"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[18]},{""id"":20,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = WSS.SS_STORE_SK)""],""parentOperators"":[17]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE_0.S_STORE_ID = STORE.S_STORE_ID)""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_ID"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[21]},{""id"":23,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D.D_WEEK_SEQ = WSS.D_WEEK_SEQ)""],""parentOperators"":[20]},{""id"":24,""operation"":""Filter"",""expressions"":[""(D.D_MONTH_SEQ >= 1177) AND (D.D_MONTH_SEQ <= 1188)""],""parentOperators"":[23]},{""id"":25,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WSS_0.D_WEEK_SEQ - 52 = WSS.D_WEEK_SEQ) AND (WSS_0.SS_STORE_SK = STORE_0.S_STORE_SK)""],""parentOperators"":[24]},{""id"":26,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_MONTH_SEQ"",""D_WEEK_SEQ""],""alias"":""D"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[25]},{""id"":27,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WSS_0.D_WEEK_SEQ - 52 = WSS.D_WEEK_SEQ) AND (WSS_0.SS_STORE_SK = STORE_0.S_STORE_SK)""],""parentOperators"":[23]},{""id"":28,""operation"":""WithReference"",""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""WSS.SS_STORE_SK IS NOT NULL""],""parentOperators"":[28]}]]}",01b2e7fb-0002-2d15-0051-ba87000196de,"explain using json with /* { ""query"":""query59"",""streamId"":0,""querySequence"":30 } */ wss as
 (select d_week_seq,
        ss_store_sk,
        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales
 from store_sales,date_dim
 where d_date_sk = ss_sold_date_sk
 group by d_week_seq,ss_store_sk
 )
  select  s_store_name1,s_store_id1,d_week_seq1
       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2
       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2
       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2
 from
 (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1
        ,s_store_id s_store_id1,sun_sales sun_sales1
        ,mon_sales mon_sales1,tue_sales tue_sales1
        ,wed_sales wed_sales1,thu_sales thu_sales1
        ,fri_sales fri_sales1,sat_sales sat_sales1
  from wss,store,date_dim d
  where d.d_week_seq = wss.d_week_seq and
        ss_store_sk = s_store_sk and
        d_month_seq between 1177 and 1177 + 11) y,
 (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2
        ,s_store_id s_store_id2,sun_sales sun_sales2
        ,mon_sales mon_sales2,tue_sales tue_sales2
        ,wed_sales wed_sales2,thu_sales thu_sales2
        ,fri_sales fri_sales2,sat_sales sat_sales2
  from wss,store,date_dim d
  where d.d_week_seq = wss.d_week_seq and
        ss_store_sk = s_store_sk and
        d_month_seq between 1177+ 12 and 1177 + 23) x
 where s_store_id1=s_store_id2
   and d_week_seq1=d_week_seq2-52
 order by s_store_name1,s_store_id1,d_week_seq1
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:39.234-07:00,2024-03-10T18:31:39.945-07:00,711,0,0,710,1,0,0,0,0,,,0,,,0,0.000109000,0,8.9.2,0,0,0,0,0,FALSE,f0b3e4913834e86596f78b8bf879ac5f,2,f0b3e4913834e86596f78b8bf879ac5f,1
"{""GlobalStats"":{""partitionsTotal"":72722,""partitionsAssigned"":70416,""bytesAssigned"":1212654344192},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_MANAGER_ID"",""SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))"",""AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANAGER_ID)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [TMP1.I_MANAGER_ID ASC NULLS LAST, TMP1.AVG_MONTHLY_SALES ASC NULLS LAST, TMP1.SUM_SALES ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(IFF(AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANAGER_ID) > 0, SCALED_ROUND_INT_DIVIDE(ABS((SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) - AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANAGER_ID)), AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANAGER_ID)), null)) > 0.1""],""parentOperators"":[1]},{""id"":3,""operation"":""WindowFunction"",""expressions"":[""AVG(SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))) OVER (PARTITION BY ITEM.I_MANAGER_ID)""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))))]"",""groupKeys: [ITEM.I_MANAGER_ID, DATE_DIM.D_MOY]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*))))]"",""groupKeys: [ITEM.I_MANAGER_ID, DATE_DIM.D_MOY]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_MONTH_SEQ IN 1186 IN 1187 IN 1188 IN 1189 IN 1190 IN 1191 IN 1192 IN 1193 IN 1194 IN 1195 IN 1196 IN 1197""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*)))]"",""groupKeys: [ITEM.I_MANAGER_ID, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[6]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(STORE_SALES.SS_SALES_PRICE, COUNT(*))]"",""groupKeys: [ITEM.I_MANAGER_ID, STORE_SALES.SS_SOLD_DATE_SK, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[10]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_MANAGER_ID]""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""((ITEM.I_CATEGORY IN 'Books' IN 'Children' IN 'Electronics') OR (ITEM.I_CATEGORY IN 'Women' IN 'Music' IN 'Men')) AND ((ITEM.I_CLASS IN 'personal' IN 'portable' IN 'reference' IN 'self-help') OR (ITEM.I_CLASS IN 'accessories' IN 'classical' IN 'fragrances' IN 'pants')) AND ((ITEM.I_BRAND IN 'scholaramalgamalg #14' IN 'scholaramalgamalg #7' IN 'exportiunivamalg #9' IN 'scholaramalgamalg #9') OR (ITEM.I_BRAND IN 'amalgimporto #1' IN 'edu packscholar #1' IN 'exportiimporto #1' IN 'importoamalg #1')) AND (((ITEM.I_CATEGORY IN 'Books' IN 'Children' IN 'Electronics') AND (ITEM.I_CLASS IN 'personal' IN 'portable' IN 'reference' IN 'self-help') AND (ITEM.I_BRAND IN 'scholaramalgamalg #14' IN 'scholaramalgamalg #7' IN 'exportiunivamalg #9' IN 'scholaramalgamalg #9')) OR ((ITEM.I_CATEGORY IN 'Women' IN 'Music' IN 'Men') AND (ITEM.I_CLASS IN 'accessories' IN 'classical' IN 'fragrances' IN 'pants') AND (ITEM.I_BRAND IN 'amalgimporto #1' IN 'edu packscholar #1' IN 'exportiimporto #1' IN 'importo...""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND"",""I_CLASS"",""I_CATEGORY"",""I_MANAGER_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[13]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_STORE_SK"",""SS_SALES_PRICE""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[18]}]]}",01b2e7fb-0002-2fe3-0051-ba870002e03e,"explain using json select /* { ""query"":""query63"",""streamId"":0,""querySequence"":27 } */  *
from (select i_manager_id
             ,sum(ss_sales_price) sum_sales
             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales
      from item
          ,store_sales
          ,date_dim
          ,store
      where ss_item_sk = i_item_sk
        and ss_sold_date_sk = d_date_sk
        and ss_store_sk = s_store_sk
        and d_month_seq in (1186,1186+1,1186+2,1186+3,1186+4,1186+5,1186+6,1186+7,1186+8,1186+9,1186+10,1186+11)
        and ((    i_category in ('Books','Children','Electronics')
              and i_class in ('personal','portable','reference','self-help')
              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',
		                  'exportiunivamalg #9','scholaramalgamalg #9'))
           or(    i_category in ('Women','Music','Men')
              and i_class in ('accessories','classical','fragrances','pants')
              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',
		                 'importoamalg #1')))
group by i_manager_id, d_moy) tmp1
where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1
order by i_manager_id
        ,avg_monthly_sales
        ,sum_sales
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:34.426-07:00,2024-03-10T18:31:34.889-07:00,463,0,0,461,2,0,0,0,0,,,0,,,0,0.000071000,0,8.9.2,0,0,0,0,0,FALSE,d57a3b547a5cff06d078b4fe910825ed,2,d7d41b6aee92583e1e93be24be1c1fa4,1
"{""GlobalStats"":{""partitionsTotal"":196922,""partitionsAssigned"":194186,""bytesAssigned"":3297448509952},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""X.CHANNEL"",""UNION_ALL('store' || STORE.S_STORE_ID, 'catalog_page' || CATALOG_PAGE.CP_CATALOG_PAGE_ID, 'web_site' || WEB_SITE.WEB_SITE_ID)"",""SUM(UNION_ALL(SUM(SUM(SUM(UNION_ALL(STORE_SALES.SS_EXT_SALES_PRICE, 0)))), SUM(SUM(SUM(UNION_ALL(CATALOG_SALES.CS_EXT_SALES_PRICE, 0)))), SUM(SUM(SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, 0))))))"",""SUM(UNION_ALL(SUM(SUM(SUM(UNION_ALL(0, STORE_RETURNS.SR_RETURN_AMT)))), SUM(SUM(SUM(UNION_ALL(0, CATALOG_RETURNS.CR_RETURN_AMOUNT)))), SUM(SUM(SUM(UNION_ALL(0, WEB_RETURNS.WR_RETURN_AMT))))))"",""SUM(UNION_ALL((SUM(SUM(SUM(UNION_ALL(STORE_SALES.SS_NET_PROFIT, 0))))) - (SUM(SUM(SUM(UNION_ALL(0, STORE_RETURNS.SR_NET_LOSS))))), (SUM(SUM(SUM(UNION_ALL(CATALOG_SALES.CS_NET_PROFIT, 0))))) - (SUM(SUM(SUM(UNION_ALL(0, CATALOG_RETURNS.CR_NET_LOSS))))), (SUM(SUM(SUM(UNION_ALL(WEB_SALES.WS_NET_PROFIT, 0))))) - (SUM(SUM(SUM(UNION_ALL(0, WEB_RETURNS.WR_NET_LOSS)))))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [X.CHANNEL ASC NULLS LAST, X.ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""GroupingSets"",""expressions"":[""SUM(X.SALES)"",""SUM(X.RETURNS)"",""SUM(X.PROFIT)""],""parentOperators"":[1]},{""id"":3,""operation"":""UnionAll"",""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(UNION_ALL(STORE_SALES.SS_EXT_SALES_PRICE, 0)))), SUM(SUM(SUM(UNION_ALL(STORE_SALES.SS_NET_PROFIT, 0)))), SUM(SUM(SUM(UNION_ALL(0, STORE_RETURNS.SR_RETURN_AMT)))), SUM(SUM(SUM(UNION_ALL(0, STORE_RETURNS.SR_NET_LOSS))))]"",""groupKeys: [STORE.S_STORE_ID]""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(UNION_ALL(STORE_SALES.SS_EXT_SALES_PRICE, 0))), SUM(SUM(UNION_ALL(STORE_SALES.SS_NET_PROFIT, 0))), SUM(SUM(UNION_ALL(0, STORE_RETURNS.SR_RETURN_AMT))), SUM(SUM(UNION_ALL(0, STORE_RETURNS.SR_NET_LOSS)))]"",""groupKeys: [STORE.S_STORE_ID]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = UNION_ALL(STORE_SALES.SS_STORE_SK, STORE_RETURNS.SR_STORE_SK))""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_ID""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(UNION_ALL(STORE_SALES.SS_EXT_SALES_PRICE, 0)), SUM(UNION_ALL(STORE_SALES.SS_NET_PROFIT, 0)), SUM(UNION_ALL(0, STORE_RETURNS.SR_RETURN_AMT)), SUM(UNION_ALL(0, STORE_RETURNS.SR_NET_LOSS))]"",""groupKeys: [UNION_ALL(STORE_SALES.SS_STORE_SK, STORE_RETURNS.SR_STORE_SK)]""],""parentOperators"":[6]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(STORE_SALES.SS_SOLD_DATE_SK, STORE_RETURNS.SR_RETURNED_DATE_SK))""],""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2002-08-27') AND (DATE_DIM.D_DATE <= '2002-09-10')""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[10]},{""id"":12,""operation"":""UnionAll"",""parentOperators"":[9]},{""id"":13,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[12]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = UNION_ALL(STORE_SALES.SS_STORE_SK, STORE_RETURNS.SR_STORE_SK))""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_STORE_SK"",""SS_EXT_SALES_PRICE"",""SS_NET_PROFIT""],""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""(STORE_RETURNS.SR_STORE_SK IS NOT NULL) AND (STORE_RETURNS.SR_RETURNED_DATE_SK IS NOT NULL)""],""parentOperators"":[12]},{""id"":17,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = UNION_ALL(STORE_SALES.SS_STORE_SK, STORE_RETURNS.SR_STORE_SK))""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_RETURNED_DATE_SK"",""SR_STORE_SK"",""SR_RETURN_AMT"",""SR_NET_LOSS""],""partitionsAssigned"":6909,""partitionsTotal"":7070,""bytesAssigned"":122017405952,""parentOperators"":[17]},{""id"":19,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(UNION_ALL(CATALOG_SALES.CS_EXT_SALES_PRICE, 0)))), SUM(SUM(SUM(UNION_ALL(CATALOG_SALES.CS_NET_PROFIT, 0)))), SUM(SUM(SUM(UNION_ALL(0, CATALOG_RETURNS.CR_RETURN_AMOUNT)))), SUM(SUM(SUM(UNION_ALL(0, CATALOG_RETURNS.CR_NET_LOSS))))]"",""groupKeys: [CATALOG_PAGE.CP_CATALOG_PAGE_ID]""],""parentOperators"":[3]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(UNION_ALL(CATALOG_SALES.CS_EXT_SALES_PRICE, 0))), SUM(SUM(UNION_ALL(CATALOG_SALES.CS_NET_PROFIT, 0))), SUM(SUM(UNION_ALL(0, CATALOG_RETURNS.CR_RETURN_AMOUNT))), SUM(SUM(UNION_ALL(0, CATALOG_RETURNS.CR_NET_LOSS)))]"",""groupKeys: [CATALOG_PAGE.CP_CATALOG_PAGE_ID]""],""parentOperators"":[19]},{""id"":21,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CATALOG_PAGE.CP_CATALOG_PAGE_SK = UNION_ALL(CATALOG_SALES.CS_CATALOG_PAGE_SK, CATALOG_RETURNS.CR_CATALOG_PAGE_SK))""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_PAGE""],""expressions"":[""CP_CATALOG_PAGE_SK"",""CP_CATALOG_PAGE_ID""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2235392,""parentOperators"":[21]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(UNION_ALL(CATALOG_SALES.CS_EXT_SALES_PRICE, 0)), SUM(UNION_ALL(CATALOG_SALES.CS_NET_PROFIT, 0)), SUM(UNION_ALL(0, CATALOG_RETURNS.CR_RETURN_AMOUNT)), SUM(UNION_ALL(0, CATALOG_RETURNS.CR_NET_LOSS))]"",""groupKeys: [UNION_ALL(CATALOG_SALES.CS_CATALOG_PAGE_SK, CATALOG_RETURNS.CR_CATALOG_PAGE_SK)]""],""parentOperators"":[21]},{""id"":24,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(CATALOG_SALES.CS_SOLD_DATE_SK, CATALOG_RETURNS.CR_RETURNED_DATE_SK))""],""parentOperators"":[23]},{""id"":25,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2002-08-27') AND (DATE_DIM.D_DATE <= '2002-09-10')""],""parentOperators"":[24]},{""id"":26,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[25]},{""id"":27,""operation"":""UnionAll"",""parentOperators"":[24]},{""id"":28,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_CATALOG_PAGE_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[27]},{""id"":29,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CATALOG_PAGE.CP_CATALOG_PAGE_SK = UNION_ALL(CATALOG_SALES.CS_CATALOG_PAGE_SK, CATALOG_RETURNS.CR_CATALOG_PAGE_SK))""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_CATALOG_PAGE_SK"",""CS_EXT_SALES_PRICE"",""CS_NET_PROFIT""],""partitionsAssigned"":54721,""partitionsTotal"":54922,""bytesAssigned"":920184101376,""parentOperators"":[29]},{""id"":31,""operation"":""Filter"",""expressions"":[""(CATALOG_RETURNS.CR_CATALOG_PAGE_SK IS NOT NULL) AND (CATALOG_RETURNS.CR_RETURNED_DATE_SK IS NOT NULL)""],""parentOperators"":[27]},{""id"":32,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CATALOG_PAGE.CP_CATALOG_PAGE_SK = UNION_ALL(CATALOG_SALES.CS_CATALOG_PAGE_SK, CATALOG_RETURNS.CR_CATALOG_PAGE_SK))""],""parentOperators"":[31]},{""id"":33,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_RETURNS""],""expressions"":[""CR_RETURNED_DATE_SK"",""CR_CATALOG_PAGE_SK"",""CR_RETURN_AMOUNT"",""CR_NET_LOSS""],""partitionsAssigned"":4759,""partitionsTotal"":4759,""bytesAssigned"":82532796416,""parentOperators"":[32]},{""id"":34,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, 0)))), SUM(SUM(SUM(UNION_ALL(WEB_SALES.WS_NET_PROFIT, 0)))), SUM(SUM(SUM(UNION_ALL(0, WEB_RETURNS.WR_RETURN_AMT)))), SUM(SUM(SUM(UNION_ALL(0, WEB_RETURNS.WR_NET_LOSS))))]"",""groupKeys: [WEB_SITE.WEB_SITE_ID]""],""parentOperators"":[3]},{""id"":35,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, 0))), SUM(SUM(UNION_ALL(WEB_SALES.WS_NET_PROFIT, 0))), SUM(SUM(UNION_ALL(0, WEB_RETURNS.WR_RETURN_AMT))), SUM(SUM(UNION_ALL(0, WEB_RETURNS.WR_NET_LOSS)))]"",""groupKeys: [WEB_SITE.WEB_SITE_ID]""],""parentOperators"":[34]},{""id"":36,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WEB_SITE.WEB_SITE_SK = UNION_ALL(WEB_SALES.WS_WEB_SITE_SK, WEB_SALES.WS_WEB_SITE_SK))""],""parentOperators"":[35]},{""id"":37,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SITE""],""expressions"":[""WEB_SITE_SK"",""WEB_SITE_ID""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":20992,""parentOperators"":[36]},{""id"":38,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, 0)), SUM(UNION_ALL(WEB_SALES.WS_NET_PROFIT, 0)), SUM(UNION_ALL(0, WEB_RETURNS.WR_RETURN_AMT)), SUM(UNION_ALL(0, WEB_RETURNS.WR_NET_LOSS))]"",""groupKeys: [UNION_ALL(WEB_SALES.WS_WEB_SITE_SK, WEB_SALES.WS_WEB_SITE_SK)]""],""parentOperators"":[36]},{""id"":39,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(WEB_SALES.WS_SOLD_DATE_SK, WEB_RETURNS.WR_RETURNED_DATE_SK))""],""parentOperators"":[38]},{""id"":40,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2002-08-27') AND (DATE_DIM.D_DATE <= '2002-09-10')""],""parentOperators"":[39]},{""id"":41,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[40]},{""id"":42,""operation"":""UnionAll"",""parentOperators"":[39]},{""id"":43,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_WEB_SITE_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[42]},{""id"":44,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WEB_SITE.WEB_SITE_SK = UNION_ALL(WEB_SALES.WS_WEB_SITE_SK, WEB_SALES.WS_WEB_SITE_SK))""],""parentOperators"":[43]},{""id"":45,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_WEB_SITE_SK"",""WS_EXT_SALES_PRICE"",""WS_NET_PROFIT""],""partitionsAssigned"":27574,""partitionsTotal"":27579,""bytesAssigned"":460956759040,""parentOperators"":[44]},{""id"":46,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WEB_RETURNS.WR_ITEM_SK = WEB_SALES.WS_ITEM_SK) AND (WEB_RETURNS.WR_ORDER_NUMBER = WEB_SALES.WS_ORDER_NUMBER)""],""parentOperators"":[42]},{""id"":47,""operation"":""Filter"",""expressions"":[""WEB_RETURNS.WR_RETURNED_DATE_SK IS NOT NULL""],""parentOperators"":[46]},{""id"":48,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(WEB_SALES.WS_SOLD_DATE_SK, WEB_RETURNS.WR_RETURNED_DATE_SK))""],""parentOperators"":[47]},{""id"":49,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_RETURNS""],""expressions"":[""WR_RETURNED_DATE_SK"",""WR_ITEM_SK"",""WR_ORDER_NUMBER"",""WR_RETURN_AMT"",""WR_NET_LOSS""],""partitionsAssigned"":2226,""partitionsTotal"":2289,""bytesAssigned"":38078895104,""parentOperators"":[48]},{""id"":50,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_WEB_SITE_SK IS NOT NULL) AND (WEB_SALES.WS_ITEM_SK IS NOT NULL) AND (WEB_SALES.WS_ORDER_NUMBER IS NOT NULL)""],""parentOperators"":[46]},{""id"":51,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WEB_SITE.WEB_SITE_SK = UNION_ALL(WEB_SALES.WS_WEB_SITE_SK, WEB_SALES.WS_WEB_SITE_SK))""],""parentOperators"":[50]},{""id"":52,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_ITEM_SK"",""WS_WEB_SITE_SK"",""WS_ORDER_NUMBER""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[51]}]]}",01b2e7fe-0002-2e24-0051-ba870001d21e,"explain using json with /* { ""query"":""query05"",""streamId"":0,""querySequence"":98 } */ ssr as
 (select s_store_id,
        sum(sales_price) as sales,
        sum(profit) as profit,
        sum(return_amt) as returns,
        sum(net_loss) as profit_loss
 from
  ( select  ss_store_sk as store_sk,
            ss_sold_date_sk  as date_sk,
            ss_ext_sales_price as sales_price,
            ss_net_profit as profit,
            cast(0 as decimal(7,2)) as return_amt,
            cast(0 as decimal(7,2)) as net_loss
    from store_sales
    union all
    select sr_store_sk as store_sk,
           sr_returned_date_sk as date_sk,
           cast(0 as decimal(7,2)) as sales_price,
           cast(0 as decimal(7,2)) as profit,
           sr_return_amt as return_amt,
           sr_net_loss as net_loss
    from store_returns
   ) salesreturns,
     date_dim,
     store
 where date_sk = d_date_sk
       and d_date between cast('2002-08-27' as date)
                  and (cast('2002-08-27' as date) + interval '14 days')
       and store_sk = s_store_sk
 group by s_store_id)
 ,
 csr as
 (select cp_catalog_page_id,
        sum(sales_price) as sales,
        sum(profit) as profit,
        sum(return_amt) as returns,
        sum(net_loss) as profit_loss
 from
  ( select  cs_catalog_page_sk as page_sk,
            cs_sold_date_sk  as date_sk,
            cs_ext_sales_price as sales_price,
            cs_net_profit as profit,
            cast(0 as decimal(7,2)) as return_amt,
            cast(0 as decimal(7,2)) as net_loss
    from catalog_sales
    union all
    select cr_catalog_page_sk as page_sk,
           cr_returned_date_sk as date_sk,
           cast(0 as decimal(7,2)) as sales_price,
           cast(0 as decimal(7,2)) as profit,
           cr_return_amount as return_amt,
           cr_net_loss as net_loss
    from catalog_returns
   ) salesreturns,
     date_dim,
     catalog_page
 where date_sk = d_date_sk
       and d_date between cast('2002-08-27' as date)
                  and (cast('2002-08-27' as date) + interval '14 days')
       and page_sk = cp_catalog_page_sk
 group by cp_catalog_page_id)
 ,
 wsr as
 (select web_site_id,
        sum(sales_price) as sales,
        sum(profit) as profit,
        sum(return_amt) as returns,
        sum(net_loss) as profit_loss
 from
  ( select  ws_web_site_sk as wsr_web_site_sk,
            ws_sold_date_sk  as date_sk,
            ws_ext_sales_price as sales_price,
            ws_net_profit as profit,
            cast(0 as decimal(7,2)) as return_amt,
            cast(0 as decimal(7,2)) as net_loss
    from web_sales
    union all
    select ws_web_site_sk as wsr_web_site_sk,
           wr_returned_date_sk as date_sk,
           cast(0 as decimal(7,2)) as sales_price,
           cast(0 as decimal(7,2)) as profit,
           wr_return_amt as return_amt,
           wr_net_loss as net_loss
    from web_returns left outer join web_sales on
         ( wr_item_sk = ws_item_sk
           and wr_order_number = ws_order_number)
   ) salesreturns,
     date_dim,
     web_site
 where date_sk = d_date_sk
       and d_date between cast('2002-08-27' as date)
                  and (cast('2002-08-27' as date) + interval '14 days')
       and wsr_web_site_sk = web_site_sk
 group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from
 (select 'store channel' as channel
        , 'store' || s_store_id as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from   ssr
 union all
 select 'catalog channel' as channel
        , 'catalog_page' || cp_catalog_page_id as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  csr
 union all
 select 'web channel' as channel
        , 'web_site' || web_site_id as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from   wsr
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:34:40.461-07:00,2024-03-10T18:34:41.247-07:00,786,0,0,785,1,0,0,0,0,,,0,,,0,0.000120000,0,8.9.2,0,0,0,0,0,FALSE,c5f1084afe3c9385592992dc3934b226,2,c5f1084afe3c9385592992dc3934b226,1
"{""GlobalStats"":{""partitionsTotal"":146479,""partitionsAssigned"":146479,""bytesAssigned"":2510110425600},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))), COUNT(*)))))"",""SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), COUNT(*))))"",""((SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))), COUNT(*)))))) / (SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), COUNT(*)))))) * 100""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [PROMOTIONAL_SALES.PROMOTIONS ASC NULLS LAST, ALL_SALES.TOTAL ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""CartesianJoin"",""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))), COUNT(*)))))]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))), COUNT(*))))]""],""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Filter"",""expressions"":[""STORE.S_GMT_OFFSET = -7""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_GMT_OFFSET""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))), COUNT(*)))]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[5]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (PROMOTION.P_PROMO_SK = STORE_SALES.SS_PROMO_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""(PROMOTION.P_CHANNEL_DMAIL = 'Y') OR (PROMOTION.P_CHANNEL_EMAIL = 'Y') OR (PROMOTION.P_CHANNEL_TV = 'Y')""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.PROMOTION""],""expressions"":[""P_PROMO_SK"",""P_CHANNEL_DMAIL"",""P_CHANNEL_EMAIL"",""P_CHANNEL_TV""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":85504,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))), COUNT(*))]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_PROMO_SK]""],""parentOperators"":[9]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK]""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""ITEM.I_CATEGORY = 'Jewelry'""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[15]},{""id"":17,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))))]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_PROMO_SK, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[13]},{""id"":18,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_GMT_OFFSET = -7""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_GMT_OFFSET""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[19]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_PROMO_SK, STORE_SALES.SS_ITEM_SK, CUSTOMER.C_CURRENT_ADDR_SK]""],""parentOperators"":[18]},{""id"":22,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[21]},{""id"":23,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_ADDR_SK""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[23]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_PROMO_SK, STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[22]},{""id"":26,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[25]},{""id"":27,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2001) AND (DATE_DIM.D_MOY = 11)""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[27]},{""id"":29,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_PROMO_SK, STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[26]},{""id"":30,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_PROMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[29]},{""id"":31,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[30]},{""id"":32,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_CUSTOMER_SK"",""SS_STORE_SK"",""SS_PROMO_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[31]},{""id"":33,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), COUNT(*))))]""],""parentOperators"":[2]},{""id"":34,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), COUNT(*)))]""],""parentOperators"":[33]},{""id"":35,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[34]},{""id"":36,""operation"":""Filter"",""expressions"":[""STORE.S_GMT_OFFSET = -7""],""parentOperators"":[35]},{""id"":37,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_GMT_OFFSET""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[36]},{""id"":38,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))), COUNT(*))]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[35]},{""id"":39,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[38]},{""id"":40,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK]""],""parentOperators"":[39]},{""id"":41,""operation"":""Filter"",""expressions"":[""ITEM.I_CATEGORY = 'Jewelry'""],""parentOperators"":[40]},{""id"":42,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[41]},{""id"":43,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[39]},{""id"":44,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[43]},{""id"":45,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_GMT_OFFSET = -7""],""parentOperators"":[44]},{""id"":46,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_GMT_OFFSET""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[45]},{""id"":47,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_ITEM_SK, CUSTOMER.C_CURRENT_ADDR_SK]""],""parentOperators"":[44]},{""id"":48,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[47]},{""id"":49,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[48]},{""id"":50,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_ADDR_SK""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[49]},{""id"":51,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[48]},{""id"":52,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[51]},{""id"":53,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2001) AND (DATE_DIM.D_MOY = 11)""],""parentOperators"":[52]},{""id"":54,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[53]},{""id"":55,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[52]},{""id"":56,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[55]},{""id"":57,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_CUSTOMER_SK"",""SS_STORE_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[56]}]]}",01b2e7fe-0002-2d15-0051-ba8700019726,"explain using json select /* { ""query"":""query61"",""streamId"":0,""querySequence"":97 } */  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100
from
  (select sum(ss_ext_sales_price) promotions
   from  store_sales
        ,store
        ,promotion
        ,date_dim
        ,customer
        ,customer_address
        ,item
   where ss_sold_date_sk = d_date_sk
   and   ss_store_sk = s_store_sk
   and   ss_promo_sk = p_promo_sk
   and   ss_customer_sk= c_customer_sk
   and   ca_address_sk = c_current_addr_sk
   and   ss_item_sk = i_item_sk
   and   ca_gmt_offset = -7
   and   i_category = 'Jewelry'
   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')
   and   s_gmt_offset = -7
   and   d_year = 2001
   and   d_moy  = 11) promotional_sales,
  (select sum(ss_ext_sales_price) total
   from  store_sales
        ,store
        ,date_dim
        ,customer
        ,customer_address
        ,item
   where ss_sold_date_sk = d_date_sk
   and   ss_store_sk = s_store_sk
   and   ss_customer_sk= c_customer_sk
   and   ca_address_sk = c_current_addr_sk
   and   ss_item_sk = i_item_sk
   and   ca_gmt_offset = -7
   and   i_category = 'Jewelry'
   and   s_gmt_offset = -7
   and   d_year = 2001
   and   d_moy  = 11) all_sales
order by promotions, total
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:34:39.363-07:00,2024-03-10T18:34:40.063-07:00,700,0,0,699,1,0,0,0,0,,,0,,,0,0.000107000,0,8.9.2,0,0,0,0,0,FALSE,582bd76e3fc908550d6f53bfc1f29e58,2,e34c2164b037802c581293a4df02b768,1
"{""GlobalStats"":{""partitionsTotal"":156005,""partitionsAssigned"":156005,""bytesAssigned"":2643575084032},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""T_S_SECYEAR.CUSTOMER_ID"",""T_S_SECYEAR.CUSTOMER_FIRST_NAME"",""T_S_SECYEAR.CUSTOMER_LAST_NAME""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [T_S_SECYEAR.CUSTOMER_ID ASC NULLS LAST, T_S_SECYEAR.CUSTOMER_FIRST_NAME ASC NULLS LAST, T_S_SECYEAR.CUSTOMER_LAST_NAME ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_C_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_C_SECYEAR.YEAR_TOTAL, T_C_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_S_SECYEAR.YEAR_TOTAL, T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[1]},{""id"":3,""operation"":""WithReference"",""expressions"":[""T_S_SECYEAR""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'c', 'w')) = 's') AND (T_S_SECYEAR.DYEAR = 2000)""],""parentOperators"":[3]},{""id"":5,""operation"":""WithClause"",""expressions"":[""YEAR_TOTAL""],""parentOperators"":[4,49,53,57,61,64]},{""id"":6,""operation"":""UnionAll"",""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM((((STORE_SALES.SS_EXT_LIST_PRICE - STORE_SALES.SS_EXT_WHOLESALE_COST) - STORE_SALES.SS_EXT_DISCOUNT_AMT) + STORE_SALES.SS_EXT_SALES_PRICE) / 2)), COUNT(*)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM((((STORE_SALES.SS_EXT_LIST_PRICE - STORE_SALES.SS_EXT_WHOLESALE_COST) - STORE_SALES.SS_EXT_DISCOUNT_AMT) + STORE_SALES.SS_EXT_SALES_PRICE) / 2)), COUNT(*))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS]""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CUSTOMER_ID"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_PREFERRED_CUST_FLAG"",""C_BIRTH_COUNTRY"",""C_EMAIL_ADDRESS""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[10]},{""id"":12,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM((((STORE_SALES.SS_EXT_LIST_PRICE - STORE_SALES.SS_EXT_WHOLESALE_COST) - STORE_SALES.SS_EXT_DISCOUNT_AMT) + STORE_SALES.SS_EXT_SALES_PRICE) / 2))]"",""groupKeys: [DATE_DIM.D_YEAR, STORE_SALES.SS_CUSTOMER_SK]""],""parentOperators"":[9]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 1999 IN 2000""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[14]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((((STORE_SALES.SS_EXT_LIST_PRICE - STORE_SALES.SS_EXT_WHOLESALE_COST) - STORE_SALES.SS_EXT_DISCOUNT_AMT) + STORE_SALES.SS_EXT_SALES_PRICE) / 2)]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[13]},{""id"":17,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[16]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_EXT_DISCOUNT_AMT"",""SS_EXT_SALES_PRICE"",""SS_EXT_WHOLESALE_COST"",""SS_EXT_LIST_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[18]},{""id"":20,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM((((CATALOG_SALES.CS_EXT_LIST_PRICE - CATALOG_SALES.CS_EXT_WHOLESALE_COST) - CATALOG_SALES.CS_EXT_DISCOUNT_AMT) + CATALOG_SALES.CS_EXT_SALES_PRICE) / 2)), COUNT(*)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[6]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM((((CATALOG_SALES.CS_EXT_LIST_PRICE - CATALOG_SALES.CS_EXT_WHOLESALE_COST) - CATALOG_SALES.CS_EXT_DISCOUNT_AMT) + CATALOG_SALES.CS_EXT_SALES_PRICE) / 2)), COUNT(*))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[20]},{""id"":22,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[21]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS]""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CUSTOMER_ID"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_PREFERRED_CUST_FLAG"",""C_BIRTH_COUNTRY"",""C_EMAIL_ADDRESS""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[23]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM((((CATALOG_SALES.CS_EXT_LIST_PRICE - CATALOG_SALES.CS_EXT_WHOLESALE_COST) - CATALOG_SALES.CS_EXT_DISCOUNT_AMT) + CATALOG_SALES.CS_EXT_SALES_PRICE) / 2))]"",""groupKeys: [DATE_DIM.D_YEAR, CATALOG_SALES.CS_BILL_CUSTOMER_SK]""],""parentOperators"":[22]},{""id"":26,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[25]},{""id"":27,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 1999 IN 2000""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[27]},{""id"":29,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((((CATALOG_SALES.CS_EXT_LIST_PRICE - CATALOG_SALES.CS_EXT_WHOLESALE_COST) - CATALOG_SALES.CS_EXT_DISCOUNT_AMT) + CATALOG_SALES.CS_EXT_SALES_PRICE) / 2)]"",""groupKeys: [CATALOG_SALES.CS_BILL_CUSTOMER_SK, CATALOG_SALES.CS_SOLD_DATE_SK]""],""parentOperators"":[26]},{""id"":30,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[29]},{""id"":31,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[30]},{""id"":32,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_EXT_DISCOUNT_AMT"",""CS_EXT_SALES_PRICE"",""CS_EXT_WHOLESALE_COST"",""CS_EXT_LIST_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[31]},{""id"":33,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(SUM((((WEB_SALES.WS_EXT_LIST_PRICE - WEB_SALES.WS_EXT_WHOLESALE_COST) - WEB_SALES.WS_EXT_DISCOUNT_AMT) + WEB_SALES.WS_EXT_SALES_PRICE) / 2)), COUNT(*)))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[6]},{""id"":34,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(SUM((((WEB_SALES.WS_EXT_LIST_PRICE - WEB_SALES.WS_EXT_WHOLESALE_COST) - WEB_SALES.WS_EXT_DISCOUNT_AMT) + WEB_SALES.WS_EXT_SALES_PRICE) / 2)), COUNT(*))]"",""groupKeys: [CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS, DATE_DIM.D_YEAR]""],""parentOperators"":[33]},{""id"":35,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[34]},{""id"":36,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER.C_CUSTOMER_SK, CUSTOMER.C_CUSTOMER_ID, CUSTOMER.C_FIRST_NAME, CUSTOMER.C_LAST_NAME, CUSTOMER.C_PREFERRED_CUST_FLAG, CUSTOMER.C_BIRTH_COUNTRY, CUSTOMER.C_EMAIL_ADDRESS]""],""parentOperators"":[35]},{""id"":37,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CUSTOMER_ID"",""C_FIRST_NAME"",""C_LAST_NAME"",""C_PREFERRED_CUST_FLAG"",""C_BIRTH_COUNTRY"",""C_EMAIL_ADDRESS""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[36]},{""id"":38,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM((((WEB_SALES.WS_EXT_LIST_PRICE - WEB_SALES.WS_EXT_WHOLESALE_COST) - WEB_SALES.WS_EXT_DISCOUNT_AMT) + WEB_SALES.WS_EXT_SALES_PRICE) / 2))]"",""groupKeys: [DATE_DIM.D_YEAR, WEB_SALES.WS_BILL_CUSTOMER_SK]""],""parentOperators"":[35]},{""id"":39,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[38]},{""id"":40,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR IN 1999 IN 2000""],""parentOperators"":[39]},{""id"":41,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[40]},{""id"":42,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM((((WEB_SALES.WS_EXT_LIST_PRICE - WEB_SALES.WS_EXT_WHOLESALE_COST) - WEB_SALES.WS_EXT_DISCOUNT_AMT) + WEB_SALES.WS_EXT_SALES_PRICE) / 2)]"",""groupKeys: [WEB_SALES.WS_BILL_CUSTOMER_SK, WEB_SALES.WS_SOLD_DATE_SK]""],""parentOperators"":[39]},{""id"":43,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_CUSTOMER_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[42]},{""id"":44,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[43]},{""id"":45,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_BILL_CUSTOMER_SK"",""WS_EXT_DISCOUNT_AMT"",""WS_EXT_SALES_PRICE"",""WS_EXT_WHOLESALE_COST"",""WS_EXT_LIST_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[44]},{""id"":46,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_S_FIRSTYEAR.CUSTOMER_ID = T_W_FIRSTYEAR.CUSTOMER_ID)""],""parentOperators"":[2]},{""id"":47,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_C_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_C_SECYEAR.YEAR_TOTAL, T_C_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_S_SECYEAR.YEAR_TOTAL, T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[46]},{""id"":48,""operation"":""WithReference"",""expressions"":[""T_S_FIRSTYEAR""],""parentOperators"":[47]},{""id"":49,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'c', 'w')) = 's') AND (T_S_FIRSTYEAR.DYEAR = 1999) AND (T_S_FIRSTYEAR.YEAR_TOTAL > 0)""],""parentOperators"":[48]},{""id"":50,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_W_FIRSTYEAR.CUSTOMER_ID = T_C_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_C_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_C_SECYEAR.YEAR_TOTAL, T_C_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_W_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_W_SECYEAR.YEAR_TOTAL, T_W_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[46]},{""id"":51,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_C_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_C_SECYEAR.YEAR_TOTAL, T_C_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_S_SECYEAR.YEAR_TOTAL, T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[50]},{""id"":52,""operation"":""WithReference"",""expressions"":[""T_W_FIRSTYEAR""],""parentOperators"":[51]},{""id"":53,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'c', 'w')) = 'w') AND (T_W_FIRSTYEAR.DYEAR = 1999) AND (T_W_FIRSTYEAR.YEAR_TOTAL > 0)""],""parentOperators"":[52]},{""id"":54,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_W_SECYEAR.CUSTOMER_ID = T_C_FIRSTYEAR.CUSTOMER_ID)""],""parentOperators"":[50]},{""id"":55,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_C_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_C_SECYEAR.YEAR_TOTAL, T_C_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_S_SECYEAR.YEAR_TOTAL, T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[54]},{""id"":56,""operation"":""WithReference"",""expressions"":[""T_W_SECYEAR""],""parentOperators"":[55]},{""id"":57,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'c', 'w')) = 'w') AND (T_W_SECYEAR.DYEAR = 2000)""],""parentOperators"":[56]},{""id"":58,""operation"":""InnerJoin"",""expressions"":[""joinKey: (T_C_FIRSTYEAR.CUSTOMER_ID = T_C_SECYEAR.CUSTOMER_ID)""],""parentOperators"":[54]},{""id"":59,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_C_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_C_SECYEAR.YEAR_TOTAL, T_C_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_S_SECYEAR.YEAR_TOTAL, T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[58]},{""id"":60,""operation"":""WithReference"",""expressions"":[""T_C_FIRSTYEAR""],""parentOperators"":[59]},{""id"":61,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'c', 'w')) = 'c') AND (T_C_FIRSTYEAR.DYEAR = 1999) AND (T_C_FIRSTYEAR.YEAR_TOTAL > 0)""],""parentOperators"":[60]},{""id"":62,""operation"":""JoinFilter"",""expressions"":[""joinKey: (T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID)"",""joinFilter: (IFF(T_C_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_C_SECYEAR.YEAR_TOTAL, T_C_FIRSTYEAR.YEAR_TOTAL), null)) > (IFF(T_S_FIRSTYEAR.YEAR_TOTAL > 0, SCALED_ROUND_INT_DIVIDE(T_S_SECYEAR.YEAR_TOTAL, T_S_FIRSTYEAR.YEAR_TOTAL), null))""],""parentOperators"":[58]},{""id"":63,""operation"":""WithReference"",""expressions"":[""T_C_SECYEAR""],""parentOperators"":[62]},{""id"":64,""operation"":""Filter"",""expressions"":[""((UNION_ALL('s', 'c', 'w')) = 'c') AND (T_C_SECYEAR.DYEAR = 2000)""],""parentOperators"":[63]}]]}",01b2e7fe-0002-2f4b-0051-ba870002619a,"explain using json with /* { ""query"":""query04"",""streamId"":0,""querySequence"":93 } */ year_total as (
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total
       ,'s' sale_type
 from customer
     ,store_sales
     ,date_dim
 where c_customer_sk = ss_customer_sk
   and ss_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
 union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total
       ,'c' sale_type
 from customer
     ,catalog_sales
     ,date_dim
 where c_customer_sk = cs_bill_customer_sk
   and cs_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total
       ,'w' sale_type
 from customer
     ,web_sales
     ,date_dim
 where c_customer_sk = ws_bill_customer_sk
   and ws_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
         )
  select
                  t_s_secyear.customer_id
                 ,t_s_secyear.customer_first_name
                 ,t_s_secyear.customer_last_name
                 ,t_s_secyear.customer_login
 from year_total t_s_firstyear
     ,year_total t_s_secyear
     ,year_total t_c_firstyear
     ,year_total t_c_secyear
     ,year_total t_w_firstyear
     ,year_total t_w_secyear
 where t_s_secyear.customer_id = t_s_firstyear.customer_id
   and t_s_firstyear.customer_id = t_c_secyear.customer_id
   and t_s_firstyear.customer_id = t_c_firstyear.customer_id
   and t_s_firstyear.customer_id = t_w_firstyear.customer_id
   and t_s_firstyear.customer_id = t_w_secyear.customer_id
   and t_s_firstyear.sale_type = 's'
   and t_c_firstyear.sale_type = 'c'
   and t_w_firstyear.sale_type = 'w'
   and t_s_secyear.sale_type = 's'
   and t_c_secyear.sale_type = 'c'
   and t_w_secyear.sale_type = 'w'
   and t_s_firstyear.dyear =  1999
   and t_s_secyear.dyear = 1999+1
   and t_c_firstyear.dyear =  1999
   and t_c_secyear.dyear =  1999+1
   and t_w_firstyear.dyear = 1999
   and t_w_secyear.dyear = 1999+1
   and t_s_firstyear.year_total > 0
   and t_c_firstyear.year_total > 0
   and t_w_firstyear.year_total > 0
   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end
           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end
   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end
           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end
 order by t_s_secyear.customer_id
         ,t_s_secyear.customer_first_name
         ,t_s_secyear.customer_last_name
         ,t_s_secyear.customer_login
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:34:34.475-07:00,2024-03-10T18:34:35.656-07:00,1181,0,0,1179,2,0,0,0,0,,,0,,,0,0.000180000,0,8.9.2,0,0,0,0,0,FALSE,72623e6b85951d0c119813eac0aa4bb9,2,cdd0d2d484f4751f08b9a3af0d9a3396,1
"{""GlobalStats"":{""partitionsTotal"":55444,""partitionsAssigned"":55444,""bytesAssigned"":926763312128},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""CUSTOMER_ADDRESS.CA_COUNTRY"",""CUSTOMER_ADDRESS.CA_STATE"",""CUSTOMER_ADDRESS.CA_COUNTY"",""(SUM(CATALOG_SALES.CS_QUANTITY)) / (COUNT(CATALOG_SALES.CS_QUANTITY))"",""(SUM(CATALOG_SALES.CS_LIST_PRICE)) / (COUNT(CATALOG_SALES.CS_LIST_PRICE))"",""(SUM(CATALOG_SALES.CS_COUPON_AMT)) / (COUNT(CATALOG_SALES.CS_COUPON_AMT))"",""(SUM(CATALOG_SALES.CS_SALES_PRICE)) / (COUNT(CATALOG_SALES.CS_SALES_PRICE))"",""(SUM(CATALOG_SALES.CS_NET_PROFIT)) / (COUNT(CATALOG_SALES.CS_NET_PROFIT))"",""(SUM(CUSTOMER.C_BIRTH_YEAR)) / (COUNT(CUSTOMER.C_BIRTH_YEAR))"",""(SUM(CD1.CD_DEP_COUNT)) / (COUNT(CD1.CD_DEP_COUNT))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CUSTOMER_ADDRESS.CA_COUNTRY ASC NULLS LAST, CUSTOMER_ADDRESS.CA_STATE ASC NULLS LAST, CUSTOMER_ADDRESS.CA_COUNTY ASC NULLS LAST, ITEM.I_ITEM_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""GroupingSets"",""expressions"":[""SUM(CATALOG_SALES.CS_QUANTITY)"",""COUNT(CATALOG_SALES.CS_QUANTITY)"",""SUM(CATALOG_SALES.CS_LIST_PRICE)"",""COUNT(CATALOG_SALES.CS_LIST_PRICE)"",""SUM(CATALOG_SALES.CS_COUPON_AMT)"",""COUNT(CATALOG_SALES.CS_COUPON_AMT)"",""SUM(CATALOG_SALES.CS_SALES_PRICE)"",""COUNT(CATALOG_SALES.CS_SALES_PRICE)"",""SUM(CATALOG_SALES.CS_NET_PROFIT)"",""COUNT(CATALOG_SALES.CS_NET_PROFIT)"",""SUM(CUSTOMER.C_BIRTH_YEAR)"",""COUNT(CUSTOMER.C_BIRTH_YEAR)"",""SUM(CD1.CD_DEP_COUNT)"",""COUNT(CD1.CD_DEP_COUNT)""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CD1.CD_DEMO_SK = CATALOG_SALES.CS_BILL_CDEMO_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""(CD1.CD_GENDER = 'M') AND (CD1.CD_EDUCATION_STATUS = '2 yr Degree')""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_GENDER"",""CD_EDUCATION_STATUS"",""CD_DEP_COUNT""],""alias"":""CD1"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[3]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[6]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CD2.CD_DEMO_SK = CUSTOMER.C_CURRENT_CDEMO_SK)""],""parentOperators"":[6]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK""],""alias"":""CD2"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = CUSTOMER.C_CURRENT_ADDR_SK)""],""parentOperators"":[8]},{""id"":11,""operation"":""Filter"",""expressions"":[""CUSTOMER_ADDRESS.CA_STATE IN 'IL' IN 'NM' IN 'GA' IN 'MD' IN 'OH' IN 'MO' IN 'OR'""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_COUNTY"",""CA_STATE"",""CA_COUNTRY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[11]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK)""],""parentOperators"":[10]},{""id"":14,""operation"":""Filter"",""expressions"":[""(CUSTOMER.C_BIRTH_MONTH IN 7 IN 1 IN 3 IN 9 IN 5 IN 8) AND (CUSTOMER.C_CURRENT_CDEMO_SK IS NOT NULL)""],""parentOperators"":[13]},{""id"":15,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CD2.CD_DEMO_SK = CUSTOMER.C_CURRENT_CDEMO_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_CDEMO_SK"",""C_CURRENT_ADDR_SK"",""C_BIRTH_MONTH"",""C_BIRTH_YEAR""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[15]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[13]},{""id"":18,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 2002""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL) AND (CATALOG_SALES.CS_BILL_CDEMO_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[17]},{""id"":21,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CD1.CD_DEMO_SK = CATALOG_SALES.CS_BILL_CDEMO_SK)""],""parentOperators"":[20]},{""id"":22,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_BILL_CDEMO_SK"",""CS_ITEM_SK"",""CS_QUANTITY"",""CS_LIST_PRICE"",""CS_SALES_PRICE"",""CS_COUPON_AMT"",""CS_NET_PROFIT""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[21]}]]}",01b2e7fd-0002-2e22-0051-ba870002d066,"explain using json select /* { ""query"":""query18"",""streamId"":0,""querySequence"":90 } */  i_item_id,
        ca_country,
        ca_state,
        ca_county,
        avg( cast(cs_quantity as decimal(12,2))) agg1,
        avg( cast(cs_list_price as decimal(12,2))) agg2,
        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,
        avg( cast(cs_sales_price as decimal(12,2))) agg4,
        avg( cast(cs_net_profit as decimal(12,2))) agg5,
        avg( cast(c_birth_year as decimal(12,2))) agg6,
        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7
 from catalog_sales, customer_demographics cd1,
      customer_demographics cd2, customer, customer_address, date_dim, item
 where cs_sold_date_sk = d_date_sk and
       cs_item_sk = i_item_sk and
       cs_bill_cdemo_sk = cd1.cd_demo_sk and
       cs_bill_customer_sk = c_customer_sk and
       cd1.cd_gender = 'M' and
       cd1.cd_education_status = '2 yr Degree' and
       c_current_cdemo_sk = cd2.cd_demo_sk and
       c_current_addr_sk = ca_address_sk and
       c_birth_month in (7,1,3,9,5,8) and
       d_year = 2002 and
       ca_state in ('IL','NM','GA'
                   ,'MD','OH','MO','OR')
 group by rollup (i_item_id, ca_country, ca_state, ca_county)
 order by ca_country,
        ca_state,
        ca_county,
	i_item_id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:36.839-07:00,2024-03-10T18:33:37.498-07:00,659,0,0,657,2,0,0,0,0,,,0,,,0,0.000101000,0,8.9.2,0,0,0,0,0,FALSE,0db62fd74c385769e7561cfc94781750,2,f2dc2c33938a8e341e02bbb771f54b71,1
"{""GlobalStats"":{""partitionsTotal"":72982,""partitionsAssigned"":72982,""bytesAssigned"":1254254934528},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER.C_LAST_NAME"",""CUSTOMER.C_FIRST_NAME"",""SUBSTR(STORE.S_CITY, 1, 30)"",""STORE_SALES.SS_TICKET_NUMBER"",""SUM(SUM(SUM(SUM(STORE_SALES.SS_COUPON_AMT))))"",""SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CUSTOMER.C_LAST_NAME ASC NULLS LAST, CUSTOMER.C_FIRST_NAME ASC NULLS LAST, SUBSTR(MS.S_CITY, 1, 30) ASC NULLS LAST, MS.PROFIT ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_FIRST_NAME"",""C_LAST_NAME""],""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_COUPON_AMT)))), SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))))]"",""groupKeys: [STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ADDR_SK, STORE.S_CITY]""],""parentOperators"":[2]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_COUPON_AMT))), SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))]"",""groupKeys: [STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ADDR_SK, STORE.S_CITY]""],""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""(STORE.S_NUMBER_EMPLOYEES >= 200) AND (STORE.S_NUMBER_EMPLOYEES <= 295)""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_NUMBER_EMPLOYEES"",""S_CITY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_COUPON_AMT)), SUM(SUM(STORE_SALES.SS_NET_PROFIT))]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ADDR_SK, STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[6]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 5) OR (HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 3)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT"",""HD_VEHICLE_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_COUPON_AMT), SUM(STORE_SALES.SS_NET_PROFIT)]"",""groupKeys: [STORE_SALES.SS_CUSTOMER_SK, STORE_SALES.SS_ADDR_SK, STORE_SALES.SS_TICKET_NUMBER, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[10]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DOW = 1) AND (DATE_DIM.D_YEAR IN 1998 IN 1999 IN 2000)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_DOW""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[14]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK"",""SS_HDEMO_SK"",""SS_ADDR_SK"",""SS_STORE_SK"",""SS_TICKET_NUMBER"",""SS_COUPON_AMT"",""SS_NET_PROFIT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[18]}]]}",01b2e7fd-0002-2d15-0051-ba8700019722,"explain using json select /* { ""query"":""query79"",""streamId"":0,""querySequence"":89 } */
  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit
  from
   (select ss_ticket_number
          ,ss_customer_sk
          ,store.s_city
          ,sum(ss_coupon_amt) amt
          ,sum(ss_net_profit) profit
    from store_sales,date_dim,store,household_demographics
    where store_sales.ss_sold_date_sk = date_dim.d_date_sk
    and store_sales.ss_store_sk = store.s_store_sk
    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
    and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > 3)
    and date_dim.d_dow = 1
    and date_dim.d_year in (1998,1998+1,1998+2)
    and store.s_number_employees between 200 and 295
    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer
    where ss_customer_sk = c_customer_sk
 order by c_last_name,c_first_name,substr(s_city,1,30), profit
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:35.986-07:00,2024-03-10T18:33:36.499-07:00,513,0,0,512,1,0,0,0,0,,,0,,,0,0.000078000,0,8.9.2,0,0,0,0,0,FALSE,f83c7918058abffa6689a0fbaddf2b8d,2,5ed7611f6cdcd63cd37be7d135dbd1b5,1
"{""GlobalStats"":{""partitionsTotal"":59685,""partitionsAssigned"":59484,""bytesAssigned"":1002742855168},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""WAREHOUSE.W_STATE"",""ITEM.I_ITEM_ID"",""SUM(IFF((DATE_DIM.D_DATE) < '2002-06-04', (CATALOG_SALES.CS_SALES_PRICE) - (IFNULL(CATALOG_RETURNS.CR_REFUNDED_CASH, 0)), 0))"",""SUM(IFF((DATE_DIM.D_DATE) >= '2002-06-04', (CATALOG_SALES.CS_SALES_PRICE) - (IFNULL(CATALOG_RETURNS.CR_REFUNDED_CASH, 0)), 0))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [WAREHOUSE.W_STATE ASC NULLS LAST, ITEM.I_ITEM_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFF((DATE_DIM.D_DATE) < '2002-06-04', (CATALOG_SALES.CS_SALES_PRICE) - (IFNULL(CATALOG_RETURNS.CR_REFUNDED_CASH, 0)), 0)), SUM(IFF((DATE_DIM.D_DATE) >= '2002-06-04', (CATALOG_SALES.CS_SALES_PRICE) - (IFNULL(CATALOG_RETURNS.CR_REFUNDED_CASH, 0)), 0))]"",""groupKeys: [WAREHOUSE.W_STATE, ITEM.I_ITEM_ID]""],""parentOperators"":[1]},{""id"":3,""operation"":""LeftOuterJoin"",""expressions"":[""joinKey: (CATALOG_SALES.CS_ITEM_SK = CATALOG_RETURNS.CR_ITEM_SK) AND (CATALOG_SALES.CS_ORDER_NUMBER = CATALOG_RETURNS.CR_ORDER_NUMBER)""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WAREHOUSE.W_WAREHOUSE_SK = CATALOG_SALES.CS_WAREHOUSE_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WAREHOUSE""],""expressions"":[""W_WAREHOUSE_SK"",""W_STATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7168,""parentOperators"":[4]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[4]},{""id"":7,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2002-05-05') AND (DATE_DIM.D_DATE <= '2002-07-04')""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[6]},{""id"":10,""operation"":""Filter"",""expressions"":[""(ITEM.I_CURRENT_PRICE >= 0.99) AND (ITEM.I_CURRENT_PRICE <= 1.49)""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID"",""I_CURRENT_PRICE""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL) AND (CATALOG_SALES.CS_WAREHOUSE_SK IS NOT NULL)""],""parentOperators"":[9]},{""id"":13,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WAREHOUSE.W_WAREHOUSE_SK = CATALOG_SALES.CS_WAREHOUSE_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_WAREHOUSE_SK"",""CS_ITEM_SK"",""CS_ORDER_NUMBER"",""CS_SALES_PRICE""],""partitionsAssigned"":54721,""partitionsTotal"":54922,""bytesAssigned"":920184101376,""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""(CATALOG_RETURNS.CR_ITEM_SK IS NOT NULL) AND (CATALOG_RETURNS.CR_ORDER_NUMBER IS NOT NULL)""],""parentOperators"":[3]},{""id"":16,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CATALOG_SALES.CS_ITEM_SK = CATALOG_RETURNS.CR_ITEM_SK) AND (CATALOG_SALES.CS_ORDER_NUMBER = CATALOG_RETURNS.CR_ORDER_NUMBER)""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_RETURNS""],""expressions"":[""CR_ITEM_SK"",""CR_ORDER_NUMBER"",""CR_REFUNDED_CASH""],""partitionsAssigned"":4759,""partitionsTotal"":4759,""bytesAssigned"":82532796416,""parentOperators"":[16]}]]}",01b2e7fd-0002-300b-0051-ba870002c0d6,"explain using json select /* { ""query"":""query40"",""streamId"":0,""querySequence"":86 } */
   w_state
  ,i_item_id
  ,sum(case when (cast(d_date as date) < cast ('2002-06-04' as date))
 		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before
  ,sum(case when (cast(d_date as date) >= cast ('2002-06-04' as date))
 		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after
 from
   catalog_sales left outer join catalog_returns on
       (cs_order_number = cr_order_number
        and cs_item_sk = cr_item_sk)
  ,warehouse
  ,item
  ,date_dim
 where
     i_current_price between 0.99 and 1.49
 and i_item_sk          = cs_item_sk
 and cs_warehouse_sk    = w_warehouse_sk
 and cs_sold_date_sk    = d_date_sk
 and d_date between (cast ('2002-06-04' as date) - interval '30 days')
                and (cast ('2002-06-04' as date) + interval '30 days')
 group by
    w_state,i_item_id
 order by w_state,i_item_id
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:31.989-07:00,2024-03-10T18:33:32.342-07:00,353,0,0,352,1,0,0,0,0,,,0,,,0,0.000054000,0,8.9.2,0,0,0,0,0,FALSE,2fdfb937c014681661f09f8872a61f65,2,2fdfb937c014681661f09f8872a61f65,1
"{""GlobalStats"":{""partitionsTotal"":54927,""partitionsAssigned"":54927,""bytesAssigned"":923650957824},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""SCALED_ROUND_INT_DIVIDE(SUM(SUM(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)))), COUNT(COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)))))"",""(SUM(SUM(SUM_INTERNAL(CATALOG_SALES.CS_LIST_PRICE, COUNT(*))))) / (COUNT(COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_LIST_PRICE, COUNT(*)))))"",""(SUM(SUM(SUM_INTERNAL(CATALOG_SALES.CS_COUPON_AMT, COUNT(*))))) / (COUNT(COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_COUPON_AMT, COUNT(*)))))"",""(SUM(SUM(SUM_INTERNAL(CATALOG_SALES.CS_SALES_PRICE, COUNT(*))))) / (COUNT(COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_SALES_PRICE, COUNT(*)))))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [ITEM.I_ITEM_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)))), COUNT(COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)))), SUM(SUM(SUM_INTERNAL(CATALOG_SALES.CS_LIST_PRICE, COUNT(*)))), COUNT(COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_LIST_PRICE, COUNT(*)))), SUM(SUM(SUM_INTERNAL(CATALOG_SALES.CS_COUPON_AMT, COUNT(*)))), COUNT(COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_COUPON_AMT, COUNT(*)))), SUM(SUM(SUM_INTERNAL(CATALOG_SALES.CS_SALES_PRICE, COUNT(*)))), COUNT(COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_SALES_PRICE, COUNT(*))))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*))), COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*))), SUM(SUM_INTERNAL(CATALOG_SALES.CS_LIST_PRICE, COUNT(*))), COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_LIST_PRICE, COUNT(*))), SUM(SUM_INTERNAL(CATALOG_SALES.CS_COUPON_AMT, COUNT(*))), COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_COUPON_AMT, COUNT(*))), SUM(SUM_INTERNAL(CATALOG_SALES.CS_SALES_PRICE, COUNT(*))), COUNT(COUNT_INTERNAL(CATALOG_SALES.CS_SALES_PRICE, COUNT(*)))]"",""groupKeys: [ITEM.I_ITEM_ID]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (PROMOTION.P_PROMO_SK = CATALOG_SALES.CS_PROMO_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""(PROMOTION.P_CHANNEL_EMAIL = 'N') OR (PROMOTION.P_CHANNEL_EVENT = 'N')""],""parentOperators"":[4]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.PROMOTION""],""expressions"":[""P_PROMO_SK"",""P_CHANNEL_EMAIL"",""P_CHANNEL_EVENT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":85504,""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), SUM_INTERNAL(CATALOG_SALES.CS_LIST_PRICE, COUNT(*)), COUNT_INTERNAL(CATALOG_SALES.CS_LIST_PRICE, COUNT(*)), SUM_INTERNAL(CATALOG_SALES.CS_COUPON_AMT, COUNT(*)), COUNT_INTERNAL(CATALOG_SALES.CS_COUPON_AMT, COUNT(*)), SUM_INTERNAL(CATALOG_SALES.CS_SALES_PRICE, COUNT(*)), COUNT_INTERNAL(CATALOG_SALES.CS_SALES_PRICE, COUNT(*))]"",""groupKeys: [ITEM.I_ITEM_ID, CATALOG_SALES.CS_PROMO_SK]""],""parentOperators"":[4]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = CATALOG_SALES.CS_BILL_CDEMO_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK]""],""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""(CUSTOMER_DEMOGRAPHICS.CD_GENDER = 'M') AND (CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS = 'U') AND (CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS = 'Primary')""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_GENDER"",""CD_MARITAL_STATUS"",""CD_EDUCATION_STATUS""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[10]},{""id"":12,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[8]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[12]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[12]},{""id"":15,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 1999""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_BILL_CDEMO_SK IS NOT NULL) AND (CATALOG_SALES.CS_PROMO_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[14]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (PROMOTION.P_PROMO_SK = CATALOG_SALES.CS_PROMO_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CDEMO_SK"",""CS_ITEM_SK"",""CS_PROMO_SK"",""CS_QUANTITY"",""CS_LIST_PRICE"",""CS_SALES_PRICE"",""CS_COUPON_AMT""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[18]}]]}",01b2e7fd-0002-3000-0051-ba870002f062,"explain using json select /* { ""query"":""query26"",""streamId"":0,""querySequence"":85 } */  i_item_id,
        avg(cs_quantity) agg1,
        avg(cs_list_price) agg2,
        avg(cs_coupon_amt) agg3,
        avg(cs_sales_price) agg4
 from catalog_sales, customer_demographics, date_dim, item, promotion
 where cs_sold_date_sk = d_date_sk and
       cs_item_sk = i_item_sk and
       cs_bill_cdemo_sk = cd_demo_sk and
       cs_promo_sk = p_promo_sk and
       cd_gender = 'M' and
       cd_marital_status = 'U' and
       cd_education_status = 'Primary' and
       (p_channel_email = 'N' or p_channel_event = 'N') and
       d_year = 1999
 group by i_item_id
 order by i_item_id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:30.965-07:00,2024-03-10T18:33:31.587-07:00,622,0,0,621,1,0,0,0,0,,,0,,,0,0.000095000,0,8.9.2,0,0,0,0,0,FALSE,5f18d64df5ddbac7d73e0d59ff33fdd2,2,59d43212905de6ae9539bf3126e1b730,1
"{""GlobalStats"":{""partitionsTotal"":72977,""partitionsAssigned"":72977,""bytesAssigned"":1252710266368},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SUM(SUM(SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_QUANTITY), COUNT(*)))))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_QUANTITY), COUNT(*)))))]""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_QUANTITY), COUNT(*))))]""],""parentOperators"":[1]},{""id"":3,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[2]},{""id"":4,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_QUANTITY), COUNT(*)))]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[3]},{""id"":6,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""DATE_DIM.D_YEAR = 1999""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(STORE_SALES.SS_QUANTITY), COUNT(*))]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_SOLD_DATE_SK]""],""parentOperators"":[6]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = STORE_SALES.SS_ADDR_SK)"",""joinFilter: ((CUSTOMER_ADDRESS.CA_STATE IN 'NC' IN 'SD' IN 'MS') AND ((STORE_SALES.SS_NET_PROFIT >= 0) AND (STORE_SALES.SS_NET_PROFIT <= 2000))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'MN' IN 'KS' IN 'IN') AND ((STORE_SALES.SS_NET_PROFIT >= 150) AND (STORE_SALES.SS_NET_PROFIT <= 3000))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'AR' IN 'ND' IN 'TX') AND ((STORE_SALES.SS_NET_PROFIT >= 50) AND (STORE_SALES.SS_NET_PROFIT <= 25000)))""],""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER_ADDRESS.CA_ADDRESS_SK, CUSTOMER_ADDRESS.CA_STATE]""],""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""(CUSTOMER_ADDRESS.CA_COUNTRY = 'United States') AND ((CUSTOMER_ADDRESS.CA_STATE IN 'NC' IN 'SD' IN 'MS') OR (CUSTOMER_ADDRESS.CA_STATE IN 'MN' IN 'KS' IN 'IN') OR (CUSTOMER_ADDRESS.CA_STATE IN 'AR' IN 'ND' IN 'TX'))""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE"",""CA_COUNTRY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[12]},{""id"":14,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_QUANTITY)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_SOLD_DATE_SK, STORE_SALES.SS_ADDR_SK, STORE_SALES.SS_NET_PROFIT]""],""parentOperators"":[10]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK = STORE_SALES.SS_CDEMO_SK)"",""joinFilter: ((CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS = 'M') AND (CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS = 'Advanced Degree') AND ((STORE_SALES.SS_SALES_PRICE >= 100) AND (STORE_SALES.SS_SALES_PRICE <= 150))) OR ((CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS = 'W') AND (CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS = 'College') AND ((STORE_SALES.SS_SALES_PRICE >= 50) AND (STORE_SALES.SS_SALES_PRICE <= 100))) OR ((CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS = 'U') AND (CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS = '2 yr Degree') AND ((STORE_SALES.SS_SALES_PRICE >= 150) AND (STORE_SALES.SS_SALES_PRICE <= 200)))""],""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""(CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS IN 'M' IN 'W' IN 'U') AND (CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS IN 'Advanced Degree' IN 'College' IN '2 yr Degree')""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_MARITAL_STATUS"",""CD_EDUCATION_STATUS""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[16]},{""id"":18,""operation"":""Filter"",""expressions"":[""((STORE_SALES.SS_SALES_PRICE >= 100) OR (STORE_SALES.SS_SALES_PRICE >= 50) OR (STORE_SALES.SS_SALES_PRICE <= 100) OR (STORE_SALES.SS_SALES_PRICE >= 150) OR (STORE_SALES.SS_SALES_PRICE <= 200)) AND ((STORE_SALES.SS_SALES_PRICE <= 150) OR (STORE_SALES.SS_SALES_PRICE >= 50) OR (STORE_SALES.SS_SALES_PRICE <= 100) OR (STORE_SALES.SS_SALES_PRICE >= 150) OR (STORE_SALES.SS_SALES_PRICE <= 200)) AND ((STORE_SALES.SS_NET_PROFIT >= 0) OR (STORE_SALES.SS_NET_PROFIT >= 150) OR (STORE_SALES.SS_NET_PROFIT <= 3000) OR (STORE_SALES.SS_NET_PROFIT >= 50) OR (STORE_SALES.SS_NET_PROFIT <= 25000)) AND ((STORE_SALES.SS_NET_PROFIT <= 2000) OR (STORE_SALES.SS_NET_PROFIT >= 150) OR (STORE_SALES.SS_NET_PROFIT <= 3000) OR (STORE_SALES.SS_NET_PROFIT >= 50) OR (STORE_SALES.SS_NET_PROFIT <= 25000)) AND (STORE_SALES.SS_ADDR_SK IS NOT NULL) AND (STORE_SALES.SS_CDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[15]},{""id"":19,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CDEMO_SK"",""SS_ADDR_SK"",""SS_STORE_SK"",""SS_QUANTITY"",""SS_SALES_PRICE"",""SS_NET_PROFIT""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[19]}]]}",01b2e7fd-0002-2d83-0051-ba87000251e6,"explain using json select /* { ""query"":""query48"",""streamId"":0,""querySequence"":74 } */ sum (ss_quantity)
 from store_sales, store, customer_demographics, customer_address, date_dim
 where s_store_sk = ss_store_sk
 and  ss_sold_date_sk = d_date_sk and d_year = 1999
 and
 (
  (
   cd_demo_sk = ss_cdemo_sk
   and
   cd_marital_status = 'M'
   and
   cd_education_status = 'Advanced Degree'
   and
   ss_sales_price between 100.00 and 150.00
   )
 or
  (
  cd_demo_sk = ss_cdemo_sk
   and
   cd_marital_status = 'W'
   and
   cd_education_status = 'College'
   and
   ss_sales_price between 50.00 and 100.00
  )
 or
 (
  cd_demo_sk = ss_cdemo_sk
  and
   cd_marital_status = 'U'
   and
   cd_education_status = '2 yr Degree'
   and
   ss_sales_price between 150.00 and 200.00
 )
 )
 and
 (
  (
  ss_addr_sk = ca_address_sk
  and
  ca_country = 'United States'
  and
  ca_state in ('NC', 'SD', 'MS')
  and ss_net_profit between 0 and 2000
  )
 or
  (ss_addr_sk = ca_address_sk
  and
  ca_country = 'United States'
  and
  ca_state in ('MN', 'KS', 'IN')
  and ss_net_profit between 150 and 3000
  )
 or
  (ss_addr_sk = ca_address_sk
  and
  ca_country = 'United States'
  and
  ca_state in ('AR', 'ND', 'TX')
  and ss_net_profit between 50 and 25000
  )
 )
;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:33:19.051-07:00,2024-03-10T18:33:19.741-07:00,690,0,0,689,1,0,0,0,0,,,0,,,0,0.000105000,0,8.9.2,0,0,0,0,0,FALSE,59e8cbc19013e40164ec23381fd3bb8c,2,b9dd08aeb1438ec74ae055508408e3f8,1
"{""GlobalStats"":{""partitionsTotal"":581768,""partitionsAssigned"":581768,""bytesAssigned"":10015403053056},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""COUNT(*)"",""COUNT(*)"",""COUNT(*)"",""COUNT(*)"",""COUNT(*)"",""COUNT(*)"",""COUNT(*)"",""COUNT(*)""]},{""id"":1,""operation"":""CartesianJoin"",""parentOperators"":[0]},{""id"":2,""operation"":""CartesianJoin"",""parentOperators"":[1]},{""id"":3,""operation"":""CartesianJoin"",""parentOperators"":[2]},{""id"":4,""operation"":""CartesianJoin"",""parentOperators"":[3]},{""id"":5,""operation"":""CartesianJoin"",""parentOperators"":[4]},{""id"":6,""operation"":""CartesianJoin"",""parentOperators"":[5]},{""id"":7,""operation"":""CartesianJoin"",""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""STORE.S_STORE_NAME = 'ese'""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[10]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT IN 4 IN 2""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[15]},{""id"":17,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[14]},{""id"":18,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = STORE_SALES.SS_SOLD_TIME_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR = 12) AND (TIME_DIM.T_MINUTE < 30)""],""parentOperators"":[18]},{""id"":20,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR"",""T_MINUTE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[19]},{""id"":21,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_TIME_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[18]},{""id"":22,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[21]},{""id"":23,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_TIME_SK"",""SS_HDEMO_SK"",""SS_STORE_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[22]},{""id"":24,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[7]},{""id"":25,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[24]},{""id"":26,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[25]},{""id"":27,""operation"":""Filter"",""expressions"":[""STORE.S_STORE_NAME = 'ese'""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[27]},{""id"":29,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[26]},{""id"":30,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[29]},{""id"":31,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT IN 4 IN 2""],""parentOperators"":[30]},{""id"":32,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[31]},{""id"":33,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[30]},{""id"":34,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = STORE_SALES.SS_SOLD_TIME_SK)""],""parentOperators"":[33]},{""id"":35,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR = 11) AND (TIME_DIM.T_MINUTE >= 30)""],""parentOperators"":[34]},{""id"":36,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR"",""T_MINUTE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[35]},{""id"":37,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_TIME_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[34]},{""id"":38,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[37]},{""id"":39,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_TIME_SK"",""SS_HDEMO_SK"",""SS_STORE_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[38]},{""id"":40,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[6]},{""id"":41,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[40]},{""id"":42,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[41]},{""id"":43,""operation"":""Filter"",""expressions"":[""STORE.S_STORE_NAME = 'ese'""],""parentOperators"":[42]},{""id"":44,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[43]},{""id"":45,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[42]},{""id"":46,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[45]},{""id"":47,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT IN 4 IN 2""],""parentOperators"":[46]},{""id"":48,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[47]},{""id"":49,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[46]},{""id"":50,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = STORE_SALES.SS_SOLD_TIME_SK)""],""parentOperators"":[49]},{""id"":51,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR = 11) AND (TIME_DIM.T_MINUTE < 30)""],""parentOperators"":[50]},{""id"":52,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR"",""T_MINUTE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[51]},{""id"":53,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_TIME_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[50]},{""id"":54,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[53]},{""id"":55,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_TIME_SK"",""SS_HDEMO_SK"",""SS_STORE_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[54]},{""id"":56,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[5]},{""id"":57,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[56]},{""id"":58,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[57]},{""id"":59,""operation"":""Filter"",""expressions"":[""STORE.S_STORE_NAME = 'ese'""],""parentOperators"":[58]},{""id"":60,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[59]},{""id"":61,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[58]},{""id"":62,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[61]},{""id"":63,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT IN 4 IN 2""],""parentOperators"":[62]},{""id"":64,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[63]},{""id"":65,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[62]},{""id"":66,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = STORE_SALES.SS_SOLD_TIME_SK)""],""parentOperators"":[65]},{""id"":67,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR = 10) AND (TIME_DIM.T_MINUTE >= 30)""],""parentOperators"":[66]},{""id"":68,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR"",""T_MINUTE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[67]},{""id"":69,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_TIME_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[66]},{""id"":70,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[69]},{""id"":71,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_TIME_SK"",""SS_HDEMO_SK"",""SS_STORE_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[70]},{""id"":72,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[4]},{""id"":73,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[72]},{""id"":74,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[73]},{""id"":75,""operation"":""Filter"",""expressions"":[""STORE.S_STORE_NAME = 'ese'""],""parentOperators"":[74]},{""id"":76,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[75]},{""id"":77,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[74]},{""id"":78,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[77]},{""id"":79,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT IN 4 IN 2""],""parentOperators"":[78]},{""id"":80,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[79]},{""id"":81,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[78]},{""id"":82,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = STORE_SALES.SS_SOLD_TIME_SK)""],""parentOperators"":[81]},{""id"":83,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR = 10) AND (TIME_DIM.T_MINUTE < 30)""],""parentOperators"":[82]},{""id"":84,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR"",""T_MINUTE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[83]},{""id"":85,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_TIME_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[82]},{""id"":86,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[85]},{""id"":87,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_TIME_SK"",""SS_HDEMO_SK"",""SS_STORE_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[86]},{""id"":88,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[3]},{""id"":89,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[88]},{""id"":90,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[89]},{""id"":91,""operation"":""Filter"",""expressions"":[""STORE.S_STORE_NAME = 'ese'""],""parentOperators"":[90]},{""id"":92,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[91]},{""id"":93,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[90]},{""id"":94,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[93]},{""id"":95,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT IN 4 IN 2""],""parentOperators"":[94]},{""id"":96,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[95]},{""id"":97,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[94]},{""id"":98,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = STORE_SALES.SS_SOLD_TIME_SK)""],""parentOperators"":[97]},{""id"":99,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR = 9) AND (TIME_DIM.T_MINUTE >= 30)""],""parentOperators"":[98]},{""id"":100,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR"",""T_MINUTE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[99]},{""id"":101,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_TIME_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[98]},{""id"":102,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[101]},{""id"":103,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_TIME_SK"",""SS_HDEMO_SK"",""SS_STORE_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[102]},{""id"":104,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[2]},{""id"":105,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[104]},{""id"":106,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[105]},{""id"":107,""operation"":""Filter"",""expressions"":[""STORE.S_STORE_NAME = 'ese'""],""parentOperators"":[106]},{""id"":108,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[107]},{""id"":109,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK]""],""parentOperators"":[106]},{""id"":110,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[109]},{""id"":111,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT IN 4 IN 2""],""parentOperators"":[110]},{""id"":112,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[111]},{""id"":113,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[110]},{""id"":114,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = STORE_SALES.SS_SOLD_TIME_SK)""],""parentOperators"":[113]},{""id"":115,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR = 9) AND (TIME_DIM.T_MINUTE < 30)""],""parentOperators"":[114]},{""id"":116,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR"",""T_MINUTE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[115]},{""id"":117,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_TIME_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[114]},{""id"":118,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[117]},{""id"":119,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_TIME_SK"",""SS_HDEMO_SK"",""SS_STORE_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[118]},{""id"":120,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[1]},{""id"":121,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[120]},{""id"":122,""operation"":""InnerJoin"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[121]},{""id"":123,""operation"":""Filter"",""expressions"":[""HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT IN 4 IN 2""],""parentOperators"":[122]},{""id"":124,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS""],""expressions"":[""HD_DEMO_SK"",""HD_DEP_COUNT""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":30720,""parentOperators"":[123]},{""id"":125,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_HDEMO_SK]""],""parentOperators"":[122]},{""id"":126,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[125]},{""id"":127,""operation"":""Filter"",""expressions"":[""STORE.S_STORE_NAME = 'ese'""],""parentOperators"":[126]},{""id"":128,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_NAME""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[127]},{""id"":129,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [STORE_SALES.SS_HDEMO_SK, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[126]},{""id"":130,""operation"":""InnerJoin"",""expressions"":[""joinKey: (TIME_DIM.T_TIME_SK = STORE_SALES.SS_SOLD_TIME_SK)""],""parentOperators"":[129]},{""id"":131,""operation"":""Filter"",""expressions"":[""(TIME_DIM.T_HOUR = 8) AND (TIME_DIM.T_MINUTE >= 30)""],""parentOperators"":[130]},{""id"":132,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM""],""expressions"":[""T_TIME_SK"",""T_HOUR"",""T_MINUTE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":1124352,""parentOperators"":[131]},{""id"":133,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_SOLD_TIME_SK IS NOT NULL) AND (STORE_SALES.SS_HDEMO_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL)""],""parentOperators"":[130]},{""id"":134,""operation"":""JoinFilter"",""expressions"":[""joinKey: (HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK = STORE_SALES.SS_HDEMO_SK)""],""parentOperators"":[133]},{""id"":135,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_TIME_SK"",""SS_HDEMO_SK"",""SS_STORE_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[134]}]]}",01b2e7fc-0002-2d83-0051-ba87000251ce,"explain using json select /* { ""query"":""query88"",""streamId"":0,""querySequence"":66 } */  *
from
 (select count(*) h8_30_to_9
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 8
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))
     and store.s_store_name = 'ese') s1,
 (select count(*) h9_to_9_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 9
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))
     and store.s_store_name = 'ese') s2,
 (select count(*) h9_30_to_10
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 9
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))
     and store.s_store_name = 'ese') s3,
 (select count(*) h10_to_10_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 10
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))
     and store.s_store_name = 'ese') s4,
 (select count(*) h10_30_to_11
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 10
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))
     and store.s_store_name = 'ese') s5,
 (select count(*) h11_to_11_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 11
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))
     and store.s_store_name = 'ese') s6,
 (select count(*) h11_30_to_12
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 11
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))
     and store.s_store_name = 'ese') s7,
 (select count(*) h12_to_12_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 12
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))
     and store.s_store_name = 'ese') s8
;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:14.803-07:00,2024-03-10T18:32:16.268-07:00,1465,0,0,1463,2,0,0,0,0,,,0,,,0,0.000224000,0,8.9.2,0,0,0,0,0,FALSE,aae66866c2a54ff27908b7764ed19b67,2,fb26a20d01050b5ec183a4e06fa2d731,1
"{""GlobalStats"":{""partitionsTotal"":54925,""partitionsAssigned"":54925,""bytesAssigned"":923643425792},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""ITEM.I_ITEM_DESC"",""ITEM.I_CATEGORY"",""ITEM.I_CLASS"",""ITEM.I_CURRENT_PRICE"",""SUM(SUM_INTERNAL(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), COUNT(*)))"",""((SUM(SUM_INTERNAL(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), COUNT(*)))) * 100) / (SUM(SUM(SUM_INTERNAL(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [ITEM.I_CATEGORY ASC NULLS LAST, ITEM.I_CLASS ASC NULLS LAST, ITEM.I_ITEM_ID ASC NULLS LAST, ITEM.I_ITEM_DESC ASC NULLS LAST, ((SUM(CATALOG_SALES.CS_EXT_SALES_PRICE)) * 100) / (SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE)) OVER (PARTITION BY ITEM.I_CLASS)) ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""WindowFunction"",""expressions"":[""SUM(SUM(SUM_INTERNAL(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS)"",""SUM(SUM(SUM_INTERNAL(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS)""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), COUNT(*)))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), COUNT(*))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CURRENT_PRICE, ITEM.I_CLASS, ITEM.I_CATEGORY]""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""ITEM.I_CATEGORY IN 'Men' IN 'Books' IN 'Electronics'""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID"",""I_ITEM_DESC"",""I_CURRENT_PRICE"",""I_CLASS"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(CATALOG_SALES.CS_EXT_SALES_PRICE)]"",""groupKeys: [CATALOG_SALES.CS_ITEM_SK]""],""parentOperators"":[5]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2002-02-23') AND (DATE_DIM.D_DATE <= '2002-03-25')""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[10]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_ITEM_SK"",""CS_EXT_SALES_PRICE""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[14]}]]}",01b2e7fc-0002-2f4b-0051-ba870002616e,"explain using json select /* { ""query"":""query20"",""streamId"":0,""querySequence"":65 } */  i_item_id
       ,i_item_desc
       ,i_category
       ,i_class
       ,i_current_price
       ,sum(cs_ext_sales_price) as itemrevenue
       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over
           (partition by i_class) as revenueratio
 from	catalog_sales
     ,item
     ,date_dim
 where cs_item_sk = i_item_sk
   and i_category in ('Men', 'Books', 'Electronics')
   and cs_sold_date_sk = d_date_sk
 and d_date between cast('2002-02-23' as date)
 				and (cast('2002-02-23' as date) + interval '30 days')
 group by i_item_id
         ,i_item_desc
         ,i_category
         ,i_class
         ,i_current_price
 order by i_category
         ,i_class
         ,i_item_id
         ,i_item_desc
         ,revenueratio
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:14.285-07:00,2024-03-10T18:32:14.535-07:00,250,0,0,249,1,0,0,0,0,,,0,,,0,0.000038000,0,8.9.2,0,0,0,0,0,FALSE,dcf310814d42707a9d8768f5ab1c80f9,2,dcf310814d42707a9d8768f5ab1c80f9,1
"{""GlobalStats"":{""partitionsTotal"":4,""partitionsAssigned"":4,""bytesAssigned"":47623168},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""I1.I_PRODUCT_NAME""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [I1.I_PRODUCT_NAME ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""groupKeys: [I1.I_PRODUCT_NAME]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""groupKeys: [I1.I_PRODUCT_NAME]""],""parentOperators"":[2]},{""id"":4,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_MANUFACT = I1.I_MANUFACT)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_MANUFACT]""],""parentOperators"":[4]},{""id"":6,""operation"":""Filter"",""expressions"":[""((NVL(COUNT(*), 0)) > 0) AND (COUNT(*) IS NOT NULL)""],""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_MANUFACT]""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""(ITEM.I_MANUFACT IS NOT NULL) AND (ITEM.I_CATEGORY IN 'Women' IN 'Men') AND ((ITEM.I_SIZE IN 'economy' IN 'large') OR (ITEM.I_SIZE IN 'extra large' IN 'petite') OR (ITEM.I_SIZE IN 'medium' IN 'N/A')) AND ((((ITEM.I_COLOR IN 'forest' IN 'dodger') OR (ITEM.I_COLOR IN 'green' IN 'olive') OR (ITEM.I_COLOR IN 'navajo' IN 'dark') OR (ITEM.I_COLOR IN 'navy' IN 'lace')) AND ((ITEM.I_UNITS IN 'Tbl' IN 'Carton') OR (ITEM.I_UNITS IN 'Dram' IN 'Unknown') OR (ITEM.I_UNITS IN 'Bundle' IN 'Tsp') OR (ITEM.I_UNITS IN 'Gross' IN 'Ton')) AND (((ITEM.I_CATEGORY = 'Women') AND (ITEM.I_COLOR IN 'forest' IN 'dodger') AND (ITEM.I_UNITS IN 'Tbl' IN 'Carton') AND (ITEM.I_SIZE IN 'economy' IN 'large')) OR ((ITEM.I_CATEGORY = 'Women') AND (ITEM.I_COLOR IN 'green' IN 'olive') AND (ITEM.I_UNITS IN 'Dram' IN 'Unknown') AND (ITEM.I_SIZE IN 'extra large' IN 'petite')) OR ((ITEM.I_CATEGORY = 'Men') AND (ITEM.I_COLOR IN 'navajo' IN 'dark') AND (ITEM.I_UNITS IN 'Bundle' IN 'Tsp') AND (ITEM.I_SIZE IN 'medium' IN 'N/A')...""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_CATEGORY"",""I_MANUFACT"",""I_SIZE"",""I_COLOR"",""I_UNITS""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""groupKeys: [I1.I_PRODUCT_NAME, I1.I_MANUFACT]""],""parentOperators"":[4]},{""id"":11,""operation"":""Filter"",""expressions"":[""(I1.I_MANUFACT IS NOT NULL) AND (I1.I_MANUFACT_ID >= 691) AND (I1.I_MANUFACT_ID <= 731)""],""parentOperators"":[10]},{""id"":12,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_MANUFACT = I1.I_MANUFACT)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_MANUFACT_ID"",""I_MANUFACT"",""I_PRODUCT_NAME""],""alias"":""I1"",""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[12]}]]}",01b2e7fc-0002-2d15-0051-ba8700019706,"explain using json select /* { ""query"":""query41"",""streamId"":0,""querySequence"":62 } */  distinct(i_product_name)
 from item i1
 where i_manufact_id between 691 and 691+40
   and (select count(*) as item_cnt
        from item
        where (i_manufact = i1.i_manufact and
        ((i_category = 'Women' and
        (i_color = 'forest' or i_color = 'dodger') and
        (i_units = 'Tbl' or i_units = 'Carton') and
        (i_size = 'economy' or i_size = 'large')
        ) or
        (i_category = 'Women' and
        (i_color = 'green' or i_color = 'olive') and
        (i_units = 'Dram' or i_units = 'Unknown') and
        (i_size = 'extra large' or i_size = 'petite')
        ) or
        (i_category = 'Men' and
        (i_color = 'navajo' or i_color = 'dark') and
        (i_units = 'Bundle' or i_units = 'Tsp') and
        (i_size = 'medium' or i_size = 'N/A')
        ) or
        (i_category = 'Men' and
        (i_color = 'navy' or i_color = 'lace') and
        (i_units = 'Gross' or i_units = 'Ton') and
        (i_size = 'economy' or i_size = 'large')
        ))) or
       (i_manufact = i1.i_manufact and
        ((i_category = 'Women' and
        (i_color = 'chiffon' or i_color = 'medium') and
        (i_units = 'Pound' or i_units = 'Dozen') and
        (i_size = 'economy' or i_size = 'large')
        ) or
        (i_category = 'Women' and
        (i_color = 'cornsilk' or i_color = 'grey') and
        (i_units = 'Box' or i_units = 'Ounce') and
        (i_size = 'extra large' or i_size = 'petite')
        ) or
        (i_category = 'Men' and
        (i_color = 'sky' or i_color = 'blanched') and
        (i_units = 'Case' or i_units = 'Gram') and
        (i_size = 'medium' or i_size = 'N/A')
        ) or
        (i_category = 'Men' and
        (i_color = 'azure' or i_color = 'firebrick') and
        (i_units = 'N/A' or i_units = 'Cup') and
        (i_size = 'economy' or i_size = 'large')
        )))) > 0
 order by i_product_name
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:12.052-07:00,2024-03-10T18:32:12.153-07:00,101,0,0,100,1,0,0,0,0,,,0,,,0,0.000015000,0,8.9.2,0,0,0,0,0,FALSE,d3c5eeffef232ef71ca704d4e46d03e4,2,d8e4ed860c1c4b49376954d92901207c,1
"{""GlobalStats"":{""partitionsTotal"":72721,""partitionsAssigned"":72721,""bytesAssigned"":1251950041088},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""DT.D_YEAR"",""ITEM.I_CATEGORY_ID"",""ITEM.I_CATEGORY"",""SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [SUM(STORE_SALES.SS_EXT_SALES_PRICE) DESC NULLS FIRST, DT.D_YEAR ASC NULLS LAST, ITEM.I_CATEGORY_ID ASC NULLS LAST, ITEM.I_CATEGORY ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))]"",""groupKeys: [DT.D_YEAR, ITEM.I_CATEGORY_ID, ITEM.I_CATEGORY]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))]"",""groupKeys: [DT.D_YEAR, ITEM.I_CATEGORY_ID, ITEM.I_CATEGORY]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Filter"",""expressions"":[""ITEM.I_MANAGER_ID = 1""],""parentOperators"":[4]},{""id"":6,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_CATEGORY_ID"",""I_CATEGORY"",""I_MANAGER_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE)]"",""groupKeys: [DT.D_YEAR, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[4]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DT.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""Filter"",""expressions"":[""(DT.D_YEAR = 2002) AND (DT.D_MOY = 12)""],""parentOperators"":[8]},{""id"":10,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""alias"":""DT"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[8]},{""id"":12,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[12]}]]}",01b2e7fc-0002-3000-0051-ba870002f042,"explain using json select /* { ""query"":""query42"",""streamId"":0,""querySequence"":61 } */  dt.d_year
 	,item.i_category_id
 	,item.i_category
 	,sum(ss_ext_sales_price)
 from 	date_dim dt
 	,store_sales
 	,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
 	and store_sales.ss_item_sk = item.i_item_sk
 	and item.i_manager_id = 1
 	and dt.d_moy=12
 	and dt.d_year=2002
 group by 	dt.d_year
 		,item.i_category_id
 		,item.i_category
 order by       sum(ss_ext_sales_price) desc,dt.d_year
 		,item.i_category_id
 		,item.i_category
limit 100 ;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:11.242-07:00,2024-03-10T18:32:11.623-07:00,381,0,0,380,1,0,0,0,0,,,0,,,0,0.000058000,0,8.9.2,0,0,0,0,0,FALSE,737c0ca80c221d05b1e6f268d9208c22,2,40e6d5415c672b9361a6bd3c6b3ceaa2,1
"{""GlobalStats"":{""partitionsTotal"":100811,""partitionsAssigned"":100811,""bytesAssigned"":1714522763264},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""SS1.CA_COUNTY"",""SS1.D_YEAR"",""(WS2.WEB_SALES) / (WS1.WEB_SALES)"",""(SS2.STORE_SALES) / (SS1.STORE_SALES)"",""(WS3.WEB_SALES) / (WS2.WEB_SALES)"",""(SS3.STORE_SALES) / (SS2.STORE_SALES)""]},{""id"":1,""operation"":""Sort"",""expressions"":[""(SS3.STORE_SALES) / (SS2.STORE_SALES) ASC NULLS LAST""],""parentOperators"":[0]},{""id"":2,""operation"":""InnerJoin"",""expressions"":[""joinKey: (SS3.CA_COUNTY = SS2.CA_COUNTY)"",""joinFilter: (IFF(WS2.WEB_SALES > 0, (WS3.WEB_SALES) / (WS2.WEB_SALES), null)) > (IFF(SS2.STORE_SALES > 0, (SS3.STORE_SALES) / (SS2.STORE_SALES), null))""],""parentOperators"":[1]},{""id"":3,""operation"":""WithReference"",""expressions"":[""SS3""],""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_QOY = 3) AND (CUSTOMER_ADDRESS.CA_COUNTY IS NOT NULL)""],""parentOperators"":[3]},{""id"":5,""operation"":""WithClause"",""expressions"":[""SS""],""parentOperators"":[4,20,26]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))]"",""groupKeys: [CUSTOMER_ADDRESS.CA_COUNTY, DATE_DIM.D_QOY, DATE_DIM.D_YEAR]""],""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))]"",""groupKeys: [CUSTOMER_ADDRESS.CA_COUNTY, DATE_DIM.D_QOY, DATE_DIM.D_YEAR]""],""parentOperators"":[6]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = STORE_SALES.SS_ADDR_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_COUNTY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE)]"",""groupKeys: [DATE_DIM.D_YEAR, DATE_DIM.D_QOY, STORE_SALES.SS_ADDR_SK]""],""parentOperators"":[8]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_QOY IN 1 IN 2 IN 3)""],""parentOperators"":[11]},{""id"":13,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[12]},{""id"":14,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_ADDR_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[11]},{""id"":15,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = STORE_SALES.SS_ADDR_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ADDR_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[15]},{""id"":17,""operation"":""InnerJoin"",""expressions"":[""joinKey: (SS2.CA_COUNTY = SS1.CA_COUNTY)"",""joinFilter: (IFF(WS1.WEB_SALES > 0, (WS2.WEB_SALES) / (WS1.WEB_SALES), null)) > (IFF(SS1.STORE_SALES > 0, (SS2.STORE_SALES) / (SS1.STORE_SALES), null))""],""parentOperators"":[2]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (SS3.CA_COUNTY = SS2.CA_COUNTY)"",""joinFilter: (IFF(WS2.WEB_SALES > 0, (WS3.WEB_SALES) / (WS2.WEB_SALES), null)) > (IFF(SS2.STORE_SALES > 0, (SS3.STORE_SALES) / (SS2.STORE_SALES), null))""],""parentOperators"":[17]},{""id"":19,""operation"":""WithReference"",""expressions"":[""SS2""],""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_QOY = 2) AND (CUSTOMER_ADDRESS.CA_COUNTY IS NOT NULL)""],""parentOperators"":[19]},{""id"":21,""operation"":""InnerJoin"",""expressions"":[""joinKey: (SS1.CA_COUNTY = WS1.CA_COUNTY)""],""parentOperators"":[17]},{""id"":22,""operation"":""InnerJoin"",""expressions"":[""joinKey: (SS1.CA_COUNTY = WS3.CA_COUNTY)""],""parentOperators"":[21]},{""id"":23,""operation"":""InnerJoin"",""expressions"":[""joinKey: (SS1.CA_COUNTY = WS2.CA_COUNTY)""],""parentOperators"":[22]},{""id"":24,""operation"":""JoinFilter"",""expressions"":[""joinKey: (SS3.CA_COUNTY = SS2.CA_COUNTY)"",""joinFilter: (IFF(WS2.WEB_SALES > 0, (WS3.WEB_SALES) / (WS2.WEB_SALES), null)) > (IFF(SS2.STORE_SALES > 0, (SS3.STORE_SALES) / (SS2.STORE_SALES), null))""],""parentOperators"":[23]},{""id"":25,""operation"":""WithReference"",""expressions"":[""SS1""],""parentOperators"":[24]},{""id"":26,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_QOY = 1) AND (CUSTOMER_ADDRESS.CA_COUNTY IS NOT NULL)""],""parentOperators"":[25]},{""id"":27,""operation"":""JoinFilter"",""expressions"":[""joinKey: (SS3.CA_COUNTY = SS2.CA_COUNTY)"",""joinFilter: (IFF(WS2.WEB_SALES > 0, (WS3.WEB_SALES) / (WS2.WEB_SALES), null)) > (IFF(SS2.STORE_SALES > 0, (SS3.STORE_SALES) / (SS2.STORE_SALES), null))""],""parentOperators"":[23]},{""id"":28,""operation"":""WithReference"",""expressions"":[""WS2""],""parentOperators"":[27]},{""id"":29,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_QOY = 2) AND (WS2.CA_COUNTY IS NOT NULL)""],""parentOperators"":[28]},{""id"":30,""operation"":""WithClause"",""expressions"":[""WS""],""parentOperators"":[29,44,47]},{""id"":31,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE)))]"",""groupKeys: [CUSTOMER_ADDRESS.CA_COUNTY, DATE_DIM.D_QOY, DATE_DIM.D_YEAR]""],""parentOperators"":[30]},{""id"":32,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE))]"",""groupKeys: [CUSTOMER_ADDRESS.CA_COUNTY, DATE_DIM.D_QOY, DATE_DIM.D_YEAR]""],""parentOperators"":[31]},{""id"":33,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = WEB_SALES.WS_BILL_ADDR_SK)""],""parentOperators"":[32]},{""id"":34,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_COUNTY""],""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[33]},{""id"":35,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(WEB_SALES.WS_EXT_SALES_PRICE)]"",""groupKeys: [DATE_DIM.D_YEAR, DATE_DIM.D_QOY, WEB_SALES.WS_BILL_ADDR_SK]""],""parentOperators"":[33]},{""id"":36,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[35]},{""id"":37,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_QOY IN 1 IN 2 IN 3)""],""parentOperators"":[36]},{""id"":38,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[37]},{""id"":39,""operation"":""Filter"",""expressions"":[""(WEB_SALES.WS_BILL_ADDR_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[36]},{""id"":40,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CUSTOMER_ADDRESS.CA_ADDRESS_SK = WEB_SALES.WS_BILL_ADDR_SK)""],""parentOperators"":[39]},{""id"":41,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_BILL_ADDR_SK"",""WS_EXT_SALES_PRICE""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[40]},{""id"":42,""operation"":""JoinFilter"",""expressions"":[""joinKey: (SS3.CA_COUNTY = SS2.CA_COUNTY)"",""joinFilter: (IFF(WS2.WEB_SALES > 0, (WS3.WEB_SALES) / (WS2.WEB_SALES), null)) > (IFF(SS2.STORE_SALES > 0, (SS3.STORE_SALES) / (SS2.STORE_SALES), null))""],""parentOperators"":[22]},{""id"":43,""operation"":""WithReference"",""expressions"":[""WS3""],""parentOperators"":[42]},{""id"":44,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_QOY = 3) AND (CUSTOMER_ADDRESS.CA_COUNTY IS NOT NULL)""],""parentOperators"":[43]},{""id"":45,""operation"":""JoinFilter"",""expressions"":[""joinKey: (SS3.CA_COUNTY = SS2.CA_COUNTY)"",""joinFilter: (IFF(WS2.WEB_SALES > 0, (WS3.WEB_SALES) / (WS2.WEB_SALES), null)) > (IFF(SS2.STORE_SALES > 0, (SS3.STORE_SALES) / (SS2.STORE_SALES), null))""],""parentOperators"":[21]},{""id"":46,""operation"":""WithReference"",""expressions"":[""WS1""],""parentOperators"":[45]},{""id"":47,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_QOY = 1) AND (CUSTOMER_ADDRESS.CA_COUNTY IS NOT NULL)""],""parentOperators"":[46]}]]}",01b2e7fc-0002-300b-0051-ba870002c0a6,"explain using json with /* { ""query"":""query31"",""streamId"":0,""querySequence"":50 } */ ss as
 (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales
 from store_sales,date_dim,customer_address
 where ss_sold_date_sk = d_date_sk
  and ss_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year),
 ws as
 (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales
 from web_sales,date_dim,customer_address
 where ws_sold_date_sk = d_date_sk
  and ws_bill_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year)
 select
        ss1.ca_county
       ,ss1.d_year
       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase
       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase
       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase
       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase
 from
        ss ss1
       ,ss ss2
       ,ss ss3
       ,ws ws1
       ,ws ws2
       ,ws ws3
 where
    ss1.d_qoy = 1
    and ss1.d_year = 2000
    and ss1.ca_county = ss2.ca_county
    and ss2.d_qoy = 2
    and ss2.d_year = 2000
 and ss2.ca_county = ss3.ca_county
    and ss3.d_qoy = 3
    and ss3.d_year = 2000
    and ss1.ca_county = ws1.ca_county
    and ws1.d_qoy = 1
    and ws1.d_year = 2000
    and ws1.ca_county = ws2.ca_county
    and ws2.d_qoy = 2
    and ws2.d_year = 2000
    and ws1.ca_county = ws3.ca_county
    and ws3.d_qoy = 3
    and ws3.d_year =2000
    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end
       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end
    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end
       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end
 order by store_q2_q3_increase;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:32:00.936-07:00,2024-03-10T18:32:01.51-07:00,574,0,0,572,2,0,0,0,0,,,0,,,0,0.000088000,0,8.9.2,0,0,0,0,0,FALSE,2a86a9fa5bc46e311365d28199207eb1,2,32db448e9bebb13b2c29095c18ad4250,1
"{""GlobalStats"":{""partitionsTotal"":1090771,""partitionsAssigned"":1090771,""bytesAssigned"":18778861365760},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""COUNT(*)""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 1) AND (STORE_SALES.SS_QUANTITY <= 20)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_EXT_SALES_PRICE)) / (COUNT(STORE_SALES.SS_EXT_SALES_PRICE))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(STORE_SALES.SS_EXT_SALES_PRICE)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 1) AND (STORE_SALES.SS_QUANTITY <= 20)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_NET_PAID_INC_TAX)) / (COUNT(STORE_SALES.SS_NET_PAID_INC_TAX))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_NET_PAID_INC_TAX), COUNT(STORE_SALES.SS_NET_PAID_INC_TAX)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 1) AND (STORE_SALES.SS_QUANTITY <= 20)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_NET_PAID_INC_TAX""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""COUNT(*)""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 21) AND (STORE_SALES.SS_QUANTITY <= 40)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_EXT_SALES_PRICE)) / (COUNT(STORE_SALES.SS_EXT_SALES_PRICE))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(STORE_SALES.SS_EXT_SALES_PRICE)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 21) AND (STORE_SALES.SS_QUANTITY <= 40)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_NET_PAID_INC_TAX)) / (COUNT(STORE_SALES.SS_NET_PAID_INC_TAX))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_NET_PAID_INC_TAX), COUNT(STORE_SALES.SS_NET_PAID_INC_TAX)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 21) AND (STORE_SALES.SS_QUANTITY <= 40)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_NET_PAID_INC_TAX""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""COUNT(*)""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 41) AND (STORE_SALES.SS_QUANTITY <= 60)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_EXT_SALES_PRICE)) / (COUNT(STORE_SALES.SS_EXT_SALES_PRICE))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(STORE_SALES.SS_EXT_SALES_PRICE)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 41) AND (STORE_SALES.SS_QUANTITY <= 60)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_NET_PAID_INC_TAX)) / (COUNT(STORE_SALES.SS_NET_PAID_INC_TAX))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_NET_PAID_INC_TAX), COUNT(STORE_SALES.SS_NET_PAID_INC_TAX)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 41) AND (STORE_SALES.SS_QUANTITY <= 60)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_NET_PAID_INC_TAX""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""COUNT(*)""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 61) AND (STORE_SALES.SS_QUANTITY <= 80)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_EXT_SALES_PRICE)) / (COUNT(STORE_SALES.SS_EXT_SALES_PRICE))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(STORE_SALES.SS_EXT_SALES_PRICE)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 61) AND (STORE_SALES.SS_QUANTITY <= 80)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_NET_PAID_INC_TAX)) / (COUNT(STORE_SALES.SS_NET_PAID_INC_TAX))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_NET_PAID_INC_TAX), COUNT(STORE_SALES.SS_NET_PAID_INC_TAX)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 61) AND (STORE_SALES.SS_QUANTITY <= 80)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_NET_PAID_INC_TAX""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""COUNT(*)""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 81) AND (STORE_SALES.SS_QUANTITY <= 100)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_EXT_SALES_PRICE)) / (COUNT(STORE_SALES.SS_EXT_SALES_PRICE))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(STORE_SALES.SS_EXT_SALES_PRICE)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 81) AND (STORE_SALES.SS_QUANTITY <= 100)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""(SUM(STORE_SALES.SS_NET_PAID_INC_TAX)) / (COUNT(STORE_SALES.SS_NET_PAID_INC_TAX))""]},{""id"":1,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_NET_PAID_INC_TAX), COUNT(STORE_SALES.SS_NET_PAID_INC_TAX)]""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_QUANTITY >= 81) AND (STORE_SALES.SS_QUANTITY <= 100)""],""parentOperators"":[1]},{""id"":3,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_QUANTITY"",""SS_NET_PAID_INC_TAX""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[2]}],[{""id"":0,""operation"":""Result"",""expressions"":[""IFF(Subquery(Step1) > 22323234, Subquery(Step2), Subquery(Step3))"",""IFF(Subquery(Step4) > 219711013, Subquery(Step5), Subquery(Step6))"",""IFF(Subquery(Step7) > 219311390, Subquery(Step8), Subquery(Step9))"",""IFF(Subquery(Step10) > 259878475, Subquery(Step11), Subquery(Step12))"",""IFF(Subquery(Step13) > 27693204, Subquery(Step14), Subquery(Step15))""]},{""id"":1,""operation"":""Filter"",""expressions"":[""REASON.R_REASON_SK = 1""],""parentOperators"":[0]},{""id"":2,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.REASON""],""expressions"":[""R_REASON_SK""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2560,""parentOperators"":[1]}]]}",01b2e7fb-0002-2fe3-0051-ba870002e056,"explain using json select /* { ""query"":""query09"",""streamId"":0,""querySequence"":49 } */ case when (select count(*)
                  from store_sales
                  where ss_quantity between 1 and 20) > 22323234
            then (select avg(ss_ext_sales_price)
                  from store_sales
                  where ss_quantity between 1 and 20)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 1 and 20) end bucket1 ,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 21 and 40) > 219711013
            then (select avg(ss_ext_sales_price)
                  from store_sales
                  where ss_quantity between 21 and 40)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 21 and 40) end bucket2,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 41 and 60) > 219311390
            then (select avg(ss_ext_sales_price)
                  from store_sales
                  where ss_quantity between 41 and 60)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 41 and 60) end bucket3,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 61 and 80) > 259878475
            then (select avg(ss_ext_sales_price)
                  from store_sales
                  where ss_quantity between 61 and 80)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 61 and 80) end bucket4,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 81 and 100) > 27693204
            then (select avg(ss_ext_sales_price)
                  from store_sales
                  where ss_quantity between 81 and 100)
            else (select avg(ss_net_paid_inc_tax)
                  from store_sales
                  where ss_quantity between 81 and 100) end bucket5
from reason
where r_reason_sk = 1
;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:58.994-07:00,2024-03-10T18:32:00.464-07:00,1470,0,0,1468,2,0,0,0,0,,,0,,,0,0.000224000,0,8.9.2,0,0,0,0,0,FALSE,7be0b8316f1b5167a3b258510e1eb4fa,2,24559fff162c3ff356ffdf15e12c4dd2,1
"{""GlobalStats"":{""partitionsTotal"":169340,""partitionsAssigned"":166826,""bytesAssigned"":2840220921856},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""\""values\"".CHANNEL"",""UNION_ALL(WS.WS_ITEM_SK, CS.CS_ITEM_SK, STS.SS_ITEM_SK)"",""UNION_ALL((SUM(SUM_INTERNAL(IFNULL(WR.WR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(WS.WS_QUANTITY, 0))))), (SUM(SUM_INTERNAL(IFNULL(CR.CR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(CS.CS_QUANTITY, 0))))), (SUM(SUM_INTERNAL(IFNULL(SR.SR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(STS.SS_QUANTITY, 0))))))"",""UNION_ALL(RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(WR.WR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(WS.WS_QUANTITY, 0))))) ASC NULLS LAST), RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(CR.CR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(CS.CS_QUANTITY, 0))))) ASC NULLS LAST), RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(SR.SR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(STS.SS_QUANTITY, 0))))) ASC NULLS LAST))"",""UNION_ALL(RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(WR.WR_RETURN_AMT, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(WS.WS_NET_PAID, 0))))) ASC NULLS LAST), RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(CR.CR_RETURN_AMOUNT, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(CS.CS_NET_PAID, 0))))) ASC NULLS LAST), RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(SR.SR_RETURN_AMT, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(STS.SS_NET_PAID, 0))))) ASC NULLS LAST))""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [\""values\"".CHANNEL ASC NULLS LAST, \""values\"".RETURN_RANK ASC NULLS LAST, \""values\"".CURRENCY_RANK ASC NULLS LAST, \""values\"".ITEM ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""groupKeys: [UNION_ALL('web', 'catalog', 'store'), UNION_ALL(WS.WS_ITEM_SK, CS.CS_ITEM_SK, STS.SS_ITEM_SK), UNION_ALL((SUM(IFNULL(WR.WR_RETURN_QUANTITY, 0))) / (SUM(IFNULL(WS.WS_QUANTITY, 0))), (SUM(IFNULL(CR.CR_RETURN_QUANTITY, 0))) / (SUM(IFNULL(CS.CS_QUANTITY, 0))), (SUM(IFNULL(SR.SR_RETURN_QUANTITY, 0))) / (SUM(IFNULL(STS.SS_QUANTITY, 0)))), UNION_ALL(RANK() OVER (ORDER BY (SUM(IFNULL(WR.WR_RETURN_QUANTITY, 0))) / (SUM(IFNULL(WS.WS_QUANTITY, 0))) ASC NULLS LAST), RANK() OVER (ORDER BY (SUM(IFNULL(CR.CR_RETURN_QUANTITY, 0))) / (SUM(IFNULL(CS.CS_QUANTITY, 0))) ASC NULLS LAST), RANK() OVER (ORDER BY (SUM(IFNULL(SR.SR_RETURN_QUANTITY, 0))) / (SUM(IFNULL(STS.SS_QUANTITY, 0))) ASC NULLS LAST)), UNION_ALL(RANK() OVER (ORDER BY (SUM(IFNULL(WR.WR_RETURN_AMT, 0))) / (SUM(IFNULL(WS.WS_NET_PAID, 0))) ASC NULLS LAST), RANK() OVER (ORDER BY (SUM(IFNULL(CR.CR_RETURN_AMOUNT, 0))) / (SUM(IFNULL(CS.CS_NET_PAID, 0))) ASC NULLS LAST), RANK() OVER (ORDER BY (SUM(IFNULL(SR.SR_RETURN_AMT, 0))) / (SUM(IFNULL(STS.SS_NET_PAID, 0))) ASC NULLS LAST))]""],""parentOperators"":[1]},{""id"":3,""operation"":""UnionAll"",""parentOperators"":[2]},{""id"":4,""operation"":""Filter"",""expressions"":[""(RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(WR.WR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(WS.WS_QUANTITY, 0))))) ASC NULLS LAST) <= 10) OR (RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(WR.WR_RETURN_AMT, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(WS.WS_NET_PAID, 0))))) ASC NULLS LAST) <= 10)""],""parentOperators"":[3]},{""id"":5,""operation"":""WindowFunction"",""expressions"":[""RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(WR.WR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(WS.WS_QUANTITY, 0))))) ASC NULLS LAST)"",""RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(WR.WR_RETURN_AMT, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(WS.WS_NET_PAID, 0))))) ASC NULLS LAST)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(IFNULL(WR.WR_RETURN_QUANTITY, 0), COUNT(*))), SUM(SUM(SUM(IFNULL(WS.WS_QUANTITY, 0)))), SUM(SUM_INTERNAL(IFNULL(WR.WR_RETURN_AMT, 0), COUNT(*))), SUM(SUM(SUM(IFNULL(WS.WS_NET_PAID, 0))))]"",""groupKeys: [WS.WS_ITEM_SK]""],""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(IFNULL(WR.WR_RETURN_QUANTITY, 0), COUNT(*)), SUM(SUM(IFNULL(WS.WS_QUANTITY, 0))), SUM_INTERNAL(IFNULL(WR.WR_RETURN_AMT, 0), COUNT(*)), SUM(SUM(IFNULL(WS.WS_NET_PAID, 0)))]"",""groupKeys: [WS.WS_ITEM_SK]""],""parentOperators"":[6]},{""id"":8,""operation"":""InnerJoin"",""expressions"":[""joinKey: (WS.WS_ITEM_SK = WR.WR_ITEM_SK) AND (WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER)""],""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFNULL(WS.WS_QUANTITY, 0)), SUM(IFNULL(WS.WS_NET_PAID, 0)), COUNT(*)]"",""groupKeys: [WS.WS_ITEM_SK, WS.WS_ORDER_NUMBER]""],""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WS.WS_SOLD_DATE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 11)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""(WS.WS_NET_PROFIT > 1) AND (WS.WS_NET_PAID > 0) AND (WS.WS_QUANTITY > 0) AND (WS.WS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[10]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WS.WS_SOLD_DATE_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_ITEM_SK"",""WS_ORDER_NUMBER"",""WS_QUANTITY"",""WS_NET_PAID"",""WS_NET_PROFIT""],""alias"":""WS"",""partitionsAssigned"":27574,""partitionsTotal"":27579,""bytesAssigned"":460956759040,""parentOperators"":[14]},{""id"":16,""operation"":""Filter"",""expressions"":[""(WR.WR_RETURN_AMT > 10000) AND (WR.WR_ITEM_SK IS NOT NULL) AND (WR.WR_ORDER_NUMBER IS NOT NULL)""],""parentOperators"":[8]},{""id"":17,""operation"":""JoinFilter"",""expressions"":[""joinKey: (WS.WS_ITEM_SK = WR.WR_ITEM_SK) AND (WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER)""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_RETURNS""],""expressions"":[""WR_ITEM_SK"",""WR_ORDER_NUMBER"",""WR_RETURN_QUANTITY"",""WR_RETURN_AMT""],""alias"":""WR"",""partitionsAssigned"":2288,""partitionsTotal"":2289,""bytesAssigned"":39149204992,""parentOperators"":[17]},{""id"":19,""operation"":""Filter"",""expressions"":[""(RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(CR.CR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(CS.CS_QUANTITY, 0))))) ASC NULLS LAST) <= 10) OR (RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(CR.CR_RETURN_AMOUNT, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(CS.CS_NET_PAID, 0))))) ASC NULLS LAST) <= 10)""],""parentOperators"":[3]},{""id"":20,""operation"":""WindowFunction"",""expressions"":[""RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(CR.CR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(CS.CS_QUANTITY, 0))))) ASC NULLS LAST)"",""RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(CR.CR_RETURN_AMOUNT, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(CS.CS_NET_PAID, 0))))) ASC NULLS LAST)""],""parentOperators"":[19]},{""id"":21,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(IFNULL(CR.CR_RETURN_QUANTITY, 0), COUNT(*))), SUM(SUM(SUM(IFNULL(CS.CS_QUANTITY, 0)))), SUM(SUM_INTERNAL(IFNULL(CR.CR_RETURN_AMOUNT, 0), COUNT(*))), SUM(SUM(SUM(IFNULL(CS.CS_NET_PAID, 0))))]"",""groupKeys: [CS.CS_ITEM_SK]""],""parentOperators"":[20]},{""id"":22,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(IFNULL(CR.CR_RETURN_QUANTITY, 0), COUNT(*)), SUM(SUM(IFNULL(CS.CS_QUANTITY, 0))), SUM_INTERNAL(IFNULL(CR.CR_RETURN_AMOUNT, 0), COUNT(*)), SUM(SUM(IFNULL(CS.CS_NET_PAID, 0)))]"",""groupKeys: [CS.CS_ITEM_SK]""],""parentOperators"":[21]},{""id"":23,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CS.CS_ITEM_SK = CR.CR_ITEM_SK) AND (CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER)""],""parentOperators"":[22]},{""id"":24,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFNULL(CS.CS_QUANTITY, 0)), SUM(IFNULL(CS.CS_NET_PAID, 0)), COUNT(*)]"",""groupKeys: [CS.CS_ITEM_SK, CS.CS_ORDER_NUMBER]""],""parentOperators"":[23]},{""id"":25,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CS.CS_SOLD_DATE_SK)""],""parentOperators"":[24]},{""id"":26,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 11)""],""parentOperators"":[25]},{""id"":27,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[26]},{""id"":28,""operation"":""Filter"",""expressions"":[""(CS.CS_NET_PROFIT > 1) AND (CS.CS_NET_PAID > 0) AND (CS.CS_QUANTITY > 0) AND (CS.CS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[25]},{""id"":29,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CS.CS_SOLD_DATE_SK)""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_ITEM_SK"",""CS_ORDER_NUMBER"",""CS_QUANTITY"",""CS_NET_PAID"",""CS_NET_PROFIT""],""alias"":""CS"",""partitionsAssigned"":54721,""partitionsTotal"":54922,""bytesAssigned"":920184101376,""parentOperators"":[29]},{""id"":31,""operation"":""Filter"",""expressions"":[""(CR.CR_RETURN_AMOUNT > 10000) AND (CR.CR_ITEM_SK IS NOT NULL) AND (CR.CR_ORDER_NUMBER IS NOT NULL)""],""parentOperators"":[23]},{""id"":32,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CS.CS_ITEM_SK = CR.CR_ITEM_SK) AND (CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER)""],""parentOperators"":[31]},{""id"":33,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_RETURNS""],""expressions"":[""CR_ITEM_SK"",""CR_ORDER_NUMBER"",""CR_RETURN_QUANTITY"",""CR_RETURN_AMOUNT""],""alias"":""CR"",""partitionsAssigned"":4759,""partitionsTotal"":4759,""bytesAssigned"":82532796416,""parentOperators"":[32]},{""id"":34,""operation"":""Filter"",""expressions"":[""(RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(SR.SR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(STS.SS_QUANTITY, 0))))) ASC NULLS LAST) <= 10) OR (RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(SR.SR_RETURN_AMT, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(STS.SS_NET_PAID, 0))))) ASC NULLS LAST) <= 10)""],""parentOperators"":[3]},{""id"":35,""operation"":""WindowFunction"",""expressions"":[""RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(SR.SR_RETURN_QUANTITY, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(STS.SS_QUANTITY, 0))))) ASC NULLS LAST)"",""RANK() OVER (ORDER BY (SUM(SUM_INTERNAL(IFNULL(SR.SR_RETURN_AMT, 0), COUNT(*)))) / (SUM(SUM(SUM(IFNULL(STS.SS_NET_PAID, 0))))) ASC NULLS LAST)""],""parentOperators"":[34]},{""id"":36,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(IFNULL(SR.SR_RETURN_QUANTITY, 0), COUNT(*))), SUM(SUM(SUM(IFNULL(STS.SS_QUANTITY, 0)))), SUM(SUM_INTERNAL(IFNULL(SR.SR_RETURN_AMT, 0), COUNT(*))), SUM(SUM(SUM(IFNULL(STS.SS_NET_PAID, 0))))]"",""groupKeys: [STS.SS_ITEM_SK]""],""parentOperators"":[35]},{""id"":37,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(IFNULL(SR.SR_RETURN_QUANTITY, 0), COUNT(*)), SUM(SUM(IFNULL(STS.SS_QUANTITY, 0))), SUM_INTERNAL(IFNULL(SR.SR_RETURN_AMT, 0), COUNT(*)), SUM(SUM(IFNULL(STS.SS_NET_PAID, 0)))]"",""groupKeys: [STS.SS_ITEM_SK]""],""parentOperators"":[36]},{""id"":38,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STS.SS_ITEM_SK = SR.SR_ITEM_SK) AND (STS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER)""],""parentOperators"":[37]},{""id"":39,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFNULL(STS.SS_QUANTITY, 0)), SUM(IFNULL(STS.SS_NET_PAID, 0)), COUNT(*)]"",""groupKeys: [STS.SS_ITEM_SK, STS.SS_TICKET_NUMBER]""],""parentOperators"":[38]},{""id"":40,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STS.SS_SOLD_DATE_SK)""],""parentOperators"":[39]},{""id"":41,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 1999) AND (DATE_DIM.D_MOY = 11)""],""parentOperators"":[40]},{""id"":42,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[41]},{""id"":43,""operation"":""Filter"",""expressions"":[""(STS.SS_NET_PROFIT > 1) AND (STS.SS_NET_PAID > 0) AND (STS.SS_QUANTITY > 0) AND (STS.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[40]},{""id"":44,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STS.SS_SOLD_DATE_SK)""],""parentOperators"":[43]},{""id"":45,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_TICKET_NUMBER"",""SS_QUANTITY"",""SS_NET_PAID"",""SS_NET_PROFIT""],""alias"":""STS"",""partitionsAssigned"":70412,""partitionsTotal"":72718,""bytesAssigned"":1212628258304,""parentOperators"":[44]},{""id"":46,""operation"":""Filter"",""expressions"":[""(SR.SR_RETURN_AMT > 10000) AND (SR.SR_ITEM_SK IS NOT NULL) AND (SR.SR_TICKET_NUMBER IS NOT NULL)""],""parentOperators"":[38]},{""id"":47,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STS.SS_ITEM_SK = SR.SR_ITEM_SK) AND (STS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER)""],""parentOperators"":[46]},{""id"":48,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_ITEM_SK"",""SR_TICKET_NUMBER"",""SR_RETURN_QUANTITY"",""SR_RETURN_AMT""],""alias"":""SR"",""partitionsAssigned"":7069,""partitionsTotal"":7070,""bytesAssigned"":124763385856,""parentOperators"":[47]}]]}",01b2e7fb-0002-2ebc-0051-ba87000236e6,"explain using json select /* { ""query"":""query49"",""streamId"":0,""querySequence"":48 } */  channel, item, return_ratio, return_rank, currency_rank from
 (select
 'web' as channel
 ,web.item
 ,web.return_ratio
 ,web.return_rank
 ,web.currency_rank
 from (
 	select
 	 item
 	,return_ratio
 	,currency_ratio
 	,rank() over (order by return_ratio) as return_rank
 	,rank() over (order by currency_ratio) as currency_rank
 	from
 	(	select ws.ws_item_sk as item
 		,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/
 		cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio
 		,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/
 		cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio
 		from
 		 web_sales ws left outer join web_returns wr
 			on (ws.ws_order_number = wr.wr_order_number and
 			ws.ws_item_sk = wr.wr_item_sk)
                 ,date_dim
 		where
 			wr.wr_return_amt > 10000
 			and ws.ws_net_profit > 1
                         and ws.ws_net_paid > 0
                         and ws.ws_quantity > 0
                         and ws_sold_date_sk = d_date_sk
                         and d_year = 1999
                         and d_moy = 11
 		group by ws.ws_item_sk
 	) in_web
 ) web
 where
 (
 web.return_rank <= 10
 or
 web.currency_rank <= 10
 )
 union
 select
 'catalog' as channel
 ,catalog.item
 ,catalog.return_ratio
 ,catalog.return_rank
 ,catalog.currency_rank
 from (
 	select
 	 item
 	,return_ratio
 	,currency_ratio
 	,rank() over (order by return_ratio) as return_rank
 	,rank() over (order by currency_ratio) as currency_rank
 	from
 	(	select
 		cs.cs_item_sk as item
 		,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/
 		cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio
 		,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/
 		cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio
 		from
 		catalog_sales cs left outer join catalog_returns cr
 			on (cs.cs_order_number = cr.cr_order_number and
 			cs.cs_item_sk = cr.cr_item_sk)
                ,date_dim
 		where
 			cr.cr_return_amount > 10000
 			and cs.cs_net_profit > 1
                         and cs.cs_net_paid > 0
                         and cs.cs_quantity > 0
                         and cs_sold_date_sk = d_date_sk
                         and d_year = 1999
                         and d_moy = 11
                 group by cs.cs_item_sk
 	) in_cat
 ) catalog
 where
 (
 catalog.return_rank <= 10
 or
 catalog.currency_rank <=10
 )
 union
 select
 'store' as channel
 ,store.item
 ,store.return_ratio
 ,store.return_rank
 ,store.currency_rank
 from (
 	select
 	 item
 	,return_ratio
 	,currency_ratio
 	,rank() over (order by return_ratio) as return_rank
 	,rank() over (order by currency_ratio) as currency_rank
 	from
 	(	select sts.ss_item_sk as item
 		,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio
 		,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio
 		from
 		store_sales sts left outer join store_returns sr
 			on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)
                ,date_dim
 		where
 			sr.sr_return_amt > 10000
 			and sts.ss_net_profit > 1
                         and sts.ss_net_paid > 0
                         and sts.ss_quantity > 0
                         and ss_sold_date_sk = d_date_sk
                         and d_year = 1999
                         and d_moy = 11
 		group by sts.ss_item_sk
 	) in_store
 ) store
 where  (
 store.return_rank <= 10
 or
 store.currency_rank <= 10
 )
 )
 order by 1,4,5,2
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:57.46-07:00,2024-03-10T18:31:58.605-07:00,1145,0,0,1143,2,0,0,0,0,,,0,,,0,0.000175000,0,8.9.2,0,0,0,0,0,FALSE,e13e16c9426364299a89a1bc3c5eee89,2,e93493cdd190640b3fb8a873bdad7a76,1
"{""GlobalStats"":{""partitionsTotal"":134716,""partitionsAssigned"":134354,""bytesAssigned"":2294155961344},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""ITEM.I_ITEM_DESC"",""STORE.S_STATE"",""COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)))"",""SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*))))"",""SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_QUANTITY))), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_QUANTITY))), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * ((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)))) - 1), 0))))"",""(SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_QUANTITY))), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_QUANTITY))), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)))) * ((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)))) - 1), 0))))) / (TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTIT..."",""COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))"",""SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*))))"",""SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM((STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_RETURNS.SR_RETURN_QUANTITY))), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM((STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_RETURNS.SR_RETURN_QUANTITY))), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * ((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) - 1), 0))))"",""(SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM((STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_RETURNS.SR_RETURN_QUANTITY))), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM((STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_RETURNS.SR_RETURN_QUANTITY))), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) * ((COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)))) - 1), 0))))) / (TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(SUM(SUM_INT..."",""COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))"",""SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*))))"",""SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM_INTERNAL((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_QUANTITY), COUNT(*)), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM_INTERNAL((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_QUANTITY), COUNT(*)), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * ((COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) - 1), 0))))"",""(SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM_INTERNAL((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_QUANTITY), COUNT(*)), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))))) < 0, 0, ((COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM_INTERNAL((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_QUANTITY), COUNT(*)), COUNT(*))))) - ((SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * (SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))))), NULLIF((COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) * ((COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)))) - 1), 0))))) ...""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [ITEM.I_ITEM_ID ASC NULLS LAST, ITEM.I_ITEM_DESC ASC NULLS LAST, STORE.S_STATE ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_QUANTITY))), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM((STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_RETURNS.SR_RETURN_QUANTITY))), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*))), SUM(SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*))), SUM(SUM_INTERNAL(SUM_INTERNAL((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_QUANTITY), COUNT(*)), COUNT(*)))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, STORE.S_STATE]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_QUANTITY)), COUNT(*)), SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_QUANTITY)), COUNT(*)), SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_QUANTITY))), COUNT(*)), COUNT_INTERNAL(COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)), SUM_INTERNAL(SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)), SUM_INTERNAL(SUM(SUM((STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_RETURNS.SR_RETURN_QUANTITY))), COUNT(*)), COUNT_INTERNAL(COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)), SUM_INTERNAL(SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), COUNT(*)), SUM_INTERNAL(SUM_INTERNAL((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_QUANTITY), COUNT(*)), COUNT(*))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, STORE.S_STATE]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D3.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [D3.D_DATE_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""Filter"",""expressions"":[""D3.D_QUARTER_NAME IN '2002Q1' IN '2002Q2' IN '2002Q3'""],""parentOperators"":[5]},{""id"":7,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_QUARTER_NAME""],""alias"":""D3"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[6]},{""id"":8,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(COUNT(STORE_SALES.SS_QUANTITY)), SUM(SUM(STORE_SALES.SS_QUANTITY)), SUM(SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_QUANTITY))), COUNT(COUNT(STORE_RETURNS.SR_RETURN_QUANTITY)), SUM(SUM(STORE_RETURNS.SR_RETURN_QUANTITY)), SUM(SUM((STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_RETURNS.SR_RETURN_QUANTITY))), COUNT_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), SUM_INTERNAL(CATALOG_SALES.CS_QUANTITY, COUNT(*)), SUM_INTERNAL((CATALOG_SALES.CS_QUANTITY) * (CATALOG_SALES.CS_QUANTITY), COUNT(*))]"",""groupKeys: [STORE.S_STATE, ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, CATALOG_SALES.CS_SOLD_DATE_SK]""],""parentOperators"":[4]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_RETURNS.SR_CUSTOMER_SK = CATALOG_SALES.CS_BILL_CUSTOMER_SK) AND (STORE_RETURNS.SR_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(STORE_SALES.SS_QUANTITY), SUM(STORE_SALES.SS_QUANTITY), SUM((STORE_SALES.SS_QUANTITY) * (STORE_SALES.SS_QUANTITY)), COUNT(STORE_RETURNS.SR_RETURN_QUANTITY), SUM(STORE_RETURNS.SR_RETURN_QUANTITY), SUM((STORE_RETURNS.SR_RETURN_QUANTITY) * (STORE_RETURNS.SR_RETURN_QUANTITY)), COUNT(*)]"",""groupKeys: [STORE.S_STATE, ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, STORE_RETURNS.SR_ITEM_SK, STORE_RETURNS.SR_CUSTOMER_SK]""],""parentOperators"":[9]},{""id"":11,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[11]},{""id"":13,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[11]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID"",""I_ITEM_DESC""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[13]},{""id"":15,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D2.D_DATE_SK = STORE_RETURNS.SR_RETURNED_DATE_SK)""],""parentOperators"":[13]},{""id"":16,""operation"":""Filter"",""expressions"":[""D2.D_QUARTER_NAME IN '2002Q1' IN '2002Q2' IN '2002Q3'""],""parentOperators"":[15]},{""id"":17,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_QUARTER_NAME""],""alias"":""D2"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[16]},{""id"":18,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE_SALES.SS_CUSTOMER_SK = STORE_RETURNS.SR_CUSTOMER_SK) AND (STORE_SALES.SS_ITEM_SK = STORE_RETURNS.SR_ITEM_SK) AND (STORE_SALES.SS_TICKET_NUMBER = STORE_RETURNS.SR_TICKET_NUMBER)""],""parentOperators"":[15]},{""id"":19,""operation"":""InnerJoin"",""expressions"":[""joinKey: (D1.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[18]},{""id"":20,""operation"":""Filter"",""expressions"":[""D1.D_QUARTER_NAME = '2002Q1'""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_QUARTER_NAME""],""alias"":""D1"",""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[20]},{""id"":22,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[19]},{""id"":23,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[22]},{""id"":24,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_CUSTOMER_SK"",""SS_STORE_SK"",""SS_TICKET_NUMBER"",""SS_QUANTITY""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[23]},{""id"":25,""operation"":""Filter"",""expressions"":[""(STORE_RETURNS.SR_CUSTOMER_SK IS NOT NULL) AND (STORE_RETURNS.SR_RETURNED_DATE_SK IS NOT NULL)""],""parentOperators"":[18]},{""id"":26,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[25]},{""id"":27,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS""],""expressions"":[""SR_RETURNED_DATE_SK"",""SR_ITEM_SK"",""SR_CUSTOMER_SK"",""SR_TICKET_NUMBER"",""SR_RETURN_QUANTITY""],""partitionsAssigned"":6909,""partitionsTotal"":7070,""bytesAssigned"":122017405952,""parentOperators"":[26]},{""id"":28,""operation"":""Filter"",""expressions"":[""(CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL) AND (CATALOG_SALES.CS_BILL_CUSTOMER_SK IS NOT NULL)""],""parentOperators"":[9]},{""id"":29,""operation"":""JoinFilter"",""expressions"":[""joinKey: (D3.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[28]},{""id"":30,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_BILL_CUSTOMER_SK"",""CS_ITEM_SK"",""CS_QUANTITY""],""partitionsAssigned"":54721,""partitionsTotal"":54922,""bytesAssigned"":920184101376,""parentOperators"":[29]}]]}",01b2e7fb-0002-300b-0051-ba870002c092,"explain using json select /* { ""query"":""query17"",""streamId"":0,""querySequence"":41 } */  i_item_id
       ,i_item_desc
       ,s_state
       ,count(ss_quantity) as store_sales_quantitycount
       ,avg(ss_quantity) as store_sales_quantityave
       ,stddev_samp(ss_quantity) as store_sales_quantitystdev
       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov
       ,count(sr_return_quantity) as store_returns_quantitycount
       ,avg(sr_return_quantity) as store_returns_quantityave
       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev
       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov
       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave
       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev
       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov
 from store_sales
     ,store_returns
     ,catalog_sales
     ,date_dim d1
     ,date_dim d2
     ,date_dim d3
     ,store
     ,item
 where d1.d_quarter_name = '2002Q1'
   and d1.d_date_sk = ss_sold_date_sk
   and i_item_sk = ss_item_sk
   and s_store_sk = ss_store_sk
   and ss_customer_sk = sr_customer_sk
   and ss_item_sk = sr_item_sk
   and ss_ticket_number = sr_ticket_number
   and sr_returned_date_sk = d2.d_date_sk
   and d2.d_quarter_name in ('2002Q1','2002Q2','2002Q3')
   and sr_customer_sk = cs_bill_customer_sk
   and sr_item_sk = cs_item_sk
   and cs_sold_date_sk = d3.d_date_sk
   and d3.d_quarter_name in ('2002Q1','2002Q2','2002Q3')
 group by i_item_id
         ,i_item_desc
         ,s_state
 order by i_item_id
         ,i_item_desc
         ,s_state
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:50.452-07:00,2024-03-10T18:31:51.45-07:00,998,0,0,996,2,0,0,0,0,,,0,,,0,0.000152000,0,8.9.2,0,0,0,0,0,FALSE,586febafc8e95c3f621cd4767b0a3c83,2,3f10fe66d89570fbac1808d8af449683,1
"{""GlobalStats"":{""partitionsTotal"":72722,""partitionsAssigned"":72722,""bytesAssigned"":1251950176768},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_CATEGORY"",""ITEM.I_CLASS"",""ITEM.I_BRAND"",""ITEM.I_PRODUCT_NAME"",""DATE_DIM.D_YEAR"",""DATE_DIM.D_QOY"",""DATE_DIM.D_MOY"",""STORE.S_STORE_ID"",""SUM(SUM(SUM_INTERNAL(SUM(IFNULL((STORE_SALES.SS_SALES_PRICE) * (STORE_SALES.SS_QUANTITY), 0)), COUNT(*))))"",""RANK() OVER (PARTITION BY ITEM.I_CATEGORY ORDER BY SUM(SUM(SUM_INTERNAL(SUM(IFNULL((STORE_SALES.SS_SALES_PRICE) * (STORE_SALES.SS_QUANTITY), 0)), COUNT(*)))) DESC NULLS FIRST)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [DW2.I_CATEGORY ASC NULLS LAST, DW2.I_CLASS ASC NULLS LAST, DW2.I_BRAND ASC NULLS LAST, DW2.I_PRODUCT_NAME ASC NULLS LAST, DW2.D_YEAR ASC NULLS LAST, DW2.D_QOY ASC NULLS LAST, DW2.D_MOY ASC NULLS LAST, DW2.S_STORE_ID ASC NULLS LAST, DW2.SUMSALES ASC NULLS LAST, DW2.RK ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Filter"",""expressions"":[""RANK() OVER (PARTITION BY ITEM.I_CATEGORY ORDER BY SUM(SUM(SUM_INTERNAL(SUM(IFNULL((STORE_SALES.SS_SALES_PRICE) * (STORE_SALES.SS_QUANTITY), 0)), COUNT(*)))) DESC NULLS FIRST) <= 100""],""parentOperators"":[1]},{""id"":3,""operation"":""WindowFunction"",""expressions"":[""RANK() OVER (PARTITION BY ITEM.I_CATEGORY ORDER BY SUM(SUM(SUM_INTERNAL(SUM(IFNULL((STORE_SALES.SS_SALES_PRICE) * (STORE_SALES.SS_QUANTITY), 0)), COUNT(*)))) DESC NULLS FIRST)""],""parentOperators"":[2]},{""id"":4,""operation"":""GroupingSets"",""expressions"":[""SUM(IFNULL((STORE_SALES.SS_SALES_PRICE) * (STORE_SALES.SS_QUANTITY), 0))""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM(SUM_INTERNAL(SUM(IFNULL((STORE_SALES.SS_SALES_PRICE) * (STORE_SALES.SS_QUANTITY), 0)), COUNT(*))))]"",""groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_BRAND, ITEM.I_PRODUCT_NAME, DATE_DIM.D_YEAR, DATE_DIM.D_QOY, DATE_DIM.D_MOY, STORE.S_STORE_ID]""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(IFNULL((STORE_SALES.SS_SALES_PRICE) * (STORE_SALES.SS_QUANTITY), 0)), COUNT(*)))]"",""groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_BRAND, ITEM.I_PRODUCT_NAME, DATE_DIM.D_YEAR, DATE_DIM.D_QOY, DATE_DIM.D_MOY, STORE.S_STORE_ID]""],""parentOperators"":[5]},{""id"":7,""operation"":""InnerJoin"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE""],""expressions"":[""S_STORE_SK"",""S_STORE_ID""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":135680,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(IFNULL((STORE_SALES.SS_SALES_PRICE) * (STORE_SALES.SS_QUANTITY), 0)), COUNT(*))]"",""groupKeys: [ITEM.I_BRAND, ITEM.I_CLASS, ITEM.I_CATEGORY, ITEM.I_PRODUCT_NAME, DATE_DIM.D_YEAR, DATE_DIM.D_MOY, DATE_DIM.D_QOY, STORE_SALES.SS_STORE_SK]""],""parentOperators"":[7]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_BRAND, ITEM.I_CLASS, ITEM.I_CATEGORY, ITEM.I_PRODUCT_NAME]""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_BRAND"",""I_CLASS"",""I_CATEGORY"",""I_PRODUCT_NAME""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[11]},{""id"":13,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(IFNULL((STORE_SALES.SS_SALES_PRICE) * (STORE_SALES.SS_QUANTITY), 0))]"",""groupKeys: [DATE_DIM.D_YEAR, DATE_DIM.D_MOY, DATE_DIM.D_QOY, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[10]},{""id"":14,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_MONTH_SEQ >= 1183) AND (DATE_DIM.D_MONTH_SEQ <= 1194)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_MONTH_SEQ"",""D_YEAR"",""D_MOY"",""D_QOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[14]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_STORE_SK"",""SS_QUANTITY"",""SS_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[18]}]]}",01b2e7fb-0002-2fe3-0051-ba870002e042,"explain using json select /* { ""query"":""query67"",""streamId"":0,""querySequence"":35 } */  *
from (select i_category
            ,i_class
            ,i_brand
            ,i_product_name
            ,d_year
            ,d_qoy
            ,d_moy
            ,s_store_id
            ,sumsales
            ,rank() over (partition by i_category order by sumsales desc) rk
      from (select i_category
                  ,i_class
                  ,i_brand
                  ,i_product_name
                  ,d_year
                  ,d_qoy
                  ,d_moy
                  ,s_store_id
                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales
            from store_sales
                ,date_dim
                ,store
                ,item
       where  ss_sold_date_sk=d_date_sk
          and ss_item_sk=i_item_sk
          and ss_store_sk = s_store_sk
          and d_month_seq between 1183 and 1183+11
       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2
where rk <= 100
order by i_category
        ,i_class
        ,i_brand
        ,i_product_name
        ,d_year
        ,d_qoy
        ,d_moy
        ,s_store_id
        ,sumsales
        ,rk
limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:44.744-07:00,2024-03-10T18:31:45.015-07:00,271,0,0,270,1,0,0,0,0,,,0,,,0,0.000041000,0,8.9.2,0,0,0,0,0,FALSE,5c90d8ccb7bab556f9b5fa8aa78ca31f,2,59f893a33ca9310c86e4612ca9fd3ff4,1
"{""GlobalStats"":{""partitionsTotal"":72721,""partitionsAssigned"":72721,""bytesAssigned"":1251950041088},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""ITEM.I_ITEM_DESC"",""ITEM.I_CATEGORY"",""ITEM.I_CLASS"",""ITEM.I_CURRENT_PRICE"",""SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(*)))"",""((SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(*)))) * 100) / (SUM(SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS))""]},{""id"":1,""operation"":""Sort"",""expressions"":[""ITEM.I_CATEGORY ASC NULLS LAST"",""ITEM.I_CLASS ASC NULLS LAST"",""ITEM.I_ITEM_ID ASC NULLS LAST"",""ITEM.I_ITEM_DESC ASC NULLS LAST"",""((SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(*)))) * 100) / (SUM(SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS)) ASC NULLS LAST""],""parentOperators"":[0]},{""id"":2,""operation"":""WindowFunction"",""expressions"":[""SUM(SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS)"",""SUM(SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(*)))) OVER (PARTITION BY ITEM.I_CLASS)""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(SUM_INTERNAL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(*)))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[2]},{""id"":4,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM_INTERNAL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), COUNT(*))]"",""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CATEGORY, ITEM.I_CLASS, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[3]},{""id"":5,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[4]},{""id"":6,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CURRENT_PRICE, ITEM.I_CLASS, ITEM.I_CATEGORY]""],""parentOperators"":[5]},{""id"":7,""operation"":""Filter"",""expressions"":[""ITEM.I_CATEGORY IN 'Jewelry' IN 'Music' IN 'Children'""],""parentOperators"":[6]},{""id"":8,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID"",""I_ITEM_DESC"",""I_CURRENT_PRICE"",""I_CLASS"",""I_CATEGORY""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[7]},{""id"":9,""operation"":""Aggregate"",""expressions"":[""aggExprs: [SUM(STORE_SALES.SS_EXT_SALES_PRICE)]"",""groupKeys: [STORE_SALES.SS_ITEM_SK]""],""parentOperators"":[5]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[9]},{""id"":11,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2002-01-12') AND (DATE_DIM.D_DATE <= '2002-02-11')""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[11]},{""id"":13,""operation"":""Filter"",""expressions"":[""STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[10]},{""id"":14,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)""],""parentOperators"":[13]},{""id"":15,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_ITEM_SK"",""SS_EXT_SALES_PRICE""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[14]}]]}",01b2e7fb-0002-2d15-0051-ba87000196e2,"explain using json select /* { ""query"":""query98"",""streamId"":0,""querySequence"":32 } */ i_item_id
      ,i_item_desc
      ,i_category
      ,i_class
      ,i_current_price
      ,sum(ss_ext_sales_price) as itemrevenue
      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over
          (partition by i_class) as revenueratio
from
	store_sales
    	,item
    	,date_dim
where
	ss_item_sk = i_item_sk
  	and i_category in ('Jewelry', 'Music', 'Children')
  	and ss_sold_date_sk = d_date_sk
	and d_date between cast('2002-01-12' as date)
				and (cast('2002-01-12' as date) + interval '30 days')
group by
	i_item_id
        ,i_item_desc
        ,i_category
        ,i_class
        ,i_current_price
order by
	i_category
        ,i_class
        ,i_item_id
        ,i_item_desc
        ,revenueratio;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:41.285-07:00,2024-03-10T18:31:41.6-07:00,315,0,0,314,1,0,0,0,0,,,0,,,0,0.000048000,0,8.9.2,0,0,0,0,0,FALSE,14bbce98cdd4ac1ea0c8887f7bdd33e3,2,14bbce98cdd4ac1ea0c8887f7bdd33e3,1
"{""GlobalStats"":{""partitionsTotal"":55204,""partitionsAssigned"":55204,""bytesAssigned"":927302172672},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""ITEM.I_ITEM_ID"",""ITEM.I_ITEM_DESC"",""ITEM.I_CURRENT_PRICE""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [ITEM.I_ITEM_ID ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[2]},{""id"":4,""operation"":""SemiJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""groupKeys: [ITEM.I_ITEM_SK, ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, ITEM.I_CURRENT_PRICE]""],""parentOperators"":[4]},{""id"":6,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = INVENTORY.INV_DATE_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[6]},{""id"":8,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_DATE >= '2000-06-09') AND (DATE_DIM.D_DATE <= '2000-08-08')""],""parentOperators"":[7]},{""id"":9,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_DATE""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[8]},{""id"":10,""operation"":""InnerJoin"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = INVENTORY.INV_ITEM_SK)""],""parentOperators"":[6]},{""id"":11,""operation"":""Filter"",""expressions"":[""(ITEM.I_CURRENT_PRICE >= 43) AND (ITEM.I_CURRENT_PRICE <= 73) AND (ITEM.I_MANUFACT_ID IN 916 IN 867 IN 787 IN 747)""],""parentOperators"":[10]},{""id"":12,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM""],""expressions"":[""I_ITEM_SK"",""I_ITEM_ID"",""I_ITEM_DESC"",""I_CURRENT_PRICE"",""I_MANUFACT_ID""],""partitionsAssigned"":2,""partitionsTotal"":2,""bytesAssigned"":23811584,""parentOperators"":[11]},{""id"":14,""operation"":""Filter"",""expressions"":[""(INVENTORY.INV_QUANTITY_ON_HAND >= 100) AND (INVENTORY.INV_QUANTITY_ON_HAND <= 500)""],""parentOperators"":[13]},{""id"":15,""operation"":""JoinFilter"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = INVENTORY.INV_DATE_SK)""],""parentOperators"":[14]},{""id"":16,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.INVENTORY""],""expressions"":[""INV_DATE_SK"",""INV_ITEM_SK"",""INV_QUANTITY_ON_HAND""],""partitionsAssigned"":279,""partitionsTotal"":279,""bytesAssigned"":3658746880,""parentOperators"":[15]},{""id"":18,""operation"":""JoinFilter"",""expressions"":[""joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)""],""parentOperators"":[17]},{""id"":19,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_ITEM_SK""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[18]}]]}",01b2e7fb-0002-2ff0-0051-ba870003003a,"explain using json select /* { ""query"":""query37"",""streamId"":0,""querySequence"":31 } */  i_item_id
       ,i_item_desc
       ,i_current_price
 from item, inventory, date_dim, catalog_sales
 where i_current_price between 43 and 43 + 30
 and inv_item_sk = i_item_sk
 and d_date_sk=inv_date_sk
 and d_date between cast('2000-06-09' as date) and (cast('2000-06-09' as date) + interval '60 days')
 and i_manufact_id in (916,867,787,747)
 and inv_quantity_on_hand between 100 and 500
 and cs_item_sk = i_item_sk
 group by i_item_id,i_item_desc,i_current_price
 order by i_item_id
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:40.425-07:00,2024-03-10T18:31:40.896-07:00,471,0,0,469,2,0,0,0,0,,,0,,,0,0.000072000,0,8.9.2,0,0,0,0,0,FALSE,b60c9a4416febcaa468dea7d3aa1e9c4,2,b60c9a4416febcaa468dea7d3aa1e9c4,1
"{""GlobalStats"":{""partitionsTotal"":155740,""partitionsAssigned"":155740,""bytesAssigned"":2639701907968},""Operations"":[[{""id"":0,""operation"":""Result"",""expressions"":[""CUSTOMER_DEMOGRAPHICS.CD_GENDER"",""CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS"",""CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS"",""COUNT(*)"",""CUSTOMER_DEMOGRAPHICS.CD_PURCHASE_ESTIMATE"",""COUNT(*)"",""CUSTOMER_DEMOGRAPHICS.CD_CREDIT_RATING"",""COUNT(*)""]},{""id"":1,""operation"":""SortWithLimit"",""expressions"":[""sortKey: [CUSTOMER_DEMOGRAPHICS.CD_GENDER ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_PURCHASE_ESTIMATE ASC NULLS LAST, CUSTOMER_DEMOGRAPHICS.CD_CREDIT_RATING ASC NULLS LAST]"",""rowCount: 100""],""parentOperators"":[0]},{""id"":2,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER_DEMOGRAPHICS.CD_GENDER, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS, CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS, CUSTOMER_DEMOGRAPHICS.CD_PURCHASE_ESTIMATE, CUSTOMER_DEMOGRAPHICS.CD_CREDIT_RATING]""],""parentOperators"":[1]},{""id"":3,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [CUSTOMER_DEMOGRAPHICS.CD_GENDER, CUSTOMER_DEMOGRAPHICS.CD_MARITAL_STATUS, CUSTOMER_DEMOGRAPHICS.CD_EDUCATION_STATUS, CUSTOMER_DEMOGRAPHICS.CD_PURCHASE_ESTIMATE, CUSTOMER_DEMOGRAPHICS.CD_CREDIT_RATING]""],""parentOperators"":[2]},{""id"":4,""operation"":""InnerJoin"",""expressions"":[""joinKey: (C.C_CURRENT_CDEMO_SK = CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK)""],""parentOperators"":[3]},{""id"":5,""operation"":""Aggregate"",""expressions"":[""aggExprs: [COUNT(*)]"",""groupKeys: [C.C_CURRENT_CDEMO_SK]""],""parentOperators"":[4]},{""id"":6,""operation"":""SemiJoin"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[5]},{""id"":7,""operation"":""AntiJoin"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = CATALOG_SALES.CS_SHIP_CUSTOMER_SK)""],""parentOperators"":[6]},{""id"":8,""operation"":""AntiJoin"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[7]},{""id"":9,""operation"":""InnerJoin"",""expressions"":[""joinKey: (CA.CA_ADDRESS_SK = C.C_CURRENT_ADDR_SK)""],""parentOperators"":[8]},{""id"":10,""operation"":""Filter"",""expressions"":[""CA.CA_STATE IN 'WI' IN 'WA' IN 'OK'""],""parentOperators"":[9]},{""id"":11,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS""],""expressions"":[""CA_ADDRESS_SK"",""CA_STATE""],""alias"":""CA"",""partitionsAssigned"":256,""partitionsTotal"":256,""bytesAssigned"":776454656,""parentOperators"":[10]},{""id"":12,""operation"":""Filter"",""expressions"":[""C.C_CURRENT_CDEMO_SK IS NOT NULL""],""parentOperators"":[9]},{""id"":13,""operation"":""JoinFilter"",""expressions"":[""joinKey: (CA.CA_ADDRESS_SK = C.C_CURRENT_ADDR_SK)""],""parentOperators"":[12]},{""id"":14,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER""],""expressions"":[""C_CUSTOMER_SK"",""C_CURRENT_CDEMO_SK"",""C_CURRENT_ADDR_SK""],""alias"":""C"",""partitionsAssigned"":261,""partitionsTotal"":261,""bytesAssigned"":2328538624,""parentOperators"":[13]},{""id"":15,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)""],""parentOperators"":[8]},{""id"":16,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[15]},{""id"":17,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2001) AND (DATE_DIM.D_MOY >= 2) AND (DATE_DIM.D_MOY <= 4)""],""parentOperators"":[16]},{""id"":18,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[17]},{""id"":19,""operation"":""Filter"",""expressions"":[""WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[15]},{""id"":20,""operation"":""JoinFilter"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = WEB_SALES.WS_BILL_CUSTOMER_SK)""],""parentOperators"":[19]},{""id"":21,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES""],""expressions"":[""WS_SOLD_DATE_SK"",""WS_BILL_CUSTOMER_SK""],""partitionsAssigned"":27579,""partitionsTotal"":27579,""bytesAssigned"":461041485824,""parentOperators"":[20]},{""id"":22,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)""],""parentOperators"":[7]},{""id"":23,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[22]},{""id"":24,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2001) AND (DATE_DIM.D_MOY >= 2) AND (DATE_DIM.D_MOY <= 4)""],""parentOperators"":[23]},{""id"":25,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[24]},{""id"":26,""operation"":""Filter"",""expressions"":[""CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL""],""parentOperators"":[22]},{""id"":27,""operation"":""JoinFilter"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = CATALOG_SALES.CS_SHIP_CUSTOMER_SK)""],""parentOperators"":[26]},{""id"":28,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES""],""expressions"":[""CS_SOLD_DATE_SK"",""CS_SHIP_CUSTOMER_SK""],""partitionsAssigned"":54922,""partitionsTotal"":54922,""bytesAssigned"":923617475584,""parentOperators"":[27]},{""id"":29,""operation"":""SemiJoin"",""expressions"":[""joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)""],""parentOperators"":[6]},{""id"":30,""operation"":""Aggregate"",""expressions"":[""groupKeys: [DATE_DIM.D_DATE_SK]""],""parentOperators"":[29]},{""id"":31,""operation"":""Filter"",""expressions"":[""(DATE_DIM.D_YEAR = 2001) AND (DATE_DIM.D_MOY >= 2) AND (DATE_DIM.D_MOY <= 4)""],""parentOperators"":[30]},{""id"":32,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM""],""expressions"":[""D_DATE_SK"",""D_YEAR"",""D_MOY""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":2138624,""parentOperators"":[31]},{""id"":33,""operation"":""Filter"",""expressions"":[""(STORE_SALES.SS_CUSTOMER_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)""],""parentOperators"":[29]},{""id"":34,""operation"":""JoinFilter"",""expressions"":[""joinKey: (C.C_CUSTOMER_SK = STORE_SALES.SS_CUSTOMER_SK)""],""parentOperators"":[33]},{""id"":35,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES""],""expressions"":[""SS_SOLD_DATE_SK"",""SS_CUSTOMER_SK""],""partitionsAssigned"":72718,""partitionsTotal"":72718,""bytesAssigned"":1251924090880,""parentOperators"":[34]},{""id"":36,""operation"":""JoinFilter"",""expressions"":[""joinKey: (C.C_CURRENT_CDEMO_SK = CUSTOMER_DEMOGRAPHICS.CD_DEMO_SK)""],""parentOperators"":[4]},{""id"":37,""operation"":""TableScan"",""objects"":[""SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS""],""expressions"":[""CD_DEMO_SK"",""CD_GENDER"",""CD_MARITAL_STATUS"",""CD_EDUCATION_STATUS"",""CD_PURCHASE_ESTIMATE"",""CD_CREDIT_RATING""],""partitionsAssigned"":1,""partitionsTotal"":1,""bytesAssigned"":7446528,""parentOperators"":[36]}]]}",01b2e7fb-0002-3000-0051-ba870002f02a,"explain using json select /* { ""query"":""query69"",""streamId"":0,""querySequence"":28 } */
  cd_gender,
  cd_marital_status,
  cd_education_status,
  count(*) cnt1,
  cd_purchase_estimate,
  count(*) cnt2,
  cd_credit_rating,
  count(*) cnt3
 from
  customer c,customer_address ca,customer_demographics
 where
  c.c_current_addr_sk = ca.ca_address_sk and
  ca_state in ('WI','WA','OK') and
  cd_demo_sk = c.c_current_cdemo_sk and
  exists (select *
          from store_sales,date_dim
          where c.c_customer_sk = ss_customer_sk and
                ss_sold_date_sk = d_date_sk and
                d_year = 2001 and
                d_moy between 2 and 2+2) and
   (not exists (select *
            from web_sales,date_dim
            where c.c_customer_sk = ws_bill_customer_sk and
                  ws_sold_date_sk = d_date_sk and
                  d_year = 2001 and
                  d_moy between 2 and 2+2) and
    not exists (select *
            from catalog_sales,date_dim
            where c.c_customer_sk = cs_ship_customer_sk and
                  cs_sold_date_sk = d_date_sk and
                  d_year = 2001 and
                  d_moy between 2 and 2+2))
 group by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating
 order by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating
 limit 100;",SNOWFLAKE_SAMPLE_DATA,TPCDS_SF10TCL,EXPLAIN,23004562097082374,CS291JPROJECT,ACCOUNTADMIN,TPCDS_BENCH_10T,,STANDARD,,,SUCCESS,,,2024-03-10T18:31:35.279-07:00,2024-03-10T18:31:37.253-07:00,1974,0,0,1966,8,0,0,0,0,,,0,,,0,0.000301000,0,8.9.2,0,0,0,0,0,FALSE,5b9693d89e7f1ceef992db2541e0b2ec,2,1a7bdba8e9785a4a39e85027ebf079fe,1
